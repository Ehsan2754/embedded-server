
var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function i(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,l;function c(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function u(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function h(t){let e;return u(t,(t=>e=t))(),e}function d(t,e,n){t.$$.on_destroy.push(u(e,n))}function p(t,e,n,i){if(t){const s=f(t,e,n,i);return t[0](s)}}function f(t,n,i,s){return t[1]&&s?e(i.ctx.slice(),t[1](s(n))):i.ctx}function v(t,e,n,i){if(t[2]&&i){const s=t[2](i(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let i=0;i<n;i+=1)t[i]=e.dirty[i]|s[i];return t}return e.dirty|s}return e.dirty}function g(t,e,n,i,s,r){if(s){const o=f(e,n,i,r);t.p(o,s)}}function m(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function y(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function b(t,e){const n={};e=new Set(e);for(const i in t)e.has(i)||"$"===i[0]||(n[i]=t[i]);return n}function w(t,e,n){return t.set(n),e}function S(t,e){t.appendChild(e)}function _(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function M(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function x(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function k(){return C(" ")}function D(){return C("")}function V(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function A(t){return function(e){return e.preventDefault(),t.call(this,e)}}function T(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function B(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function L(t){return""===t?null:+t}function P(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function E(t,e){t.value=null==e?"":e}function I(t,e,n,i){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}function R(t,e){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e)return void(i.selected=!0)}t.selectedIndex=-1}function z(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function U(t,e,n){t.classList[n?"add":"remove"](e)}class N{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){var i;this.e||(this.is_svg?this.e=(i=e.nodeName,document.createElementNS("http://www.w3.org/2000/svg",i)):this.e=x(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)_(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach($)}}function O(t){l=t}function F(){if(!l)throw new Error("Function called outside component initialization");return l}function W(t){F().$$.on_mount.push(t)}function H(t){F().$$.after_update.push(t)}function G(t){F().$$.on_destroy.push(t)}function j(){const t=F();return(e,n,{cancelable:i=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,i,e),s}(e,n,{cancelable:i});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}function Y(t,e){return F().$$.context.set(t,e),e}function X(t){return F().$$.context.get(t)}function Z(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const q=[],J=[],K=[],Q=[],tt=Promise.resolve();let et=!1;function nt(){et||(et=!0,tt.then(at))}function it(t){K.push(t)}function st(t){Q.push(t)}const rt=new Set;let ot=0;function at(){const t=l;do{for(;ot<q.length;){const t=q[ot];ot++,O(t),lt(t.$$)}for(O(null),q.length=0,ot=0;J.length;)J.pop()();for(let t=0;t<K.length;t+=1){const e=K[t];rt.has(e)||(rt.add(e),e())}K.length=0}while(q.length);for(;Q.length;)Q.pop()();et=!1,rt.clear(),O(t)}function lt(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(it)}}const ct=new Set;let ut;function ht(){ut={r:0,c:[],p:ut}}function dt(){ut.r||s(ut.c),ut=ut.p}function pt(t,e){t&&t.i&&(ct.delete(t),t.i(e))}function ft(t,e,n,i){if(t&&t.o){if(ct.has(t))return;ct.add(t),ut.c.push((()=>{ct.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function vt(t,e){t.d(1),e.delete(t.key)}function gt(t,e){ft(t,1,1,(()=>{e.delete(t.key)}))}function mt(t,e,n,i,s,r,o,a,l,c,u,h){let d=t.length,p=r.length,f=d;const v={};for(;f--;)v[t[f].key]=f;const g=[],m=new Map,y=new Map;for(f=p;f--;){const t=h(s,r,f),a=n(t);let l=o.get(a);l?i&&l.p(t,e):(l=c(a,t),l.c()),m.set(a,g[f]=l),a in v&&y.set(a,Math.abs(f-v[a]))}const b=new Set,w=new Set;function S(t){pt(t,1),t.m(a,u),o.set(t.key,t),u=t.first,p--}for(;d&&p;){const e=g[p-1],n=t[d-1],i=e.key,s=n.key;e===n?(u=e.first,d--,p--):m.has(s)?!o.has(i)||b.has(i)?S(e):w.has(s)?d--:y.get(i)>y.get(s)?(w.add(i),S(e)):(b.add(s),d--):(l(n,o),d--)}for(;d--;){const e=t[d];m.has(e.key)||l(e,o)}for(;p;)S(g[p-1]);return g}function yt(t){return"object"==typeof t&&null!==t?t:{}}function bt(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function wt(t){t&&t.c()}function St(t,e,i,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=t.$$;a&&a.m(e,i),o||it((()=>{const e=l.map(n).filter(r);c?c.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(it)}function _t(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function $t(e,n,r,o,a,c,u,h=[-1]){const d=l;O(e);const p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:i(),dirty:h,skip_bound:!1,root:n.target||d.$$.root};u&&u(p.root);let f=!1;if(p.ctx=r?r(e,n.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),f&&function(t,e){-1===t.$$.dirty[0]&&(q.push(t),nt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],p.update(),f=!0,s(p.before_update),p.fragment=!!o&&o(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach($)}else p.fragment&&p.fragment.c();n.intro&&pt(e.$$.fragment),St(e,n.target,n.anchor,n.customElement),at()}O(d)}class Mt{$destroy(){_t(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var xt,Ct;!function(t){t.calibrationCoefficient="Коэффициент датчика",t.labTitle="Лаборатория",t.sensorsVisibilityTitle="Настройка мультидатчика",t.triggerSettingsTitle="Триггер",t.rangeSettingsTitle="Развертка",t.channelSettingsTitle="Каналы",t.triggerSource="Источник",t.triggerMode="Режим",t.triggerModeAuto="Авто",t.triggerModeWaiting="Ждущ.",t.triggerModeSingle="Однокр.",t.triggerType="Тип",t.triggerTypeUp="Восх.",t.triggerTypeDown="Нисх.",t.triggerLevel="Уровень",t.range="Диапазон",t.offset="Смещение",t.channel1="Канал 1",t.channel2="Канал 2",t.usDiv="мкс/дел",t.msDiv="мс/дел",t.mVolts="мВ",t.volts="В",t.voltsDiv="В/дел",t.mVoltsDiv="мВ/дел",t.oscilloscopeSettingsTitle="Настройка осциллографа",t.resetServerUrl="Сбросить адрес сервера",t.openRemoteApp="Открыть удаленное приложение",t.connectToServer="Соединиться с сервером",t.takeAPicture="Сделать фото",t.startRecording="Начать запись",t.stopRecording="Остановить запись",t.recording="Запись",t.devices="Устройства",t.bpm="уд./мин",t.mmHg="мм. рт.ст",t.confirmInstallMessage="Для продолжения установки требуется перезапуск приложения",t.updateError="Во время обновления произошла ошибка",t.checkingUpdates="Проверяется наличие обновлений...",t.updateFWTitle="Обновление ПО",t.successUpdate="Обновление успешно завершено!",t.pleaseRebootLab="Пожалуйста, перезагрузите лабораторию!",t.newVersionAvailable="Доступна новая версия",t.updateLabTitle="Обноление ПО лаборатории",t.checkLabUpdate="Обновление лаборатории",t.autoScaleIsOn="авто масштаб",t.openDocumentation="Открыть инструкцию",t.documentation="Инструкция",t.programVersion="Версия ПО",t.noInternetConnection="Нет соединения с интернетом",t.allUpdated="У вас самая посдедняя версия ПО",t.checkFWUpdate="Обновление ПО",t.lightTheme="Светлая тема",t.darkTheme="Темная тема",t.theme="Тема оформления",t.calibration_writeAPasswordModalHeader="Введите пароль",t.refreshInterval="Период опроса",t.disconnected="Отключен",t.connected="Подключен",t.sensorsPackSubtitle="Выберите датчики для создания связки временного графика",t.sensorsPack="Связка датчиков",t.connectLab="Подключить лабораторию",t.setModeError="Ошибка установки режима датчика",t.video_startStreamMessage="Нажмите на кнопку, чтобы включить камеру",t.camera="Камера",t.offlineLogging_recordCount="Количество записей",t.offlineLogging_button_start="Запустить сеанс автономной работы",t.offlineLogging_button_view="Работа с данными сеанса",t.dots_many="точек",t.dots_few="точки",t.dots_one="точка",t.milliseconds_short="мс",t.seconds_short="сек.",t.minutes_short="мин.",t.hours_short="ч.",t.recording_interval="Интервал между записями",t.offlineLogging_empty="Сеанс автономной работы не был начат",t.offlineLogging_processing="Запущен сеанс автономной работы",t.offlineLogging_loading="Идет сбор архива",t.offlineLogging_unknown="Состояние архива неизвестно",t.offlineLogging_done="Сеанс автономной работы завершен",t.status="Статус",t.offlineLogging_title="Сеанс автономной работы",t.offlineLogging_subtitle="Установите параметры сеанса автономной работы",t.calibrationNotSuccess="Калибровка не была выполнена",t.calibrationSuccess="Калибровка была успешно выполнена",t.error="Ошибка!",t.alert="Внимание!",t.retry="Повторить попытку",t.serverAddress="Адрес сервера",t.connect="Подключить",t.disconnect="Отключить",t.networkName="Имя сети",t.password="Пароль",t.ipAddress="IP адрес",t.gateway="Шлюз",t.optional="опционально",t.showAdditionalSettings="Показать дополнительные настройки",t.calibratedSensorValue="Новое значение",t.numberOfCalibrationSteps="Количество ступеней калибровки",t.currentValue="Текущее значение",t.calibrate="Калибровать",t.reset="Сбросить",t.calibrationSubtitle="Калибровка датчиков",t.calibrationTitle="Калибровка",t.copy="Скопировать",t.open="Открыть",t.cancel="Закрыть",t.link="Ссылка",t.archiveSavedTitle="Данные были сохранены.",t.archiveSavedDescription="Скопируйте ссылку, чтобы посмотреть сохраненные данные или поделиться ими. Ссылка актуальна 1 месяц.",t.readSettingsError="Произошла ошибка при считывании настроек",t.graphicsTitle="Графики",t.measuresTitle="Измерения",t.maxY="Mакс. Y",t.maxX="Mакс. X",t.apply="Применить",t.confirm="Подтвердить",t.fixed="Фиксировать",t.noData="нет данных",t.time="Время",t.chartCrosshairValue="Значение: ",t.chartCrosshairTime="Время: ",t.serverNotResponding="Сервер приложения не отвечает",t.fatalError="Произошла ошибка, попробуйте перезагрузить страницу и устройство",t.workWithSavedData_title="Кабинет обработки данных",t.back="Назад",t.chartCrosshairValues="Значения: ",t.settings="Настройки",t.about="О программе",t.sensors="Датчики",t.connectSensors="Подключение датчиков",t.experimentSettings="Настройки эксперимента",t.support="Техническая поддержка",t.aboutContactCellphone='Телефон: <a href="tel:+78007753797">8 (800) 775 37-97</a>',t.site="Сайт",t.aboutSiteUrl="www.zarnitza.ru",t.sensorSettings="Настройки датчика",t.rangeAndUnit="Диапазон / Ед. измерения",t.chartLineColor="Цвет линии графика",t.chartLineWidth="Толщина линии графика",t.chartMarkerColor="Цвет точек графика",t.chartMarkerWidth="Размер точек графика",t.start="Пуск",t.stop="Остановить",t.experimentTimeLabel="Время эксперимента",t.timeFormatLabel="Формат времени",t.timeSecond="Секунд",t.timeMinute="Минут",t.modeStopwatch="Секнудомер",t.modeMinutesSecondsMs="Минуты, секунды, миллисекунды",t.modeHoursMinutesSeconds="Часы, минуты, секунды",t.experimentIsDone="Эксперимент завершён",t.exitFromDashboardText="Вы уверены, что хотите заверишть эксперимент?<br><b>Внимание!</b> Все несохраненные данные будут потеряны",t.yes="Да",t.no="Нет",t.reject="Отмена",t.exitFromDashboardTitle="<b>Выход из режима измерения</b>",t.wifiSettings="Настройки сети",t.loadFailedHeader="Внимание",t.loadFailedBody="Во время загрузки произошла ошибка. Данные не были сохранены!",t.disabled="Отключен",t.timeFormatStopwatch="сс.мс",t.timeFormatMinutesSecondsMs="мм:сс.мс",t.timeFormatHoursMinutesSeconds="чч:мм:сс",t.calibrateEqualsError="Значения первого и второго шага должны отличаться!",t.unknownError="Произошла неизвестная ошибка",t.inputMustBeANumber="Значение должно быть числом",t.unknownLabTypeError="Неизвестный тип лаборатории",t.deviceSelectionError="Устройство не было выбрано",t.usbPortAlreadyOpenedError="Устройство уже было подключено. Закройте все програмы использующие это устройство",t.parseError="Ошибка разбора данных",t.notResponseError="Устройство не отвечает",t.deviceDisconnectedMessage="Устройство было отключено",t.unknownDevice="Неизвестное устройство",t.calibration_passwordError="Не верный пароль!",t.worksheetName="Измерения",t.exportExperimentTableFileName="Измерения",t.exportExperimentImageFileName="Измерения",t.exportCameraImageFileName="Фото эксперимента",t.exportCameraVideoFileName="Запись эксперимента",t.update="Обновить",t.quitAndUpdate="Выйти и обновить",t.later="Позже",t.AP_status_0="Инициализация",t.AP_status_1="Усреднение значений. Подготовка",t.AP_status_2="Ожидание накачки",t.AP_status_3="Накачивание",t.AP_status_4="Накачивание окончено",t.AP_status_5="Измерение",t.AP_status_6="Расчет значений",t.AP_error_0="Ожидание",t.AP_error_1="Ошибка 1",t.AP_error_2="Ошибка 2",t.AP_error_3="Ошибка 3",t.AP_error_4="Ошибка 4",t.AP_error_5="Ошибка 5",t.AP_error_6="Измерение успешно",t.couldNotConnectToServer="Подключение к облаку не удалось, проверьте правильность введенных данных.",t.successConnectToServer="Подключение к облаку успешно выполнено!",t.disconnectLab="Отключить лабораторию"}(xt||(xt={})),function(t){t.deviceDisconnectedMessage="Устройство {0} было отключено",t.realValueStep="Фактическое значение (ступень&nbsp;№{0})"}(Ct||(Ct={}));const kt="https://www.zarnitza.ru";var Dt,Vt,At,Tt=xt;!function(t){t[t.Graphics=0]="Graphics",t[t.Measures=1]="Measures"}(Dt||(Dt={})),function(t){t[t.TempSensor=10]="TempSensor",t[t.AbsolutePressureSensor=11]="AbsolutePressureSensor",t[t.TeslameterSensor=12]="TeslameterSensor",t[t.VoltmeterSensor=13]="VoltmeterSensor",t[t.AmmeterSensor=14]="AmmeterSensor",t[t.AccelerometerXSensor=15]="AccelerometerXSensor",t[t.AccelerometerYSensor=16]="AccelerometerYSensor",t[t.AccelerometerZSensor=17]="AccelerometerZSensor",t[t.ConductivitySensor=18]="ConductivitySensor",t[t.HumiditySensor=19]="HumiditySensor",t[t.LightSensor=110]="LightSensor",t[t.TempOutsideSensor=111]="TempOutsideSensor",t[t.ColorimeterSensor=112]="ColorimeterSensor",t[t.PhSensor=113]="PhSensor",t[t.ArterialPressureSensor=114]="ArterialPressureSensor",t[t.PulseSensor=115]="PulseSensor",t[t.BodyTempSensor=116]="BodyTempSensor",t[t.RespirationRateSensor=117]="RespirationRateSensor",t[t.IonomerSensor=118]="IonomerSensor"}(Vt||(Vt={})),function(t){t[t.ColorimeterSensor=20]="ColorimeterSensor",t[t.UsbLightSensor=21]="UsbLightSensor",t[t.WristSensor=22]="WristSensor",t[t.SoilMoistureSensor=23]="SoilMoistureSensor",t[t.CoSensor=24]="CoSensor",t[t.OpticalDensitySensor=25]="OpticalDensitySensor",t[t.SoundSensor=26]="SoundSensor",t[t.CardioSensor=27]="CardioSensor",t[t.OscilloscopeSensor=28]="OscilloscopeSensor"}(At||(At={}));const Bt={...Vt,...At};class Lt{min;max;static OnlyBoth=new Lt(2,2);static Automated=new Lt(-1,-1);constructor(t,e){this.min=t,this.max=e}}class Pt{static Disabled=new Pt({minValue:0,maxValue:0,unit:"",customStringRepresentation:Tt.disabled,accuracy:0,calibrationSteps:new Lt(0,0)});minValue;maxValue;unit;accuracy;calibrationSteps;customStringRepresentation;constructor({minValue:t,maxValue:e,unit:n,customStringRepresentation:i,accuracy:s,calibrationSteps:r}){this.customStringRepresentation=i||"",this.unit=n,this.maxValue=e,this.minValue=t,this.accuracy=s,this.calibrationSteps=r}toString(){return this.customStringRepresentation||`${this.minValue}...${this.maxValue} ${this.unit}`}}const Et=new Map([[Bt.TempSensor,{calibrationSteps:new Lt(1,2),name:"Датчик T эксп.",ico:"Temp_1.png",modes:[new Pt({minValue:-40,maxValue:165,unit:"°С",accuracy:1})]}],[Bt.AbsolutePressureSensor,{calibrationSteps:new Lt(1,1),name:"Датчик P абс.",ico:"Pressure.png",modes:[new Pt({minValue:0,maxValue:500,unit:"кПа",accuracy:1})]}],[Bt.TeslameterSensor,{calibrationSteps:new Lt(2,2),name:"Тесламетр",ico:"Tesla.png",modes:[new Pt({minValue:-100,maxValue:100,unit:"мЛт",accuracy:1})]}],[Bt.VoltmeterSensor,{calibrationSteps:new Lt(2,2),name:"Вольтметр",ico:"Voltage.png",modes:[new Pt({minValue:-15,maxValue:15,unit:"В",accuracy:3})]}],[Bt.AmmeterSensor,{calibrationSteps:new Lt(2,2),name:"Амперметр",ico:"Amper.png",modes:[new Pt({minValue:-1,maxValue:1,unit:"A",accuracy:3})]}],[Bt.HumiditySensor,{calibrationSteps:new Lt(1,1),name:"Датчик влажности",ico:"Humidity.png",modes:[new Pt({minValue:0,maxValue:100,unit:"%",accuracy:1})]}],[Bt.LightSensor,{calibrationSteps:new Lt(1,1),name:"Датчик освещенности",ico:"Illumination.png",modes:[new Pt({minValue:0,maxValue:18e4,unit:"лк",accuracy:0})]}],[Bt.TempOutsideSensor,{calibrationSteps:new Lt(1,1),name:"Датчик Т окр.",ico:"Temp_2.png",modes:[new Pt({minValue:-40,maxValue:60,unit:"°С",accuracy:1})]}],[Bt.PhSensor,{calibrationSteps:new Lt(2,2),name:"Датчик pH",ico:"pH.png",modes:[new Pt({minValue:0,maxValue:14,unit:"pH",accuracy:2})]}],[Bt.AccelerometerXSensor,{calibrationSteps:new Lt(0,0),name:"Датчик ускорения. Ось Х",ico:"Accelerometr.png",modes:[new Pt({minValue:-2,maxValue:2,unit:"g",accuracy:3}),new Pt({minValue:-4,maxValue:4,unit:"g",accuracy:3}),new Pt({minValue:-8,maxValue:8,unit:"g",accuracy:3}),new Pt({minValue:-16,maxValue:16,unit:"g",accuracy:3})]}],[Bt.AccelerometerYSensor,{calibrationSteps:new Lt(0,0),name:"Датчик ускорения. Ось Y",ico:"Accelerometr.png",modes:[new Pt({minValue:-2,maxValue:2,unit:"g",accuracy:3}),new Pt({minValue:-4,maxValue:4,unit:"g",accuracy:3}),new Pt({minValue:-8,maxValue:8,unit:"g",accuracy:3}),new Pt({minValue:-16,maxValue:16,unit:"g",accuracy:3})]}],[Bt.AccelerometerZSensor,{calibrationSteps:new Lt(0,0),name:"Датчик ускорения. Ось Z",ico:"Accelerometr.png",modes:[new Pt({minValue:-2,maxValue:2,unit:"g",accuracy:3}),new Pt({minValue:-4,maxValue:4,unit:"g",accuracy:3}),new Pt({minValue:-8,maxValue:8,unit:"g",accuracy:3}),new Pt({minValue:-16,maxValue:16,unit:"g",accuracy:3})]}],[Bt.ConductivitySensor,{calibrationSteps:new Lt(2,2),name:"Датчик электропроводимости",ico:"Electrical_conduct.png",modes:[Pt.Disabled,new Pt({minValue:0,maxValue:200,unit:"мкСм/см",accuracy:1}),new Pt({minValue:0,maxValue:2e3,unit:"мкСм/см",accuracy:1}),new Pt({minValue:0,maxValue:2e4,unit:"мкСм/см",accuracy:1})]}],[Bt.ColorimeterSensor,{calibrationSteps:new Lt(0,0),name:"Колориметр",ico:"Colorimeter.png",modes:[new Pt({minValue:0,maxValue:2,unit:"D",accuracy:2})]}],[Bt.ArterialPressureSensor,{calibrationSteps:new Lt(0,0),name:"Датчик арт. давления",ico:"ArterialPressureSensor.png",modes:[new Pt({minValue:0,maxValue:250,unit:"мм. рт.ст.",accuracy:0})]}],[Bt.PulseSensor,{calibrationSteps:new Lt(0,0),name:"Датчик пульса",ico:"PulseSensor.png",modes:[new Pt({minValue:25,maxValue:250,unit:"уд./мин",accuracy:1})]}],[Bt.BodyTempSensor,{calibrationSteps:new Lt(1,2),name:"Датчик темп. тела",ico:"BodyTempSensor.png",modes:[new Pt({minValue:25,maxValue:50,unit:"°С",accuracy:1})]}],[Bt.RespirationRateSensor,{calibrationSteps:new Lt(0,0),name:"Датчик частоты дыхания",ico:"RespirationRateSensor.png",modes:[new Pt({minValue:0,maxValue:100,unit:"циклов/мин",accuracy:1})]}],[Bt.IonomerSensor,{calibrationSteps:new Lt(2,2),name:"Иономер",ico:"IonomerSensor.png",modes:[new Pt({minValue:0,maxValue:14,unit:"pH",accuracy:2,calibrationSteps:new Lt(2,2)}),new Pt({minValue:2e-6,maxValue:.2,unit:"моль/л",accuracy:6,calibrationSteps:new Lt(2,5),customStringRepresentation:"pNO3 2x10⁻⁶...-2 моль/л"}),new Pt({minValue:2e-5,maxValue:.2,unit:"моль/л",accuracy:6,calibrationSteps:new Lt(2,5),customStringRepresentation:"pNO3 2x10⁻⁵...-2 моль/л"})]}]]);var It;function Rt(t,e){const n=Math.floor(t/1e3/60/60),i=Math.floor(t/1e3/60),s=Math.floor(t/1e3),r=t%1e3;switch(e){case It.Stopwatch:return`${s}.${r}`;case It.MinutesSecondsMs:return`${i}:${s%60}.${r}`;case It.HoursMinutesSeconds:return`${n}:${i%60}:${s%60}`;default:return`${i}:${s%60}.${r}`}}function zt(t){switch(t){case It.Stopwatch:return Tt.timeFormatStopwatch;case It.MinutesSecondsMs:return Tt.timeFormatMinutesSecondsMs;case It.HoursMinutesSeconds:return Tt.timeFormatHoursMinutesSeconds}}!function(t){t[t.Stopwatch=0]="Stopwatch",t[t.MinutesSecondsMs=1]="MinutesSecondsMs",t[t.HoursMinutesSeconds=2]="HoursMinutesSeconds"}(It||(It={}));function Ut(t,e){const n=document.createElement("a");n.download=e,n.href=t,n.click()}function Nt(t,e,n){const i=self.document.createElement("table");t.forEach((t=>{const e=i.insertRow();return t.forEach((t=>{e.insertCell().innerHTML=t})),e}));const s={worksheet:e||"Worksheet",table:i.innerHTML},r="data:application/vnd.ms-excel;base64,"+(o=function(t,e){return t.replace(/{(\w+)}/g,(function(t,n){return e[n]}))}('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>',s),self.btoa(encodeURIComponent(o).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))));var o;Ut(r,n)}function Ot(t,e,n){const i=t.slice();return i[10]=e[n],i[12]=n,i}function Ft(t,e,n){const i=t.slice();return i[13]=e[n],i[15]=n,i}function Wt(t,e,n){const i=t.slice();return i[16]=e[n],i}function Ht(t){let e,n,i=t[16]+"";return{c(){e=x("td"),n=C(i),B(e,"class","svelte-1ac2rb6")},m(t,i){_(t,e,i),S(e,n)},p(t,e){1&e&&i!==(i=t[16]+"")&&P(n,i)},d(t){t&&$(e)}}}function Gt(t){let e,n,i=t[4](t[13],t[15])+"";return{c(){e=x("td"),n=C(i),B(e,"class","svelte-1ac2rb6")},m(t,i){_(t,e,i),S(e,n)},p(t,e){26&e&&i!==(i=t[4](t[13],t[15])+"")&&P(n,i)},d(t){t&&$(e)}}}function jt(t,e){let n,i,s=e[1][Xt(e[12],e[1].length,e[3])],r=[];for(let t=0;t<s.length;t+=1)r[t]=Gt(Ft(e,s,t));return{key:t,first:null,c(){n=x("tr");for(let t=0;t<r.length;t+=1)r[t].c();i=k(),this.first=n},m(t,e){_(t,n,e);for(let t=0;t<r.length;t+=1)r[t].m(n,null);S(n,i)},p(t,o){if(e=t,26&o){let t;for(s=e[1][Xt(e[12],e[1].length,e[3])],t=0;t<s.length;t+=1){const a=Ft(e,s,t);r[t]?r[t].p(a,o):(r[t]=Gt(a),r[t].c(),r[t].m(n,i))}for(;t<r.length;t+=1)r[t].d(1);r.length=s.length}},d(t){t&&$(n),M(r,t)}}}function Yt(e){let n,i,s,r,o,a,l,c,u,h,d,p=[],f=new Map,v=e[0],g=[];for(let t=0;t<v.length;t+=1)g[t]=Ht(Wt(e,v,t));let m=e[1];const y=t=>t[1][Xt(t[12],t[1].length,t[3])][t[2]];for(let t=0;t<m.length;t+=1){let n=Ot(e,m,t),i=y(n);f.set(i,p[t]=jt(i,n))}return{c(){n=x("div"),i=x("div"),s=x("table"),r=x("thead"),o=x("tr");for(let t=0;t<g.length;t+=1)g[t].c();a=k(),l=x("div"),c=x("table"),u=x("tbody");for(let t=0;t<p.length;t+=1)p[t].c();B(l,"class","scrollable-table_vScroll svelte-1ac2rb6"),B(i,"class","scrollable-table_hScroll svelte-1ac2rb6"),B(n,"class","scrollable-table h-full svelte-1ac2rb6")},m(t,f){_(t,n,f),S(n,i),S(i,s),S(s,r),S(r,o);for(let t=0;t<g.length;t+=1)g[t].m(o,null);S(i,a),S(i,l),S(l,c),S(c,u);for(let t=0;t<p.length;t+=1)p[t].m(u,null);e[8](l),e[9](i),h||(d=V(i,"scroll",e[7]),h=!0)},p(t,[e]){if(1&e){let n;for(v=t[0],n=0;n<v.length;n+=1){const i=Wt(t,v,n);g[n]?g[n].p(i,e):(g[n]=Ht(i),g[n].c(),g[n].m(o,null))}for(;n<g.length;n+=1)g[n].d(1);g.length=v.length}30&e&&(m=t[1],p=mt(p,e,y,1,t,m,f,u,vt,jt,null,Ot))},i:t,o:t,d(t){t&&$(n),M(g,t);for(let t=0;t<p.length;t+=1)p[t].d();e[8](null),e[9](null),h=!1,d()}}}function Xt(t,e,n){return n?e-t-1:t}function Zt(t,e,n){let i,s,{headers:r=[]}=e,{rows:o=[]}=e,{keyColumn:a=0}=e,{reversed:l=!1}=e,{valuesConverter:c}=e;function u(){n(5,i.style.width=s.clientWidth+s.scrollLeft+"px",i)}return W((()=>(self.document.addEventListener("resize",u),()=>{self.document.removeEventListener("resize",u)}))),t.$$set=t=>{"headers"in t&&n(0,r=t.headers),"rows"in t&&n(1,o=t.rows),"keyColumn"in t&&n(2,a=t.keyColumn),"reversed"in t&&n(3,l=t.reversed),"valuesConverter"in t&&n(4,c=t.valuesConverter)},[r,o,a,l,c,i,s,u,function(t){J[t?"unshift":"push"]((()=>{i=t,n(5,i)}))},function(t){J[t?"unshift":"push"]((()=>{s=t,n(6,s)}))}]}class qt extends Mt{constructor(t){super(),$t(this,t,Zt,Yt,o,{headers:0,rows:1,keyColumn:2,reversed:3,valuesConverter:4})}}const Jt=["#CB4335","#9B59B6","#85C1E9","#76D7C4","#D4AC0D","#A04000","#FF00CC","#000000","#56ab2f","#646464"],Kt=[1e5,5e4,25e3,1e4,5e3,2500,1e3,500,250,100,50,25,10,5,2.5],Qt=[1166,1166,1166,1166,2166,4500,7e3,21e3,74500,125750,211167,382e3,894500,1748667,3457e3];class te{static timeFormat=It.MinutesSecondsMs;static experimentTime=60;static defaultChannelRange=5e3;static defaultChannelOffset=0;static defaultChannelColor1=Jt[1];static defaultChannelColor2=Jt[2];static defaultRangeValue=5e3;static defaultRangeOffset=0;static defaultTriggerLevel=0;static defaultRangeTNumber=Kt[te.defaultRangeValue];static getDiffBetweenPoints(t){return Qt[te.getRangeTNumber(t)-1]}static getRangeTNumber(t){return Kt.length-Kt.indexOf(t)}}function ee(t,e,n,i){if(0==e&&t<0)return 0;const s=(n-e)*i/100/2;return t<=n+s&&t>e-s}function ne(t){return function(e,n){return 0==n?Rt(e,te.timeFormat):(i=e,s=t[n][0],r=t[n][1],null==i?Tt.noData:ee(i,s,r,10)?i.toString():"—");var i,s,r}}function ie(e){let n,i,s,r,o,a,l;return{c(){n=x("header"),i=x("div"),s=x("span"),r=C(e[1]),o=k(),a=x("img"),B(i,"class","title-wrapper svelte-ddpd3i"),c(a.src,l=e[0])||B(a,"src",l),B(a,"class","svelte-ddpd3i"),B(n,"class","svelte-ddpd3i")},m(t,e){_(t,n,e),S(n,i),S(i,s),S(s,r),S(n,o),S(n,a)},p(t,[e]){2&e&&P(r,t[1]),1&e&&!c(a.src,l=t[0])&&B(a,"src",l)},i:t,o:t,d(t){t&&$(n)}}}function se(t,e,n){let{iconUri:i}=e,{title:s}=e;return t.$$set=t=>{"iconUri"in t&&n(0,i=t.iconUri),"title"in t&&n(1,s=t.title)},[i,s]}class re extends Mt{constructor(t){super(),$t(this,t,se,ie,o,{iconUri:0,title:1})}}function oe(e){let n,i,s;return{c(){n=x("button"),B(n,"class","back-button svelte-5vgyka")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[0]),i=!0)},p:t,i:t,o:t,d(t){t&&$(n),i=!1,s()}}}function ae(t){return[function(e){Z.call(this,t,e)}]}class le extends Mt{constructor(t){super(),$t(this,t,ae,oe,o,{})}}function ce(t){let e,n,i,s;return n=new le({}),n.$on("click",(function(){r(t[1])&&t[1].apply(this,arguments)})),{c(){e=x("div"),wt(n.$$.fragment),i=C("\n         "),B(e,"class","back-button svelte-13cbnhe")},m(t,r){_(t,e,r),St(n,e,null),_(t,i,r),s=!0},p(e,n){t=e},i(t){s||(pt(n.$$.fragment,t),s=!0)},o(t){ft(n.$$.fragment,t),s=!1},d(t){t&&$(e),_t(n),t&&$(i)}}}function ue(t){let e,n,i,s,r=t[1]&&ce(t);return{c(){e=x("span"),r&&r.c(),n=k(),i=C(t[0]),B(e,"class","title svelte-13cbnhe")},m(t,o){_(t,e,o),r&&r.m(e,null),S(e,n),S(e,i),s=!0},p(t,[o]){t[1]?r?(r.p(t,o),2&o&&pt(r,1)):(r=ce(t),r.c(),pt(r,1),r.m(e,n)):r&&(ht(),ft(r,1,1,(()=>{r=null})),dt()),(!s||1&o)&&P(i,t[0])},i(t){s||(pt(r),s=!0)},o(t){ft(r),s=!1},d(t){t&&$(e),r&&r.d()}}}function he(t,e,n){let{subtitle:i}=e,{onBack:s}=e;return t.$$set=t=>{"subtitle"in t&&n(0,i=t.subtitle),"onBack"in t&&n(1,s=t.onBack)},[i,s]}class de extends Mt{constructor(t){super(),$t(this,t,he,ue,o,{subtitle:0,onBack:1})}}function pe(t){let e,n,i,s,r,o,a;n=new re({props:{title:t[0],iconUri:t[1]}}),s=new de({props:{subtitle:t[2],onBack:t[3]}});const l=t[5].default,c=p(l,t,t[4],null);return{c(){e=x("div"),wt(n.$$.fragment),i=k(),wt(s.$$.fragment),r=k(),o=x("div"),c&&c.c(),B(o,"class","content svelte-dr41zd"),B(e,"class","content-wrapper svelte-dr41zd")},m(t,l){_(t,e,l),St(n,e,null),S(e,i),St(s,e,null),S(e,r),S(e,o),c&&c.m(o,null),a=!0},p(t,[e]){const i={};1&e&&(i.title=t[0]),2&e&&(i.iconUri=t[1]),n.$set(i);const r={};4&e&&(r.subtitle=t[2]),8&e&&(r.onBack=t[3]),s.$set(r),c&&c.p&&(!a||16&e)&&g(c,l,t,t[4],a?v(l,t[4],e,null):m(t[4]),null)},i(t){a||(pt(n.$$.fragment,t),pt(s.$$.fragment,t),pt(c,t),a=!0)},o(t){ft(n.$$.fragment,t),ft(s.$$.fragment,t),ft(c,t),a=!1},d(t){t&&$(e),_t(n),_t(s),c&&c.d(t)}}}function fe(t,e,n){let{$$slots:i={},$$scope:s}=e,{title:r=""}=e,{ico:o=""}=e,{subtitle:a=""}=e,{onBack:l}=e;return t.$$set=t=>{"title"in t&&n(0,r=t.title),"ico"in t&&n(1,o=t.ico),"subtitle"in t&&n(2,a=t.subtitle),"onBack"in t&&n(3,l=t.onBack),"$$scope"in t&&n(4,s=t.$$scope)},[r,o,a,l,s,i]}class ve extends Mt{constructor(t){super(),$t(this,t,fe,pe,o,{title:0,ico:1,subtitle:2,onBack:3})}}var ge={allowDownsampling:!0};var me,ye,be,we=function(){function t(t,e){var n=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(t){return n._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=e,this._configureCanvas(),this._installResolutionListener()}return t.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),t.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(t.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),t.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},t.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(e){return e!=t}))},t.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},t.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach((function(e){return e.call(t)}))},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");var e=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+e+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},t}();

/*!
     * @license
     * TradingView Lightweight Charts v3.8.0
     * Copyright (c) 2020 TradingView, Inc.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0

     */function Se(t,e){var n,i=((n={})[0]=[],n[1]=[t.lineWidth,t.lineWidth],n[2]=[2*t.lineWidth,2*t.lineWidth],n[3]=[6*t.lineWidth,6*t.lineWidth],n[4]=[t.lineWidth,4*t.lineWidth],n)[e];t.setLineDash(i)}function _e(t,e,n,i){t.beginPath();var s=t.lineWidth%2?.5:0;t.moveTo(n,e+s),t.lineTo(i,e+s),t.stroke()}function $e(t,e){if(!t)throw new Error("Assertion failed"+(e?": "+e:""))}function Me(t){if(void 0===t)throw new Error("Value is undefined");return t}function xe(t){if(null===t)throw new Error("Value is null");return t}function Ce(t){return xe(Me(t))}(be=me||(me={}))[be.Simple=0]="Simple",be[be.WithSteps=1]="WithSteps",function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(ye||(ye={}));var ke={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function De(t){return t<0?0:t>255?255:Math.round(t)||0}function Ve(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}var Ae=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,Te=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,Be=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,Le=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function Pe(t){var e;if((t=t.toLowerCase())in ke&&(t=ke[t]),e=Le.exec(t)||Be.exec(t))return[De(parseInt(e[1],10)),De(parseInt(e[2],10)),De(parseInt(e[3],10)),Ve(e.length<5?1:parseFloat(e[4]))];if(e=Te.exec(t))return[De(parseInt(e[1],16)),De(parseInt(e[2],16)),De(parseInt(e[3],16)),1];if(e=Ae.exec(t))return[De(17*parseInt(e[1],16)),De(17*parseInt(e[2],16)),De(17*parseInt(e[3],16)),1];throw new Error("Cannot parse color: ".concat(t))}function Ee(t){var e,n=Pe(t);return{t:"rgb(".concat(n[0],", ").concat(n[1],", ").concat(n[2],")"),i:(e=n,.199*e[0]+.687*e[1]+.114*e[2]>160?"black":"white")}}var Ie=function(t,e){return Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Ie(t,e)};function Re(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ie(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ze=function(){return ze=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},ze.apply(this,arguments)};function Ue(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var Ne=function(){function t(){this.h=[]}return t.prototype.u=function(t,e,n){var i={o:t,l:e,v:!0===n};this.h.push(i)},t.prototype._=function(t){var e=this.h.findIndex((function(e){return t===e.o}));e>-1&&this.h.splice(e,1)},t.prototype.M=function(t){this.h=this.h.filter((function(e){return e.l!==t}))},t.prototype.m=function(t,e){var n=Ue([],this.h,!0);this.h=this.h.filter((function(t){return!t.v})),n.forEach((function(n){return n.o(t,e)}))},t.prototype.p=function(){return this.h.length>0},t.prototype.g=function(){this.h=[]},t}();function Oe(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,s=e;i<s.length;i++){var r=s[i];for(var o in r)void 0!==r[o]&&("object"!=typeof r[o]||void 0===t[o]?t[o]=r[o]:Oe(t[o],r[o]))}return t}function Fe(t){return"number"==typeof t&&isFinite(t)}function We(t){return"number"==typeof t&&t%1==0}function He(t){return"string"==typeof t}function Ge(t){return"boolean"==typeof t}function je(t){var e,n,i,s=t;if(!s||"object"!=typeof s)return s;for(n in e=Array.isArray(s)?[]:{},s)s.hasOwnProperty(n)&&(i=s[n],e[n]=i&&"object"==typeof i?je(i):i);return e}function Ye(t){return null!==t}function Xe(t){return null===t?void 0:t}var Ze="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function qe(t,e,n){return n=void 0!==n?"".concat(n," "):"",void 0===e&&(e=Ze),"".concat(n).concat(t,"px ").concat(e)}var Je=function(){function t(t){this.k={N:1,C:4,S:NaN,T:"",D:"",A:"",B:0,L:0,F:0,O:0,V:0},this.P=t}return t.prototype.W=function(){var t=this.k,e=this.R(),n=this.I();return t.S===e&&t.D===n||(t.S=e,t.D=n,t.T=qe(e,n),t.O=Math.floor(e/3.5),t.B=t.O,t.L=Math.max(Math.ceil(e/2-t.C/2),0),t.F=Math.ceil(e/2+t.C/2),t.V=Math.round(e/10)),t.A=this.j(),this.k},t.prototype.j=function(){return this.P.W().layout.textColor},t.prototype.R=function(){return this.P.W().layout.fontSize},t.prototype.I=function(){return this.P.W().layout.fontFamily},t}(),Ke=function(){function t(){this.q=[]}return t.prototype.U=function(t){this.q=t},t.prototype.H=function(t,e,n,i){this.q.forEach((function(s){t.save(),s.H(t,e,n,i),t.restore()}))},t}(),Qe=function(){function t(){}return t.prototype.H=function(t,e,n,i){t.save(),t.scale(e,e),this.Y(t,n,i),t.restore()},t.prototype.$=function(t,e,n,i){t.save(),t.scale(e,e),this.K(t,n,i),t.restore()},t.prototype.K=function(t,e,n){},t}(),tn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.X=null,e}return Re(e,t),e.prototype.Z=function(t){this.X=t},e.prototype.Y=function(t){if(null!==this.X&&null!==this.X.J){var e=this.X.J,n=this.X,i=function(i){t.beginPath();for(var s=e.to-1;s>=e.from;--s){var r=n.G[s];t.moveTo(r.tt,r.it),t.arc(r.tt,r.it,i,0,2*Math.PI)}t.fill()};t.fillStyle=n.nt,i(n.st+2),t.fillStyle=n.ht,i(n.st)}},e}(Qe);function en(){return{G:[{tt:0,it:0,rt:0,et:0}],ht:"",nt:"",st:0,J:null}}var nn={from:0,to:1},sn=function(){function t(t,e){this.ut=new Ke,this.ot=[],this.lt=[],this.ft=!0,this.P=t,this.ct=e,this.ut.U(this.ot)}return t.prototype.vt=function(t){var e=this.P._t();e.length!==this.ot.length&&(this.lt=e.map(en),this.ot=this.lt.map((function(t){var e=new tn;return e.Z(t),e})),this.ut.U(this.ot)),this.ft=!0},t.prototype.dt=function(t,e,n){return this.ft&&(this.wt(t),this.ft=!1),this.ut},t.prototype.wt=function(t){var e=this,n=this.P._t(),i=this.ct.Mt(),s=this.P.bt();n.forEach((function(n,r){var o,a=e.lt[r],l=n.gt(i);if(null!==l&&n.yt()){var c=xe(n.kt());a.ht=l.Nt,a.st=l.st,a.G[0].et=l.et,a.G[0].it=n.Ct().xt(l.et,c.St),a.nt=null!==(o=l.Tt)&&void 0!==o?o:e.P.Dt(a.G[0].it/t),a.G[0].rt=i,a.G[0].tt=s.At(i),a.J=nn}else a.J=null}))},t}(),rn=function(){function t(t){this.Bt=t}return t.prototype.H=function(t,e,n,i){if(null!==this.Bt){var s=this.Bt.Lt.yt,r=this.Bt.Et.yt;if(s||r){t.save();var o=Math.round(this.Bt.tt*e),a=Math.round(this.Bt.it*e),l=Math.ceil(this.Bt.Ft*e),c=Math.ceil(this.Bt.Ot*e);t.lineCap="butt",s&&o>=0&&(t.lineWidth=Math.floor(this.Bt.Lt.Vt*e),t.strokeStyle=this.Bt.Lt.A,t.fillStyle=this.Bt.Lt.A,Se(t,this.Bt.Lt.Pt),function(t,e,n,i){t.beginPath();var s=t.lineWidth%2?.5:0;t.moveTo(e+s,0),t.lineTo(e+s,i),t.stroke()}(t,o,0,c)),r&&a>=0&&(t.lineWidth=Math.floor(this.Bt.Et.Vt*e),t.strokeStyle=this.Bt.Et.A,t.fillStyle=this.Bt.Et.A,Se(t,this.Bt.Et.Pt),_e(t,a,0,l)),t.restore()}}},t}(),on=function(){function t(t){this.ft=!0,this.Wt={Lt:{Vt:1,Pt:0,A:"",yt:!1},Et:{Vt:1,Pt:0,A:"",yt:!1},Ft:0,Ot:0,tt:0,it:0},this.zt=new rn(this.Wt),this.Rt=t}return t.prototype.vt=function(){this.ft=!0},t.prototype.dt=function(t,e){return this.ft&&(this.wt(),this.ft=!1),this.zt},t.prototype.wt=function(){var t=this.Rt.yt(),e=xe(this.Rt.It()),n=e.jt().W().crosshair,i=this.Wt;i.Et.yt=t&&this.Rt.qt(e),i.Lt.yt=t&&this.Rt.Ut(),i.Et.Vt=n.horzLine.width,i.Et.Pt=n.horzLine.style,i.Et.A=n.horzLine.color,i.Lt.Vt=n.vertLine.width,i.Lt.Pt=n.vertLine.style,i.Lt.A=n.vertLine.color,i.Ft=e.Ht(),i.Ot=e.Yt(),i.tt=this.Rt.$t(),i.it=this.Rt.Kt()},t}();function an(t,e,n,i,s,r){t.fillRect(e+r,n,i-2*r,r),t.fillRect(e+r,n+s-r,i-2*r,r),t.fillRect(e,n,r,s),t.fillRect(e+i-r,n,r,s)}function ln(t,e,n){t.save(),t.scale(e,e),n(),t.restore()}function cn(t,e,n,i,s,r){t.save(),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(e,n,i,s),t.restore()}function un(t,e,n,i,s,r,o){t.save(),t.globalCompositeOperation="copy";var a=t.createLinearGradient(0,0,0,s);a.addColorStop(0,r),a.addColorStop(1,o),t.fillStyle=a,t.fillRect(e,n,i,s),t.restore()}var hn,dn=function(){function t(t,e){this.Z(t,e)}return t.prototype.Z=function(t,e){this.Bt=t,this.Xt=e},t.prototype.H=function(t,e,n,i,s,r){if(this.Bt.yt){t.font=e.T;var o=this.Bt.Zt||!this.Bt.Jt?e.C:0,a=e.N,l=e.O,c=e.B,u=e.L,h=e.F,d=this.Bt.Gt,p=Math.ceil(n.Qt(t,d)),f=e.V,v=e.S+l+c,g=Math.ceil(.5*v),m=a+p+u+h+o,y=this.Xt.ti;this.Xt.ii&&(y=this.Xt.ii);var b,w,S=(y=Math.round(y))-g,_=S+v,$="right"===s,M=$?i:0,x=Math.ceil(i*r),C=M;if(t.fillStyle=this.Xt.t,t.lineWidth=1,t.lineCap="butt",d){$?(b=M-o,w=(C=M-m)+h):(C=M+m,b=M+o,w=M+a+o+u);var k=Math.max(1,Math.floor(r)),D=Math.max(1,Math.floor(a*r)),V=$?x:0,A=Math.round(S*r),T=Math.round(C*r),B=Math.round(y*r)-Math.floor(.5*r),L=B+k+(B-A),P=Math.round(b*r);t.save(),t.beginPath(),t.moveTo(V,A),t.lineTo(T,A),t.lineTo(T,L),t.lineTo(V,L),t.fill(),t.fillStyle=this.Bt.Tt,t.fillRect($?x-D:0,A,D,L-A),this.Bt.Zt&&(t.fillStyle=this.Xt.A,t.fillRect(V,B,P-V,k)),t.textAlign="left",t.fillStyle=this.Xt.A,ln(t,r,(function(){t.fillText(d,w,_-c-f)})),t.restore()}}},t.prototype.Yt=function(t,e){return this.Bt.yt?t.S+t.O+t.B:0},t}(),pn=function(){function t(t){this.ni={ti:0,A:"#FFF",t:"#000"},this.si={Gt:"",yt:!1,Zt:!0,Jt:!1,Tt:""},this.hi={Gt:"",yt:!1,Zt:!1,Jt:!0,Tt:""},this.ft=!0,this.ri=new(t||dn)(this.si,this.ni),this.ei=new(t||dn)(this.hi,this.ni)}return t.prototype.Gt=function(){return this.ui(),this.si.Gt},t.prototype.ti=function(){return this.ui(),this.ni.ti},t.prototype.vt=function(){this.ft=!0},t.prototype.Yt=function(t,e){return void 0===e&&(e=!1),Math.max(this.ri.Yt(t,e),this.ei.Yt(t,e))},t.prototype.ai=function(){return this.ni.ii||0},t.prototype.oi=function(t){this.ni.ii=t},t.prototype.li=function(){return this.ui(),this.si.yt||this.hi.yt},t.prototype.fi=function(){return this.ui(),this.si.yt},t.prototype.dt=function(t){return this.ui(),this.si.Zt=this.si.Zt&&t.W().drawTicks,this.hi.Zt=this.hi.Zt&&t.W().drawTicks,this.ri.Z(this.si,this.ni),this.ei.Z(this.hi,this.ni),this.ri},t.prototype.ci=function(){return this.ui(),this.ri.Z(this.si,this.ni),this.ei.Z(this.hi,this.ni),this.ei},t.prototype.ui=function(){this.ft&&(this.si.Zt=!0,this.hi.Zt=!1,this.vi(this.si,this.hi,this.ni))},t}(),fn=function(t){function e(e,n,i){var s=t.call(this)||this;return s.Rt=e,s._i=n,s.di=i,s}return Re(e,t),e.prototype.vi=function(t,e,n){t.yt=!1;var i=this.Rt.W().horzLine;if(i.labelVisible){var s=this._i.kt();if(this.Rt.yt()&&!this._i.wi()&&null!==s){var r=Ee(i.labelBackgroundColor);n.t=r.t,n.A=r.i;var o=this.di(this._i);n.ti=o.ti,t.Gt=this._i.Mi(o.et,s),t.yt=!0}}},e}(pn),vn=/[1-9]/g,gn=function(){function t(){this.Bt=null}return t.prototype.Z=function(t){this.Bt=t},t.prototype.H=function(t,e,n){var i=this;if(null!==this.Bt&&!1!==this.Bt.yt&&0!==this.Bt.Gt.length){t.font=e.T;var s=Math.round(e.bi.Qt(t,this.Bt.Gt,vn));if(!(s<=0)){t.save();var r=e.mi,o=s+2*r,a=o/2,l=this.Bt.Ht,c=this.Bt.ti,u=Math.floor(c-a)+.5;u<0?(c+=Math.abs(0-u),u=Math.floor(c-a)+.5):u+o>l&&(c-=Math.abs(l-(u+o)),u=Math.floor(c-a)+.5);var h=u+o,d=0+e.N+e.O+e.S+e.B;t.fillStyle=this.Bt.t;var p=Math.round(u*n),f=Math.round(0*n),v=Math.round(h*n),g=Math.round(d*n);t.fillRect(p,f,v-p,g-f);var m=Math.round(this.Bt.ti*n),y=f,b=Math.round((y+e.N+e.C)*n);t.fillStyle=this.Bt.A;var w=Math.max(1,Math.floor(n)),S=Math.floor(.5*n);t.fillRect(m-S,y,w,b-y);var _=d-e.V-e.B;t.textAlign="left",t.fillStyle=this.Bt.A,ln(t,n,(function(){t.fillText(xe(i.Bt).Gt,u+r,_)})),t.restore()}}},t}(),mn=function(){function t(t,e,n){this.ft=!0,this.zt=new gn,this.Wt={yt:!1,t:"#4c525e",A:"white",Gt:"",Ht:0,ti:NaN},this.ct=t,this.pi=e,this.di=n}return t.prototype.vt=function(){this.ft=!0},t.prototype.dt=function(){return this.ft&&(this.wt(),this.ft=!1),this.zt.Z(this.Wt),this.zt},t.prototype.wt=function(){var t=this.Wt;t.yt=!1;var e=this.ct.W().vertLine;if(e.labelVisible){var n=this.pi.bt();if(!n.wi()){var i=n.gi(this.ct.Mt());t.Ht=n.Ht();var s=this.di();if(s.rt){t.ti=s.ti,t.Gt=n.yi(xe(i)),t.yt=!0;var r=Ee(e.labelBackgroundColor);t.t=r.t,t.A=r.i}}}},t}(),yn=function(){function t(){this.ki=null,this.Ni=0}return t.prototype.xi=function(){return this.Ni},t.prototype.Ci=function(t){this.Ni=t},t.prototype.Ct=function(){return this.ki},t.prototype.Si=function(t){this.ki=t},t.prototype.Ti=function(){return[]},t.prototype.yt=function(){return!0},t}();!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(hn||(hn={}));var bn=function(t){function e(e,n){var i,s,r=t.call(this)||this;r.Di=null,r.Ai=NaN,r.Bi=0,r.Li=!0,r.Ei=new Map,r.Fi=!1,r.Oi=NaN,r.Vi=NaN,r.Pi=NaN,r.Wi=NaN,r.pi=e,r.zi=n,r.Ri=new sn(e,r),r.Ii=(i=function(){return r.Ai},s=function(){return r.Vi},function(t){var e=s(),n=i();if(t===xe(r.Di).ji())return{et:n,ti:e};var o=xe(t.kt());return{et:t.qi(e,o),ti:e}});var o=function(){return{rt:r.pi.bt().gi(r.Bi),ti:r.$t()}};return r.Ui=new mn(r,e,o),r.Hi=new on(r),r}return Re(e,t),e.prototype.W=function(){return this.zi},e.prototype.Yi=function(t,e){this.Pi=t,this.Wi=e},e.prototype.$i=function(){this.Pi=NaN,this.Wi=NaN},e.prototype.Ki=function(){return this.Pi},e.prototype.Xi=function(){return this.Wi},e.prototype.Zi=function(t,e,n){this.Fi||(this.Fi=!0),this.Li=!0,this.Ji(t,e,n)},e.prototype.Mt=function(){return this.Bi},e.prototype.$t=function(){return this.Oi},e.prototype.Kt=function(){return this.Vi},e.prototype.yt=function(){return this.Li},e.prototype.Gi=function(){this.Li=!1,this.Qi(),this.Ai=NaN,this.Oi=NaN,this.Vi=NaN,this.Di=null,this.$i()},e.prototype.tn=function(t){return null!==this.Di?[this.Hi,this.Ri]:[]},e.prototype.qt=function(t){return t===this.Di&&this.zi.horzLine.visible},e.prototype.Ut=function(){return this.zi.vertLine.visible},e.prototype.nn=function(t,e){this.Li&&this.Di===t||this.Ei.clear();var n=[];return this.Di===t&&n.push(this.sn(this.Ei,e,this.Ii)),n},e.prototype.Ti=function(){return this.Li?[this.Ui]:[]},e.prototype.It=function(){return this.Di},e.prototype.hn=function(){this.Hi.vt(),this.Ei.forEach((function(t){return t.vt()})),this.Ui.vt(),this.Ri.vt()},e.prototype.rn=function(t){return t&&!t.ji().wi()?t.ji():null},e.prototype.Ji=function(t,e,n){this.en(t,e,n)&&this.hn()},e.prototype.en=function(t,e,n){var i=this.Oi,s=this.Vi,r=this.Ai,o=this.Bi,a=this.Di,l=this.rn(n);this.Bi=t,this.Oi=isNaN(t)?NaN:this.pi.bt().At(t),this.Di=n;var c=null!==l?l.kt():null;return null!==l&&null!==c?(this.Ai=e,this.Vi=l.xt(e,c)):(this.Ai=NaN,this.Vi=NaN),i!==this.Oi||s!==this.Vi||o!==this.Bi||r!==this.Ai||a!==this.Di},e.prototype.Qi=function(){var t=this.pi._t().map((function(t){return t.an().un()})).filter(Ye),e=0===t.length?null:Math.max.apply(Math,t);this.Bi=null!==e?e:NaN},e.prototype.sn=function(t,e,n){var i=t.get(e);return void 0===i&&(i=new fn(this,e,n),t.set(e,i)),i},e}(yn);function wn(t){return"left"===t||"right"===t}var Sn=function(){function t(t){this.on=new Map,this.ln=[],this.fn=t}return t.prototype.cn=function(t,e){var n=function(t,e){return void 0===t?e:{vn:Math.max(t.vn,e.vn),_n:t._n||e._n}}(this.on.get(t),e);this.on.set(t,n)},t.prototype.dn=function(){return this.fn},t.prototype.wn=function(t){var e=this.on.get(t);return void 0===e?{vn:this.fn}:{vn:Math.max(this.fn,e.vn),_n:e._n}},t.prototype.Mn=function(){this.ln=[{bn:0}]},t.prototype.mn=function(t){this.ln=[{bn:1,St:t}]},t.prototype.pn=function(){this.ln=[{bn:4}]},t.prototype.gn=function(t){this.ln.push({bn:2,St:t})},t.prototype.yn=function(t){this.ln.push({bn:3,St:t})},t.prototype.kn=function(){return this.ln},t.prototype.Nn=function(t){for(var e=this,n=0,i=t.ln;n<i.length;n++){var s=i[n];this.xn(s)}this.fn=Math.max(this.fn,t.fn),t.on.forEach((function(t,n){e.cn(n,t)}))},t.prototype.xn=function(t){switch(t.bn){case 0:this.Mn();break;case 1:this.mn(t.St);break;case 2:this.gn(t.St);break;case 3:this.yn(t.St);break;case 4:this.pn()}},t}();function _n(t,e){if(!Fe(t))return"n/a";if(!We(e))throw new TypeError("invalid length");if(e<0||e>16)throw new TypeError("invalid length");return 0===e?t.toString():("0000000000000000"+t.toString()).slice(-e)}var $n=function(){function t(t,e){if(e||(e=1),Fe(t)&&We(t)||(t=100),t<0)throw new TypeError("invalid base");this._i=t,this.Cn=e,this.Sn()}return t.prototype.format=function(t){var e=t<0?"−":"";return t=Math.abs(t),e+this.Tn(t)},t.prototype.Sn=function(){if(this.Dn=0,this._i>0&&this.Cn>0)for(var t=this._i;t>1;)t/=10,this.Dn++},t.prototype.Tn=function(t){var e=this._i/this.Cn,n=Math.floor(t),i="",s=void 0!==this.Dn?this.Dn:NaN;if(e>1){var r=+(Math.round(t*e)-n*e).toFixed(this.Dn);r>=e&&(r-=e,n+=1),i="."+_n(+r.toFixed(this.Dn)*this.Cn,s)}else n=Math.round(n*e)/e,s>0&&(i="."+_n(0,s));return n.toFixed(0)+i},t}(),Mn=function(t){function e(e){return void 0===e&&(e=100),t.call(this,e)||this}return Re(e,t),e.prototype.format=function(e){return"".concat(t.prototype.format.call(this,e),"%")},e}($n),xn=function(){function t(t){this.An=t}return t.prototype.format=function(t){var e="";return t<0&&(e="-",t=-t),t<995?e+this.Bn(t):t<999995?e+this.Bn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Bn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Bn(t/1e9)+"B")},t.prototype.Bn=function(t){var e=Math.pow(10,this.An);return((t=Math.round(t*e)/e)>=1e-15&&t<1?t.toFixed(this.An).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(function(t,e){return e}))},t}();function Cn(t,e,n,i){if(0!==e.length){var s=e[i.from].tt,r=e[i.from].it;t.moveTo(s,r);for(var o=i.from+1;o<i.to;++o){var a=e[o];if(1===n){var l=e[o-1].it,c=a.tt;t.lineTo(c,l)}t.lineTo(a.tt,a.it)}}}var kn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.X=null,e}return Re(e,t),e.prototype.Z=function(t){this.X=t},e.prototype.Y=function(t){if(null!==this.X&&0!==this.X.G.length&&null!==this.X.J){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.X.Vt,Se(t,this.X.Pt),t.lineWidth=1,t.beginPath(),1===this.X.G.length){var e=this.X.G[0],n=this.X.Ln/2;t.moveTo(e.tt-n,this.X.En),t.lineTo(e.tt-n,e.it),t.lineTo(e.tt+n,e.it),t.lineTo(e.tt+n,this.X.En)}else t.moveTo(this.X.G[this.X.J.from].tt,this.X.En),t.lineTo(this.X.G[this.X.J.from].tt,this.X.G[this.X.J.from].it),Cn(t,this.X.G,this.X.Fn,this.X.J),this.X.J.to>this.X.J.from&&(t.lineTo(this.X.G[this.X.J.to-1].tt,this.X.En),t.lineTo(this.X.G[this.X.J.from].tt,this.X.En));t.closePath(),t.fillStyle=this.On(t),t.fill()}},e}(Qe),Dn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Re(e,t),e.prototype.On=function(t){var e=this.X,n=t.createLinearGradient(0,0,0,e.Vn);return n.addColorStop(0,e.Pn),n.addColorStop(1,e.Wn),n},e}(kn),Vn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.X=null,e}return Re(e,t),e.prototype.Z=function(t){this.X=t},e.prototype.Y=function(t){if(null!==this.X&&0!==this.X.G.length&&null!==this.X.J)if(t.lineCap="butt",t.lineWidth=this.X.Vt,Se(t,this.X.Pt),t.strokeStyle=this.zn(t),t.lineJoin="round",1===this.X.G.length){t.beginPath();var e=this.X.G[0];t.moveTo(e.tt-this.X.Ln/2,e.it),t.lineTo(e.tt+this.X.Ln/2,e.it),void 0!==e.A&&(t.strokeStyle=e.A),t.stroke()}else this.Rn(t,this.X)},e.prototype.Rn=function(t,e){t.beginPath(),Cn(t,e.G,e.Fn,e.J),t.stroke()},e}(Qe),An=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Re(e,t),e.prototype.Rn=function(t,e){var n,i,s=e.G,r=e.J,o=e.Fn,a=e.ht;if(0!==s.length&&null!==r){t.beginPath();var l=s[r.from];t.moveTo(l.tt,l.it);var c=null!==(n=l.A)&&void 0!==n?n:a;t.strokeStyle=c;for(var u=function(e){t.stroke(),t.beginPath(),t.strokeStyle=e,c=e},h=r.from+1;h<r.to;++h){var d=s[h],p=s[h-1],f=null!==(i=d.A)&&void 0!==i?i:a;1===o&&(t.lineTo(d.tt,p.it),f!==c&&(u(f),t.moveTo(d.tt,p.it))),t.lineTo(d.tt,d.it),1!==o&&f!==c&&(u(f),t.moveTo(d.tt,d.it))}t.stroke()}},e.prototype.zn=function(){return this.X.ht},e}(Vn);function Tn(t,e,n,i,s){void 0===i&&(i=0),void 0===s&&(s=t.length);for(var r=s-i;0<r;){var o=r>>1,a=i+o;n(t[a],e)?(i=a+1,r-=o+1):r=o}return i}function Bn(t,e,n,i,s){void 0===i&&(i=0),void 0===s&&(s=t.length);for(var r=s-i;0<r;){var o=r>>1,a=i+o;n(e,t[a])?r=o:(i=a+1,r-=o+1)}return i}function Ln(t,e){return t.rt<e}function Pn(t,e){return t<e.rt}function En(t,e,n){var i=e.In(),s=e.jn(),r=Tn(t,i,Ln),o=Bn(t,s,Pn);if(!n)return{from:r,to:o};var a=r,l=o;return r>0&&r<t.length&&t[r].rt>=i&&(a=r-1),o>0&&o<t.length&&t[o-1].rt<=s&&(l=o+1),{from:a,to:l}}var In=function(){function t(t,e,n){this.qn=!0,this.Un=!0,this.Hn=!0,this.Yn=[],this.$n=null,this.Kn=t,this.Xn=e,this.Zn=n}return t.prototype.vt=function(t){this.qn=!0,"data"===t&&(this.Un=!0),"options"===t&&(this.Hn=!0)},t.prototype.Jn=function(){this.Un&&(this.Gn(),this.Un=!1),this.qn&&(this.Qn(),this.qn=!1),this.Hn&&(this.ts(),this.Hn=!1)},t.prototype.ns=function(){this.$n=null},t.prototype.Qn=function(){var t=this.Kn.Ct(),e=this.Xn.bt();if(this.ns(),!e.wi()&&!t.wi()){var n=e.ss();if(null!==n&&0!==this.Kn.an().hs()){var i=this.Kn.kt();null!==i&&(this.$n=En(this.Yn,n,this.Zn),this.rs(t,e,i.St))}}},t}(),Rn=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return Re(e,t),e.prototype.rs=function(t,e,n){e.es(this.Yn,Xe(this.$n)),t.us(this.Yn,n,Xe(this.$n))},e.prototype.os=function(t,e){return{rt:t,et:e,tt:NaN,it:NaN}},e.prototype.ts=function(){},e.prototype.Gn=function(){var t=this,e=this.Kn.ls();this.Yn=this.Kn.an().fs().map((function(n){var i=n.St[3];return t.cs(n.vs,i,e)}))},e}(In),zn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.zt=new Ke,i._s=new Dn,i.ds=new An,i.zt.U([i._s,i.ds]),i}return Re(e,t),e.prototype.dt=function(t,e){if(!this.Kn.yt())return null;var n=this.Kn.W();return this.Jn(),this._s.Z({Fn:n.lineType,G:this.Yn,Pt:n.lineStyle,Vt:n.lineWidth,Pn:n.topColor,Wn:n.bottomColor,En:t,Vn:t,J:this.$n,Ln:this.Xn.bt().ws()}),this.ds.Z({Fn:n.lineType,G:this.Yn,ht:n.lineColor,Pt:n.lineStyle,Vt:n.lineWidth,J:this.$n,Ln:this.Xn.bt().ws()}),this.zt},e.prototype.cs=function(t,e){return this.os(t,e)},e}(Rn),Un=function(){function t(){this.Bt=null,this.Ms=0,this.bs=0}return t.prototype.Z=function(t){this.Bt=t},t.prototype.H=function(t,e,n,i){if(null!==this.Bt&&0!==this.Bt.an.length&&null!==this.Bt.J){this.Ms=this.ps(e),this.Ms>=2&&Math.max(1,Math.floor(e))%2!=this.Ms%2&&this.Ms--,this.bs=this.Bt.gs?Math.min(this.Ms,Math.floor(e)):this.Ms;for(var s=null,r=this.bs<=this.Ms&&this.Bt.ws>=Math.floor(1.5*e),o=this.Bt.J.from;o<this.Bt.J.to;++o){var a=this.Bt.an[o];s!==a.A&&(t.fillStyle=a.A,s=a.A);var l=Math.floor(.5*this.bs),c=Math.round(a.tt*e),u=c-l,h=this.bs,d=u+h-1,p=Math.min(a.ys,a.ks),f=Math.max(a.ys,a.ks),v=Math.round(p*e)-l,g=Math.round(f*e)+l,m=Math.max(g-v,this.bs);t.fillRect(u,v,h,m);var y=Math.ceil(1.5*this.Ms);if(r){if(this.Bt.Ns){var b=c-y,w=Math.max(v,Math.round(a.xs*e)-l),S=w+h-1;S>v+m-1&&(w=(S=v+m-1)-h+1),t.fillRect(b,w,u-b,S-w+1)}var _=c+y,$=Math.max(v,Math.round(a.Cs*e)-l),M=$+h-1;M>v+m-1&&($=(M=v+m-1)-h+1),t.fillRect(d+1,$,_-d,M-$+1)}}}},t.prototype.ps=function(t){var e=Math.floor(t);return Math.max(e,Math.floor(function(t,e){return Math.floor(.3*t*e)}(xe(this.Bt).ws,t)))},t}(),Nn=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return Re(e,t),e.prototype.rs=function(t,e,n){e.es(this.Yn,Xe(this.$n)),t.Ss(this.Yn,n,Xe(this.$n))},e.prototype.Ts=function(t,e,n){return{rt:t,open:e.St[0],high:e.St[1],low:e.St[2],close:e.St[3],tt:NaN,xs:NaN,ys:NaN,ks:NaN,Cs:NaN}},e.prototype.Gn=function(){var t=this,e=this.Kn.ls();this.Yn=this.Kn.an().fs().map((function(n){return t.cs(n.vs,n,e)}))},e}(In),On=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zt=new Un,e}return Re(e,t),e.prototype.dt=function(t,e){if(!this.Kn.yt())return null;var n=this.Kn.W();this.Jn();var i={an:this.Yn,ws:this.Xn.bt().ws(),Ns:n.openVisible,gs:n.thinBars,J:this.$n};return this.zt.Z(i),this.zt},e.prototype.ts=function(){var t=this;this.Yn.forEach((function(e){e.A=t.Kn.ls().As(e.rt).Ds}))},e.prototype.cs=function(t,e,n){return ze(ze({},this.Ts(t,e,n)),{A:n.As(t).Ds})},e}(Nn);function Fn(t,e,n){return Math.min(Math.max(t,e),n)}function Wn(t,e,n){return e-t<=n}function Hn(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function Gn(t){var e=Math.ceil(t);return e%2!=0?e-1:e}function jn(t){var e=Math.ceil(t);return e%2==0?e-1:e}var Yn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Re(e,t),e.prototype.On=function(t){var e=this.X,n=t.createLinearGradient(0,0,0,e.Vn),i=Fn(e.En/e.Vn,0,1);return n.addColorStop(0,e.Bs),n.addColorStop(i,e.Ls),n.addColorStop(i,e.Es),n.addColorStop(1,e.Fs),n},e}(kn),Xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Re(e,t),e.prototype.zn=function(t){var e=this.X,n=t.createLinearGradient(0,0,0,e.Vn),i=Fn(e.En/e.Vn,0,1);return n.addColorStop(0,e.Pn),n.addColorStop(i,e.Pn),n.addColorStop(i,e.Wn),n.addColorStop(1,e.Wn),n},e}(Vn),Zn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.Os=new Yn,i.Vs=new Xn,i.ut=new Ke,i.ut.U([i.Os,i.Vs]),i}return Re(e,t),e.prototype.dt=function(t,e){if(!this.Kn.yt())return null;var n=this.Kn.kt();if(null===n)return null;var i=this.Kn.W();this.Jn();var s=this.Kn.Ct().xt(i.baseValue.price,n.St),r=this.Xn.bt().ws();return this.Os.Z({G:this.Yn,Bs:i.topFillColor1,Ls:i.topFillColor2,Es:i.bottomFillColor1,Fs:i.bottomFillColor2,Vt:i.lineWidth,Pt:i.lineStyle,Fn:0,En:s,Vn:t,J:this.$n,Ln:r}),this.Vs.Z({G:this.Yn,Pn:i.topLineColor,Wn:i.bottomLineColor,Vt:i.lineWidth,Pt:i.lineStyle,Fn:0,En:s,Vn:t,J:this.$n,Ln:r}),this.ut},e.prototype.cs=function(t,e){return this.os(t,e)},e}(Rn),qn=function(){function t(){this.Bt=null,this.Ms=0}return t.prototype.Z=function(t){this.Bt=t},t.prototype.H=function(t,e,n,i){if(null!==this.Bt&&0!==this.Bt.an.length&&null!==this.Bt.J){this.Ms=function(t,e){if(t>=2.5&&t<=4)return Math.floor(3*e);var n=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),i=Math.floor(t*n*e),s=Math.floor(t*e),r=Math.min(i,s);return Math.max(Math.floor(e),r)}(this.Bt.ws,e),this.Ms>=2&&Math.floor(e)%2!=this.Ms%2&&this.Ms--;var s=this.Bt.an;this.Bt.Ps&&this.Ws(t,s,this.Bt.J,e),this.Bt.zs&&this.Rs(t,s,this.Bt.J,this.Bt.ws,e);var r=this.Is(e);(!this.Bt.zs||this.Ms>2*r)&&this.js(t,s,this.Bt.J,e)}},t.prototype.Ws=function(t,e,n,i){if(null!==this.Bt){var s="",r=Math.min(Math.floor(i),Math.floor(this.Bt.ws*i));r=Math.max(Math.floor(i),Math.min(r,this.Ms));for(var o=Math.floor(.5*r),a=null,l=n.from;l<n.to;l++){var c=e[l];c.qs!==s&&(t.fillStyle=c.qs,s=c.qs);var u=Math.round(Math.min(c.xs,c.Cs)*i),h=Math.round(Math.max(c.xs,c.Cs)*i),d=Math.round(c.ys*i),p=Math.round(c.ks*i),f=Math.round(i*c.tt)-o,v=f+r-1;null!==a&&(f=Math.max(a+1,f),f=Math.min(f,v));var g=v-f+1;t.fillRect(f,d,g,u-d),t.fillRect(f,h+1,g,p-h),a=v}}},t.prototype.Is=function(t){var e=Math.floor(1*t);this.Ms<=2*e&&(e=Math.floor(.5*(this.Ms-1)));var n=Math.max(Math.floor(t),e);return this.Ms<=2*n?Math.max(Math.floor(t),Math.floor(1*t)):n},t.prototype.Rs=function(t,e,n,i,s){if(null!==this.Bt)for(var r="",o=this.Is(s),a=null,l=n.from;l<n.to;l++){var c=e[l];c.Tt!==r&&(t.fillStyle=c.Tt,r=c.Tt);var u=Math.round(c.tt*s)-Math.floor(.5*this.Ms),h=u+this.Ms-1,d=Math.round(Math.min(c.xs,c.Cs)*s),p=Math.round(Math.max(c.xs,c.Cs)*s);if(null!==a&&(u=Math.max(a+1,u),u=Math.min(u,h)),this.Bt.ws*s>2*o)an(t,u,d,h-u+1,p-d+1,o);else{var f=h-u+1;t.fillRect(u,d,f,p-d+1)}a=h}},t.prototype.js=function(t,e,n,i){if(null!==this.Bt)for(var s="",r=this.Is(i),o=n.from;o<n.to;o++){var a=e[o],l=Math.round(Math.min(a.xs,a.Cs)*i),c=Math.round(Math.max(a.xs,a.Cs)*i),u=Math.round(a.tt*i)-Math.floor(.5*this.Ms),h=u+this.Ms-1;if(a.A!==s){var d=a.A;t.fillStyle=d,s=d}this.Bt.zs&&(u+=r,l+=r,h-=r,c-=r),l>c||t.fillRect(u,l,h-u+1,c-l+1)}},t}(),Jn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zt=new qn,e}return Re(e,t),e.prototype.dt=function(t,e){if(!this.Kn.yt())return null;var n=this.Kn.W();this.Jn();var i={an:this.Yn,ws:this.Xn.bt().ws(),Ps:n.wickVisible,zs:n.borderVisible,J:this.$n};return this.zt.Z(i),this.zt},e.prototype.ts=function(){var t=this;this.Yn.forEach((function(e){var n=t.Kn.ls().As(e.rt);e.A=n.Ds,e.qs=n.Us,e.Tt=n.Hs}))},e.prototype.cs=function(t,e,n){var i=n.As(t);return ze(ze({},this.Ts(t,e,n)),{A:i.Ds,qs:i.Us,Tt:i.Hs})},e}(Nn),Kn=function(){function t(){this.Bt=null,this.Ys=[]}return t.prototype.Z=function(t){this.Bt=t,this.Ys=[]},t.prototype.H=function(t,e,n,i){if(null!==this.Bt&&0!==this.Bt.G.length&&null!==this.Bt.J){this.Ys.length||this.$s(e);for(var s=Math.max(1,Math.floor(e)),r=Math.round(this.Bt.Ks*e)-Math.floor(s/2),o=r+s,a=this.Bt.J.from;a<this.Bt.J.to;a++){var l=this.Bt.G[a],c=this.Ys[a-this.Bt.J.from],u=Math.round(l.it*e);t.fillStyle=l.A;var h=void 0,d=void 0;u<=r?(h=u,d=o):(h=r,d=u-Math.floor(s/2)+s),t.fillRect(c.In,h,c.jn-c.In+1,d-h)}}},t.prototype.$s=function(t){if(null!==this.Bt&&0!==this.Bt.G.length&&null!==this.Bt.J){var e=Math.ceil(this.Bt.ws*t)<=1?0:Math.max(1,Math.floor(t)),n=Math.round(this.Bt.ws*t)-e;this.Ys=new Array(this.Bt.J.to-this.Bt.J.from);for(var i=this.Bt.J.from;i<this.Bt.J.to;i++){var s,r=this.Bt.G[i],o=Math.round(r.tt*t),a=void 0,l=void 0;n%2?(a=o-(s=(n-1)/2),l=o+s):(a=o-(s=n/2),l=o+s-1),this.Ys[i-this.Bt.J.from]={In:a,jn:l,Xs:o,Zs:r.tt*t,rt:r.rt}}for(i=this.Bt.J.from+1;i<this.Bt.J.to;i++){var c=this.Ys[i-this.Bt.J.from],u=this.Ys[i-this.Bt.J.from-1];c.rt===u.rt+1&&c.In-u.jn!==e+1&&(u.Xs>u.Zs?u.jn=c.In-e-1:c.In=u.jn+e+1)}var h=Math.ceil(this.Bt.ws*t);for(i=this.Bt.J.from;i<this.Bt.J.to;i++){(c=this.Ys[i-this.Bt.J.from]).jn<c.In&&(c.jn=c.In);var d=c.jn-c.In+1;h=Math.min(d,h)}if(e>0&&h<4)for(i=this.Bt.J.from;i<this.Bt.J.to;i++)(d=(c=this.Ys[i-this.Bt.J.from]).jn-c.In+1)>h&&(c.Xs>c.Zs?c.jn-=1:c.In+=1)}else this.Ys=[]},t}();function Qn(t){return{G:[],ws:t,Ks:NaN,J:null}}function ti(t,e,n){return{rt:t,et:e,tt:NaN,it:NaN,A:n}}var ei=function(t){function e(e,n){var i=t.call(this,e,n,!1)||this;return i.ut=new Ke,i.Js=Qn(0),i.zt=new Kn,i}return Re(e,t),e.prototype.dt=function(t,e){return this.Kn.yt()?(this.Jn(),this.ut):null},e.prototype.Gn=function(){var t=this.Xn.bt().ws();this.Js=Qn(t);for(var e=0,n=0,i=this.Kn.W().color,s=0,r=this.Kn.an().fs();s<r.length;s++){var o=r[s],a=o.St[3],l=void 0!==o.A?o.A:i,c=ti(o.vs,a,l);++e<this.Js.G.length?this.Js.G[e]=c:this.Js.G.push(c),this.Yn[n++]={rt:o.vs,tt:0}}this.zt.Z(this.Js),this.ut.U([this.zt])},e.prototype.ts=function(){},e.prototype.ns=function(){t.prototype.ns.call(this),this.Js.J=null},e.prototype.rs=function(t,e,n){if(null!==this.$n){var i=e.ws(),s=xe(e.ss()),r=t.xt(this.Kn.W().base,n);e.es(this.Js.G),t.us(this.Js.G,n),this.Js.Ks=r,this.Js.J=En(this.Js.G,s,!1),this.Js.ws=i,this.zt.Z(this.Js)}},e}(In),ni=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.ds=new An,i}return Re(e,t),e.prototype.dt=function(t,e){if(!this.Kn.yt())return null;var n=this.Kn.W();this.Jn();var i={G:this.Yn,ht:n.color,Pt:n.lineStyle,Fn:n.lineType,Vt:n.lineWidth,J:this.$n,Ln:this.Xn.bt().ws()};return this.ds.Z(i),this.ds},e.prototype.ts=function(){var t=this;this.Yn.forEach((function(e){e.A=t.Kn.ls().As(e.rt).Ds}))},e.prototype.cs=function(t,e,n){var i=this.os(t,e);return i.A=n.As(t).Ds,i},e}(Rn),ii=/[2-9]/g,si=function(){function t(t){void 0===t&&(t=50),this.Gs=new Map,this.Qs=0,this.th=Array.from(new Array(t))}return t.prototype.ih=function(){this.Gs.clear(),this.th.fill(void 0)},t.prototype.Qt=function(t,e,n){var i=n||ii,s=String(e).replace(i,"0"),r=this.Gs.get(s);if(void 0===r){if(0===(r=t.measureText(s).width)&&0!==e.length)return 0;var o=this.th[this.Qs];void 0!==o&&this.Gs.delete(o),this.th[this.Qs]=s,this.Qs=(this.Qs+1)%this.th.length,this.Gs.set(s,r)}return r},t}(),ri=function(){function t(t){this.nh=null,this.k=null,this.sh="right",this.hh=0,this.rh=t}return t.prototype.eh=function(t,e,n,i){this.nh=t,this.k=e,this.hh=n,this.sh=i},t.prototype.H=function(t,e){null!==this.k&&null!==this.nh&&this.nh.H(t,this.k,this.rh,this.hh,this.sh,e)},t}(),oi=function(){function t(t,e,n){this.uh=t,this.rh=new si(50),this.ah=e,this.P=n,this.R=-1,this.zt=new ri(this.rh)}return t.prototype.dt=function(t,e){var n=this.P.oh(this.ah);if(null===n)return null;var i=n.lh(this.ah)?n.fh():this.ah.Ct();if(null===i)return null;var s=n._h(i);if("overlay"===s)return null;var r=this.P.dh();return r.S!==this.R&&(this.R=r.S,this.rh.ih()),this.zt.eh(this.uh.ci(),r,e,s),this.zt},t}(),ai=function(){function t(){this.Bt=null}return t.prototype.Z=function(t){this.Bt=t},t.prototype.H=function(t,e,n,i){if(null!==this.Bt&&!1!==this.Bt.yt){var s=Math.round(this.Bt.it*e);if(!(s<0||s>Math.ceil(this.Bt.Yt*e))){var r=Math.ceil(this.Bt.Ht*e);t.lineCap="butt",t.strokeStyle=this.Bt.A,t.lineWidth=Math.floor(this.Bt.Vt*e),Se(t,this.Bt.Pt),_e(t,s,0,r)}}},t}(),li=function(){function t(t){this.wh={Ht:0,Yt:0,it:0,A:"rgba(0, 0, 0, 0)",Vt:1,Pt:0,yt:!1},this.Mh=new ai,this.ft=!0,this.Kn=t,this.Xn=t.jt(),this.Mh.Z(this.wh)}return t.prototype.vt=function(){this.ft=!0},t.prototype.dt=function(t,e){return this.Kn.yt()?(this.ft&&(this.bh(t,e),this.ft=!1),this.Mh):null},t}(),ci=function(t){function e(e){return t.call(this,e)||this}return Re(e,t),e.prototype.bh=function(t,e){this.wh.yt=!1;var n=this.Kn.Ct(),i=n.mh().mh;if(2===i||3===i){var s=this.Kn.W();if(s.baseLineVisible&&this.Kn.yt()){var r=this.Kn.kt();null!==r&&(this.wh.yt=!0,this.wh.it=n.xt(r.St,r.St),this.wh.Ht=e,this.wh.Yt=t,this.wh.A=s.baseLineColor,this.wh.Vt=s.baseLineWidth,this.wh.Pt=s.baseLineStyle)}}},e}(li),ui=function(){function t(){this.Bt=null}return t.prototype.Z=function(t){this.Bt=t},t.prototype.ph=function(){return this.Bt},t.prototype.H=function(t,e,n,i){var s=this.Bt;if(null!==s){t.save();var r=Math.max(1,Math.floor(e)),o=r%2/2,a=Math.round(s.Zs.x*e)+o,l=s.Zs.y*e;t.fillStyle=s.gh,t.beginPath();var c=Math.max(2,1.5*s.yh)*e;t.arc(a,l,c,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.kh,t.beginPath(),t.arc(a,l,s.st*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=s.Nh,t.beginPath(),t.arc(a,l,s.st*e+r/2,0,2*Math.PI,!1),t.stroke(),t.restore()}},t}(),hi=[{xh:0,Ch:.25,Sh:4,Th:10,Dh:.25,Ah:0,Bh:.4,Lh:.8},{xh:.25,Ch:.525,Sh:10,Th:14,Dh:0,Ah:0,Bh:.8,Lh:0},{xh:.525,Ch:1,Sh:14,Th:14,Dh:0,Ah:0,Bh:0,Lh:0}];function di(t,e,n,i){return function(t,e){if("transparent"===t)return t;var n=Pe(t),i=n[3];return"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", ").concat(e*i,")")}(t,n+(i-n)*e)}function pi(t,e){for(var n,i=t%2600/2600,s=0,r=hi;s<r.length;s++){var o=r[s];if(i>=o.xh&&i<=o.Ch){n=o;break}}$e(void 0!==n,"Last price animation internal logic error");var a,l,c,u=(i-n.xh)/(n.Ch-n.xh);return{kh:di(e,u,n.Dh,n.Ah),Nh:di(e,u,n.Bh,n.Lh),st:(a=u,l=n.Sh,c=n.Th,l+(c-l)*a)}}var fi=function(){function t(t){this.zt=new ui,this.ft=!0,this.Eh=!0,this.Fh=performance.now(),this.Oh=this.Fh-1,this.Vh=t}return t.prototype.Ph=function(){this.Oh=this.Fh-1,this.vt()},t.prototype.Wh=function(){if(this.vt(),2===this.Vh.W().lastPriceAnimation){var t=performance.now(),e=this.Oh-t;if(e>0)return void(e<650&&(this.Oh+=2600));this.Fh=t,this.Oh=t+2600}},t.prototype.vt=function(){this.ft=!0},t.prototype.zh=function(){this.Eh=!0},t.prototype.yt=function(){return 0!==this.Vh.W().lastPriceAnimation},t.prototype.Rh=function(){switch(this.Vh.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Oh}},t.prototype.dt=function(t,e){return this.ft?(this.wt(t,e),this.ft=!1,this.Eh=!1):this.Eh&&(this.Ih(),this.Eh=!1),this.zt},t.prototype.wt=function(t,e){this.zt.Z(null);var n=this.Vh.jt().bt(),i=n.ss(),s=this.Vh.kt();if(null!==i&&null!==s){var r=this.Vh.jh(!0);if(!r.qh&&i.Uh(r.vs)){var o={x:n.At(r.vs),y:this.Vh.Ct().xt(r.et,s.St)},a=r.A,l=this.Vh.W().lineWidth,c=pi(this.Hh(),a);this.zt.Z({gh:a,yh:l,kh:c.kh,Nh:c.Nh,st:c.st,Zs:o})}}},t.prototype.Ih=function(){var t=this.zt.ph();if(null!==t){var e=pi(this.Hh(),t.gh);t.kh=e.kh,t.Nh=e.Nh,t.st=e.st}},t.prototype.Hh=function(){return this.Rh()?performance.now()-this.Fh:2599},t}();function vi(t,e){return jn(Math.min(Math.max(t,12),30)*e)}function gi(t,e){switch(t){case"arrowDown":case"arrowUp":return vi(e,1);case"circle":return vi(e,.8);case"square":return vi(e,.7)}}function mi(t){return Gn(vi(t,1))}function yi(t){return Math.max(vi(t,.1),3)}function bi(t,e,n,i,s){var r=gi("square",n),o=(r-1)/2,a=t-o,l=e-o;return i>=a&&i<=a+r&&s>=l&&s<=l+r}function wi(t,e,n,i,s){var r=(gi("arrowUp",s)-1)/2,o=(jn(s/2)-1)/2;e.beginPath(),t?(e.moveTo(n-r,i),e.lineTo(n,i-r),e.lineTo(n+r,i),e.lineTo(n+o,i),e.lineTo(n+o,i+r),e.lineTo(n-o,i+r),e.lineTo(n-o,i)):(e.moveTo(n-r,i),e.lineTo(n,i+r),e.lineTo(n+r,i),e.lineTo(n+o,i),e.lineTo(n+o,i-r),e.lineTo(n-o,i-r),e.lineTo(n-o,i)),e.fill()}var Si=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Bt=null,e.rh=new si,e.R=-1,e.I="",e.Yh="",e}return Re(e,t),e.prototype.Z=function(t){this.Bt=t},e.prototype.eh=function(t,e){this.R===t&&this.I===e||(this.R=t,this.I=e,this.Yh=qe(t,e),this.rh.ih())},e.prototype.$h=function(t,e){if(null===this.Bt||null===this.Bt.J)return null;for(var n=this.Bt.J.from;n<this.Bt.J.to;n++){var i=this.Bt.G[n];if($i(i,t,e))return{Kh:i.Xh,Zh:i.Zh}}return null},e.prototype.Y=function(t,e,n){if(null!==this.Bt&&null!==this.Bt.J){t.textBaseline="middle",t.font=this.Yh;for(var i=this.Bt.J.from;i<this.Bt.J.to;i++){var s=this.Bt.G[i];void 0!==s.Gt&&(s.Gt.Ht=this.rh.Qt(t,s.Gt.Jh),s.Gt.Yt=this.R),_i(s,t)}}},e}(Qe);function _i(t,e){e.fillStyle=t.A,void 0!==t.Gt&&function(t,e,n,i){t.fillText(e,n,i)}(e,t.Gt.Jh,t.tt-t.Gt.Ht/2,t.Gt.it),function(t,e){if(0!==t.hs){switch(t.Gh){case"arrowDown":return void wi(!1,e,t.tt,t.it,t.hs);case"arrowUp":return void wi(!0,e,t.tt,t.it,t.hs);case"circle":return void function(t,e,n,i){var s=(gi("circle",i)-1)/2;t.beginPath(),t.arc(e,n,s,0,2*Math.PI,!1),t.fill()}(e,t.tt,t.it,t.hs);case"square":return void function(t,e,n,i){var s=gi("square",i),r=(s-1)/2,o=e-r,a=n-r;t.fillRect(o,a,s,s)}(e,t.tt,t.it,t.hs)}t.Gh}}(t,e)}function $i(t,e,n){return!(void 0===t.Gt||!function(t,e,n,i,s,r){var o=i/2;return s>=t&&s<=t+n&&r>=e-o&&r<=e+o}(t.tt,t.Gt.it,t.Gt.Ht,t.Gt.Yt,e,n))||function(t,e,n){if(0===t.hs)return!1;switch(t.Gh){case"arrowDown":case"arrowUp":return function(t,e,n,i,s,r){return bi(e,n,i,s,r)}(0,t.tt,t.it,t.hs,e,n);case"circle":return function(t,e,n,i,s){var r=2+gi("circle",n)/2,o=t-i,a=e-s;return Math.sqrt(o*o+a*a)<=r}(t.tt,t.it,t.hs,e,n);case"square":return bi(t.tt,t.it,t.hs,e,n)}}(t,e,n)}function Mi(t,e,n,i,s,r,o,a,l){var c=Fe(n)?n:n.close,u=Fe(n)?n:n.high,h=Fe(n)?n:n.low,d=Fe(e.size)?Math.max(e.size,0):1,p=mi(a.ws())*d,f=p/2;switch(t.hs=p,e.position){case"inBar":return t.it=o.xt(c,l),void(void 0!==t.Gt&&(t.Gt.it=t.it+f+r+.6*s));case"aboveBar":return t.it=o.xt(u,l)-f-i.Qh,void 0!==t.Gt&&(t.Gt.it=t.it-f-.6*s,i.Qh+=1.2*s),void(i.Qh+=p+r);case"belowBar":return t.it=o.xt(h,l)+f+i.tr,void 0!==t.Gt&&(t.Gt.it=t.it+f+r+.6*s,i.tr+=1.2*s),void(i.tr+=p+r)}e.position}var xi=function(){function t(t,e){this.ft=!0,this.ir=!0,this.nr=!0,this.sr=null,this.zt=new Si,this.Vh=t,this.pi=e,this.Bt={G:[],J:null}}return t.prototype.vt=function(t){this.ft=!0,this.nr=!0,"data"===t&&(this.ir=!0)},t.prototype.dt=function(t,e,n){if(!this.Vh.yt())return null;this.ft&&this.Jn();var i=this.pi.W().layout;return this.zt.eh(i.fontSize,i.fontFamily),this.zt.Z(this.Bt),this.zt},t.prototype.hr=function(){if(this.nr){if(this.Vh.rr().length>0){var t=this.pi.bt().ws(),e=yi(t),n=1.5*mi(t)+2*e;this.sr={above:n,below:n}}else this.sr=null;this.nr=!1}return this.sr},t.prototype.Jn=function(){var t=this.Vh.Ct(),e=this.pi.bt(),n=this.Vh.rr();this.ir&&(this.Bt.G=n.map((function(t){return{rt:t.time,tt:0,it:0,hs:0,Gh:t.shape,A:t.color,Xh:t.Xh,Zh:t.id,Gt:void 0}})),this.ir=!1);var i=this.pi.W().layout;this.Bt.J=null;var s=e.ss();if(null!==s){var r=this.Vh.kt();if(null!==r&&0!==this.Bt.G.length){var o=NaN,a=yi(e.ws()),l={Qh:a,tr:a};this.Bt.J=En(this.Bt.G,s,!0);for(var c=this.Bt.J.from;c<this.Bt.J.to;c++){var u=n[c];u.time!==o&&(l.Qh=a,l.tr=a,o=u.time);var h=this.Bt.G[c];h.tt=e.At(u.time),void 0!==u.text&&u.text.length>0&&(h.Gt={Jh:u.text,it:0,Ht:0,Yt:0});var d=this.Vh.er(u.time);null!==d&&Mi(h,u,d,l,i.fontSize,a,t,e,r.St)}this.ft=!1}}},t}(),Ci=function(t){function e(e){return t.call(this,e)||this}return Re(e,t),e.prototype.bh=function(t,e){var n=this.wh;n.yt=!1;var i=this.Kn.W();if(i.priceLineVisible&&this.Kn.yt()){var s=this.Kn.jh(0===i.priceLineSource);s.qh||(n.yt=!0,n.it=s.ti,n.A=this.Kn.ur(s.A),n.Ht=e,n.Yt=t,n.Vt=i.priceLineWidth,n.Pt=i.priceLineStyle)}},e}(li),ki=function(t){function e(e){var n=t.call(this)||this;return n.Rt=e,n}return Re(e,t),e.prototype.vi=function(t,e,n){t.yt=!1,e.yt=!1;var i=this.Rt;if(i.yt()){var s=i.W(),r=s.lastValueVisible,o=""!==i.ar(),a=0===s.seriesLastValueMode,l=i.jh(!1);if(!l.qh){r&&(t.Gt=this.lr(l,r,a),t.yt=0!==t.Gt.length),(o||a)&&(e.Gt=this.cr(l,r,o,a),e.yt=e.Gt.length>0);var c=i.ur(l.A),u=Ee(c);n.t=u.t,n.A=u.i,n.ti=l.ti,e.Tt=i.jt().Dt(l.ti/i.Ct().Yt()),t.Tt=c}}},e.prototype.cr=function(t,e,n,i){var s="",r=this.Rt.ar();return n&&0!==r.length&&(s+="".concat(r," ")),e&&i&&(s+=this.Rt.Ct().vr()?t._r:t.dr),s.trim()},e.prototype.lr=function(t,e,n){return e?n?this.Rt.Ct().vr()?t.dr:t._r:t.Gt:""},e}(pn),Di=function(){function t(t,e){this.wr=t,this.Mr=e}return t.prototype.br=function(t){return null!==t&&this.wr===t.wr&&this.Mr===t.Mr},t.prototype.mr=function(){return new t(this.wr,this.Mr)},t.prototype.pr=function(){return this.wr},t.prototype.gr=function(){return this.Mr},t.prototype.yr=function(){return this.Mr-this.wr},t.prototype.wi=function(){return this.Mr===this.wr||Number.isNaN(this.Mr)||Number.isNaN(this.wr)},t.prototype.Nn=function(e){return null===e?this:new t(Math.min(this.pr(),e.pr()),Math.max(this.gr(),e.gr()))},t.prototype.kr=function(t){if(Fe(t)&&0!=this.Mr-this.wr){var e=.5*(this.Mr+this.wr),n=this.Mr-e,i=this.wr-e;n*=t,i*=t,this.Mr=e+n,this.wr=e+i}},t.prototype.Nr=function(t){Fe(t)&&(this.Mr+=t,this.wr+=t)},t.prototype.Cr=function(){return{minValue:this.wr,maxValue:this.Mr}},t.Sr=function(e){return null===e?null:new t(e.minValue,e.maxValue)},t}(),Vi=function(){function t(t,e){this.Tr=t,this.Dr=e||null}return t.prototype.Ar=function(){return this.Tr},t.prototype.Br=function(){return this.Dr},t.prototype.Cr=function(){return null===this.Tr?null:{priceRange:this.Tr.Cr(),margins:this.Dr||void 0}},t.Sr=function(e){return null===e?null:new t(Di.Sr(e.priceRange),e.margins)},t}(),Ai=function(t){function e(e,n){var i=t.call(this,e)||this;return i.Lr=n,i}return Re(e,t),e.prototype.bh=function(t,e){var n=this.wh;n.yt=!1;var i=this.Lr.W();if(this.Kn.yt()&&i.lineVisible){var s=this.Lr.Er();null!==s&&(n.yt=!0,n.it=s,n.A=i.color,n.Ht=e,n.Yt=t,n.Vt=i.lineWidth,n.Pt=i.lineStyle)}},e}(li),Ti=function(t){function e(e,n){var i=t.call(this)||this;return i.Vh=e,i.Lr=n,i}return Re(e,t),e.prototype.vi=function(t,e,n){t.yt=!1,e.yt=!1;var i=this.Lr.W(),s=i.axisLabelVisible,r=""!==i.title,o=this.Vh;if(s&&o.yt()){var a=this.Lr.Er();if(null!==a){r&&(e.Gt=i.title,e.yt=!0),e.Tt=o.jt().Dt(a/o.Ct().Yt()),t.Gt=o.Ct().Fr(i.price),t.yt=!0;var l=Ee(i.color);n.t=l.t,n.A=l.i,n.ti=a}}},e}(pn),Bi=function(){function t(t,e){this.Vh=t,this.zi=e,this.Or=new Ai(t,this),this.uh=new Ti(t,this),this.Vr=new oi(this.uh,t,t.jt())}return t.prototype.Pr=function(t){Oe(this.zi,t),this.vt(),this.Vh.jt().Wr()},t.prototype.W=function(){return this.zi},t.prototype.tn=function(){return[this.Or,this.Vr]},t.prototype.zr=function(){return this.uh},t.prototype.vt=function(){this.Or.vt(),this.uh.vt()},t.prototype.Er=function(){var t=this.Vh,e=t.Ct();if(t.jt().bt().wi()||e.wi())return null;var n=t.kt();return null===n?null:e.xt(this.zi.price,n.St)},t}(),Li=function(t){function e(e){var n=t.call(this)||this;return n.pi=e,n}return Re(e,t),e.prototype.jt=function(){return this.pi},e}(yn),Pi={Ds:"",Hs:"",Us:""},Ei=function(){function t(t){this.Vh=t}return t.prototype.As=function(t,e){var n=this.Vh.Rr(),i=this.Vh.W();switch(n){case"Line":return this.Ir(i,t,e);case"Area":return this.jr(i);case"Baseline":return this.qr(i,t,e);case"Bar":return this.Ur(i,t,e);case"Candlestick":return this.Hr(i,t,e);case"Histogram":return this.Yr(i,t,e)}throw new Error("Unknown chart style")},t.prototype.Ur=function(t,e,n){var i=ze({},Pi),s=t.upColor,r=t.downColor,o=s,a=r,l=xe(this.$r(e,n)),c=Ce(l.St[0])<=Ce(l.St[3]);return void 0!==l.A?(i.Ds=l.A,i.Hs=l.A):(i.Ds=c?s:r,i.Hs=c?o:a),i},t.prototype.Hr=function(t,e,n){var i,s,r,o=ze({},Pi),a=t.upColor,l=t.downColor,c=t.borderUpColor,u=t.borderDownColor,h=t.wickUpColor,d=t.wickDownColor,p=xe(this.$r(e,n)),f=Ce(p.St[0])<=Ce(p.St[3]);return o.Ds=null!==(i=p.A)&&void 0!==i?i:f?a:l,o.Hs=null!==(s=p.Tt)&&void 0!==s?s:f?c:u,o.Us=null!==(r=p.qs)&&void 0!==r?r:f?h:d,o},t.prototype.jr=function(t){return ze(ze({},Pi),{Ds:t.lineColor})},t.prototype.qr=function(t,e,n){var i=xe(this.$r(e,n)).St[3]>=t.baseValue.price;return ze(ze({},Pi),{Ds:i?t.topLineColor:t.bottomLineColor})},t.prototype.Ir=function(t,e,n){var i,s=xe(this.$r(e,n));return ze(ze({},Pi),{Ds:null!==(i=s.A)&&void 0!==i?i:t.color})},t.prototype.Yr=function(t,e,n){var i=ze({},Pi),s=xe(this.$r(e,n));return i.Ds=void 0!==s.A?s.A:t.color,i},t.prototype.$r=function(t,e){return void 0!==e?e.St:this.Vh.an().Kr(t)},t}(),Ii=function(){function t(){this.Xr=[],this.Zr=new Map,this.Jr=new Map}return t.prototype.Gr=function(){return this.hs()>0?this.Xr[this.Xr.length-1]:null},t.prototype.Qr=function(){return this.hs()>0?this.te(0):null},t.prototype.un=function(){return this.hs()>0?this.te(this.Xr.length-1):null},t.prototype.hs=function(){return this.Xr.length},t.prototype.wi=function(){return 0===this.hs()},t.prototype.Uh=function(t){return null!==this.ie(t,0)},t.prototype.Kr=function(t){return this.ne(t)},t.prototype.ne=function(t,e){void 0===e&&(e=0);var n=this.ie(t,e);return null===n?null:ze(ze({},this.se(n)),{vs:this.te(n)})},t.prototype.fs=function(){return this.Xr},t.prototype.he=function(t,e,n){if(this.wi())return null;for(var i=null,s=0,r=n;s<r.length;s++){var o=r[s];i=Ri(i,this.re(t,e,o))}return i},t.prototype.Z=function(t){this.Jr.clear(),this.Zr.clear(),this.Xr=t},t.prototype.te=function(t){return this.Xr[t].vs},t.prototype.se=function(t){return this.Xr[t]},t.prototype.ie=function(t,e){var n=this.ee(t);if(null===n&&0!==e)switch(e){case-1:return this.ue(t);case 1:return this.ae(t);default:throw new TypeError("Unknown search mode")}return n},t.prototype.ue=function(t){var e=this.oe(t);return e>0&&(e-=1),e!==this.Xr.length&&this.te(e)<t?e:null},t.prototype.ae=function(t){var e=this.le(t);return e!==this.Xr.length&&t<this.te(e)?e:null},t.prototype.ee=function(t){var e=this.oe(t);return e===this.Xr.length||t<this.Xr[e].vs?null:e},t.prototype.oe=function(t){return Tn(this.Xr,t,(function(t,e){return t.vs<e}))},t.prototype.le=function(t){return Bn(this.Xr,t,(function(t,e){return e.vs>t}))},t.prototype.fe=function(t,e,n){for(var i=null,s=t;s<e;s++){var r=this.Xr[s].St[n];Number.isNaN(r)||(null===i?i={ce:r,ve:r}:(r<i.ce&&(i.ce=r),r>i.ve&&(i.ve=r)))}return i},t.prototype.re=function(t,e,n){if(this.wi())return null;var i=null,s=xe(this.Qr()),r=xe(this.un()),o=Math.max(t,s),a=Math.min(e,r),l=30*Math.ceil(o/30),c=Math.max(l,30*Math.floor(a/30)),u=this.oe(o),h=this.le(Math.min(a,l,e));i=Ri(i,this.fe(u,h,n));var d=this.Zr.get(n);void 0===d&&(d=new Map,this.Zr.set(n,d));for(var p=Math.max(l+1,o);p<c;p+=30){var f=Math.floor(p/30),v=d.get(f);if(void 0===v){var g=this.oe(30*f),m=this.le(30*(f+1)-1);v=this.fe(g,m,n),d.set(f,v)}i=Ri(i,v)}return u=this.oe(c),h=this.le(a),Ri(i,this.fe(u,h,n))},t}();function Ri(t,e){return null===t?e:null===e?t:{ce:Math.min(t.ce,e.ce),ve:Math.max(t.ve,e.ve)}}var zi=function(t){function e(e,n,i){var s=t.call(this,e)||this;s.Bt=new Ii,s.Or=new Ci(s),s._e=[],s.de=new ci(s),s.we=null,s.Me=null,s.be=[],s.me=[],s.pe=null,s.zi=n,s.ge=i;var r=new ki(s);return s.Ei=[r],s.Vr=new oi(r,s,e),"Area"!==i&&"Line"!==i&&"Baseline"!==i||(s.we=new fi(s)),s.ye(),s.ke(),s}return Re(e,t),e.prototype.g=function(){null!==this.pe&&clearTimeout(this.pe)},e.prototype.ur=function(t){return this.zi.priceLineColor||t},e.prototype.jh=function(t){var e={qh:!0},n=this.Ct();if(this.jt().bt().wi()||n.wi()||this.Bt.wi())return e;var i,s,r=this.jt().bt().ss(),o=this.kt();if(null===r||null===o)return e;if(t){var a=this.Bt.Gr();if(null===a)return e;i=a,s=a.vs}else{var l=this.Bt.ne(r.jn(),-1);if(null===l)return e;if(null===(i=this.Bt.Kr(l.vs)))return e;s=l.vs}var c=i.St[3],u=this.ls().As(s,{St:i}),h=n.xt(c,o.St);return{qh:!1,et:c,Gt:n.Mi(c,o.St),_r:n.Fr(c),dr:n.Ne(c,o.St),A:u.Ds,ti:h,vs:s}},e.prototype.ls=function(){return null!==this.Me||(this.Me=new Ei(this)),this.Me},e.prototype.W=function(){return this.zi},e.prototype.Pr=function(t){var e=t.priceScaleId;void 0!==e&&e!==this.zi.priceScaleId&&this.jt().xe(this,e),Oe(this.zi,t),null!==this.ki&&void 0!==t.scaleMargins&&this.ki.Pr({scaleMargins:t.scaleMargins}),void 0!==t.priceFormat&&(this.ye(),this.jt().Ce()),this.jt().Se(this),this.jt().Te(),this.Hi.vt("options")},e.prototype.Z=function(t,e){this.Bt.Z(t),this.De(),this.Hi.vt("data"),this.Ri.vt("data"),null!==this.we&&(e&&e.Ae?this.we.Wh():0===t.length&&this.we.Ph());var n=this.jt().oh(this);this.jt().Be(n),this.jt().Se(this),this.jt().Te(),this.jt().Wr()},e.prototype.Le=function(t){this.be=t.map((function(t){return ze({},t)})),this.De();var e=this.jt().oh(this);this.Ri.vt("data"),this.jt().Be(e),this.jt().Se(this),this.jt().Te(),this.jt().Wr()},e.prototype.rr=function(){return this.me},e.prototype.Ee=function(t){var e=new Bi(this,t);return this._e.push(e),this.jt().Se(this),e},e.prototype.Fe=function(t){var e=this._e.indexOf(t);-1!==e&&this._e.splice(e,1),this.jt().Se(this)},e.prototype.Rr=function(){return this.ge},e.prototype.kt=function(){var t=this.Oe();return null===t?null:{St:t.St[3],Ve:t.rt}},e.prototype.Oe=function(){var t=this.jt().bt().ss();if(null===t)return null;var e=t.In();return this.Bt.ne(e,1)},e.prototype.an=function(){return this.Bt},e.prototype.er=function(t){var e=this.Bt.Kr(t);return null===e?null:"Bar"===this.ge||"Candlestick"===this.ge?{open:e.St[0],high:e.St[1],low:e.St[2],close:e.St[3]}:e.St[3]},e.prototype.Pe=function(t){var e=this,n=this.we;return null!==n&&n.yt()?(null===this.pe&&n.Rh()&&(this.pe=setTimeout((function(){e.pe=null,e.jt().We()}),0)),n.zh(),[n]):[]},e.prototype.tn=function(){var t=[];this.ze()||t.push(this.de);for(var e=0,n=this._e;e<n.length;e++){var i=n[e];t.push.apply(t,i.tn())}return t.push(this.Hi,this.Or,this.Vr,this.Ri),t},e.prototype.nn=function(t,e){if(e!==this.ki&&!this.ze())return[];for(var n=Ue([],this.Ei,!0),i=0,s=this._e;i<s.length;i++){var r=s[i];n.push(r.zr())}return n},e.prototype.Re=function(t,e){var n=this;if(void 0!==this.zi.autoscaleInfoProvider){var i=this.zi.autoscaleInfoProvider((function(){var i=n.Ie(t,e);return null===i?null:i.Cr()}));return Vi.Sr(i)}return this.Ie(t,e)},e.prototype.je=function(){return this.zi.priceFormat.minMove},e.prototype.qe=function(){return this.Ue},e.prototype.hn=function(){var t;this.Hi.vt(),this.Ri.vt();for(var e=0,n=this.Ei;e<n.length;e++)n[e].vt();for(var i=0,s=this._e;i<s.length;i++)s[i].vt();this.Or.vt(),this.de.vt(),null===(t=this.we)||void 0===t||t.vt()},e.prototype.Ct=function(){return xe(t.prototype.Ct.call(this))},e.prototype.gt=function(t){if("Line"!==this.ge&&"Area"!==this.ge&&"Baseline"!==this.ge||!this.zi.crosshairMarkerVisible)return null;var e=this.Bt.Kr(t);return null===e?null:{et:e.St[3],st:this.He(),Tt:this.Ye(),Nt:this.$e(t)}},e.prototype.ar=function(){return this.zi.title},e.prototype.yt=function(){return this.zi.visible},e.prototype.ze=function(){return!wn(this.Ct().Ke())},e.prototype.Ie=function(t,e){if(!We(t)||!We(e)||this.Bt.wi())return null;var n="Line"===this.ge||"Area"===this.ge||"Baseline"===this.ge||"Histogram"===this.ge?[3]:[2,1],i=this.Bt.he(t,e,n),s=null!==i?new Di(i.ce,i.ve):null;if("Histogram"===this.Rr()){var r=this.zi.base,o=new Di(r,r);s=null!==s?s.Nn(o):o}return new Vi(s,this.Ri.hr())},e.prototype.He=function(){switch(this.ge){case"Line":case"Area":case"Baseline":return this.zi.crosshairMarkerRadius}return 0},e.prototype.Ye=function(){switch(this.ge){case"Line":case"Area":case"Baseline":var t=this.zi.crosshairMarkerBorderColor;if(0!==t.length)return t}return null},e.prototype.$e=function(t){switch(this.ge){case"Line":case"Area":case"Baseline":var e=this.zi.crosshairMarkerBackgroundColor;if(0!==e.length)return e}return this.ls().As(t).Ds},e.prototype.ye=function(){switch(this.zi.priceFormat.type){case"custom":this.Ue={format:this.zi.priceFormat.formatter};break;case"volume":this.Ue=new xn(this.zi.priceFormat.precision);break;case"percent":this.Ue=new Mn(this.zi.priceFormat.precision);break;default:var t=Math.pow(10,this.zi.priceFormat.precision);this.Ue=new $n(t,this.zi.priceFormat.minMove*t)}null!==this.ki&&this.ki.Xe()},e.prototype.De=function(){var t=this,e=this.jt().bt();if(e.wi()||0===this.Bt.hs())this.me=[];else{var n=xe(this.Bt.Qr());this.me=this.be.map((function(i,s){var r=xe(e.Ze(i.time,!0)),o=r<n?1:-1;return{time:xe(t.Bt.ne(r,o)).vs,position:i.position,shape:i.shape,color:i.color,id:i.id,Xh:s,text:i.text,size:i.size}}))}},e.prototype.ke=function(){switch(this.Ri=new xi(this,this.jt()),this.ge){case"Bar":this.Hi=new On(this,this.jt());break;case"Candlestick":this.Hi=new Jn(this,this.jt());break;case"Line":this.Hi=new ni(this,this.jt());break;case"Area":this.Hi=new zn(this,this.jt());break;case"Baseline":this.Hi=new Zn(this,this.jt());break;case"Histogram":this.Hi=new ei(this,this.jt());break;default:throw Error("Unknown chart style assigned: "+this.ge)}},e}(Li),Ui=function(){function t(t){this.zi=t}return t.prototype.Je=function(t,e,n){var i=t;if(0===this.zi.mode)return i;var s=n.ji(),r=s.kt();if(null===r)return i;var o=s.xt(t,r),a=n.Ge().filter((function(t){return t instanceof zi})).reduce((function(t,i){if(n.lh(i)||!i.yt())return t;var s=i.Ct(),r=i.an();if(s.wi()||!r.Uh(e))return t;var o=r.Kr(e);if(null===o)return t;var a=Ce(i.kt());return t.concat([s.xt(o.St[3],a.St)])}),[]);if(0===a.length)return i;a.sort((function(t,e){return Math.abs(t-o)-Math.abs(e-o)}));var l=a[0];return s.qi(l,r)},t}(),Ni=function(){function t(){this.Bt=null}return t.prototype.Z=function(t){this.Bt=t},t.prototype.H=function(t,e,n,i){var s=this;if(null!==this.Bt){var r=Math.max(1,Math.floor(e));t.lineWidth=r;var o=Math.ceil(this.Bt.Ot*e),a=Math.ceil(this.Bt.Ft*e);!function(t,e){t.save(),t.lineWidth%2&&t.translate(.5,.5),e(),t.restore()}(t,(function(){var n=xe(s.Bt);if(n.Qe){t.strokeStyle=n.tu,Se(t,n.iu),t.beginPath();for(var i=0,l=n.nu;i<l.length;i++){var c=l[i],u=Math.round(c.su*e);t.moveTo(u,-r),t.lineTo(u,o+r)}t.stroke()}if(n.hu){t.strokeStyle=n.ru,Se(t,n.eu),t.beginPath();for(var h=0,d=n.uu;h<d.length;h++){var p=d[h],f=Math.round(p.su*e);t.moveTo(-r,f),t.lineTo(a+r,f)}t.stroke()}}))}},t}(),Oi=function(){function t(t){this.zt=new Ni,this.ft=!0,this.Di=t}return t.prototype.vt=function(){this.ft=!0},t.prototype.dt=function(t,e){if(this.ft){var n=this.Di.jt().W().grid,i={Ot:t,Ft:e,hu:n.horzLines.visible,Qe:n.vertLines.visible,ru:n.horzLines.color,tu:n.vertLines.color,eu:n.horzLines.style,iu:n.vertLines.style,uu:this.Di.ji().au(),nu:this.Di.jt().bt().au()||[]};this.zt.Z(i),this.ft=!1}return this.zt},t}(),Fi=function(){function t(t){this.Hi=new Oi(t)}return t.prototype.ou=function(){return this.Hi},t}(),Wi={lu:4,fu:1e-4};function Hi(t,e){var n=100*(t-e)/e;return e<0?-n:n}function Gi(t,e){var n=Hi(t.pr(),e),i=Hi(t.gr(),e);return new Di(n,i)}function ji(t,e){var n=100*(t-e)/e+100;return e<0?-n:n}function Yi(t,e){var n=ji(t.pr(),e),i=ji(t.gr(),e);return new Di(n,i)}function Xi(t,e){var n=Math.abs(t);if(n<1e-15)return 0;var i=Hn(n+e.fu)+e.lu;return t<0?-i:i}function Zi(t,e){var n=Math.abs(t);if(n<1e-15)return 0;var i=Math.pow(10,n-e.lu)-e.fu;return t<0?-i:i}function qi(t,e){if(null===t)return null;var n=Xi(t.pr(),e),i=Xi(t.gr(),e);return new Di(n,i)}function Ji(t,e){if(null===t)return null;var n=Zi(t.pr(),e),i=Zi(t.gr(),e);return new Di(n,i)}function Ki(t){if(null===t)return Wi;var e=Math.abs(t.gr()-t.pr());if(e>=1||e<1e-15)return Wi;var n=Math.ceil(Math.abs(Math.log10(e))),i=Wi.lu+n;return{lu:i,fu:1/Math.pow(10,i)}}var Qi,ts=function(){function t(t,e){if(this.cu=t,this.vu=e,function(t){if(t<0)return!1;for(var e=t;e>1;e/=10)if(e%10!=0)return!1;return!0}(this.cu))this._u=[2,2.5,2];else{this._u=[];for(var n=this.cu;1!==n;){if(n%2==0)this._u.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this._u.push(2,2.5),n/=5}if(this._u.length>100)throw new Error("something wrong with base")}}}return t.prototype.du=function(t,e,n){for(var i,s=0===this.cu?0:1/this.cu,r=Math.pow(10,Math.max(0,Math.ceil(Hn(t-e)))),o=0,a=this.vu[0];;){var l=Wn(r,s,1e-14)&&r>s+1e-14,c=Wn(r,n*a,1e-14),u=Wn(r,1,1e-14);if(!(l&&c&&u))break;r/=a,a=this.vu[++o%this.vu.length]}if(r<=s+1e-14&&(r=s),r=Math.max(1,r),this._u.length>0&&(i=r,1,1e-14,Math.abs(i-1)<1e-14))for(o=0,a=this._u[0];Wn(r,n*a,1e-14)&&r>s+1e-14;)r/=a,a=this._u[++o%this._u.length];return r},t}(),es=function(){function t(t,e,n,i){this.wu=[],this._i=t,this.cu=e,this.Mu=n,this.bu=i}return t.prototype.du=function(t,e){if(t<e)throw new Error("high < low");var n=this._i.Yt(),i=(t-e)*this.mu()/n,s=new ts(this.cu,[2,2.5,2]),r=new ts(this.cu,[2,2,2.5]),o=new ts(this.cu,[2.5,2,2]),a=[];return a.push(s.du(t,e,i),r.du(t,e,i),o.du(t,e,i)),function(t){if(t.length<1)throw Error("array is empty");for(var e=t[0],n=1;n<t.length;++n)t[n]<e&&(e=t[n]);return e}(a)},t.prototype.pu=function(){var t=this._i,e=t.kt();if(null!==e){var n=t.Yt(),i=this.Mu(n-1,e),s=this.Mu(0,e),r=this._i.W().entireTextOnly?this.gu()/2:0,o=r,a=n-1-r,l=Math.max(i,s),c=Math.min(i,s);if(l!==c){for(var u=this.du(l,c),h=l%u,d=l>=c?1:-1,p=null,f=0,v=l-(h+=h<0?u:0);v>c;v-=u){var g=this.bu(v,e,!0);null!==p&&Math.abs(g-p)<this.mu()||g<o||g>a||(f<this.wu.length?(this.wu[f].su=g,this.wu[f].yu=t.ku(v)):this.wu.push({su:g,yu:t.ku(v)}),f++,p=g,t.Nu()&&(u=this.du(v*d,c)))}this.wu.length=f}else this.wu=[]}else this.wu=[]},t.prototype.au=function(){return this.wu},t.prototype.gu=function(){return this._i.S()},t.prototype.mu=function(){return Math.ceil(2.5*this.gu())},t}();function ns(t){return t.slice().sort((function(t,e){return xe(t.xi())-xe(e.xi())}))}!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(Qi||(Qi={}));var is=new Mn,ss=new $n(100,1),rs=function(){function t(t,e,n,i){this.xu=0,this.Cu=null,this.Tr=null,this.Su=null,this.Tu={Du:!1,Au:null},this.Bu=0,this.Lu=0,this.Eu=new Ne,this.Fu=new Ne,this.Ou=[],this.Vu=null,this.Pu=null,this.Wu=null,this.zu=null,this.Ue=ss,this.Ru=Ki(null),this.Iu=t,this.zi=e,this.ju=n,this.qu=i,this.Uu=new es(this,100,this.Hu.bind(this),this.Yu.bind(this))}return t.prototype.Ke=function(){return this.Iu},t.prototype.W=function(){return this.zi},t.prototype.Pr=function(t){if(Oe(this.zi,t),this.Xe(),void 0!==t.mode&&this.$u({mh:t.mode}),void 0!==t.scaleMargins){var e=Me(t.scaleMargins.top),n=Me(t.scaleMargins.bottom);if(e<0||e>1)throw new Error("Invalid top margin - expect value between 0 and 1, given=".concat(e));if(n<0||n>1||e+n>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(n));if(e+n>1)throw new Error("Invalid margins - sum of margins must be less than 1, given=".concat(e+n));this.Ku(),this.Pu=null}},t.prototype.Xu=function(){return this.zi.autoScale},t.prototype.Nu=function(){return 1===this.zi.mode},t.prototype.vr=function(){return 2===this.zi.mode},t.prototype.Zu=function(){return 3===this.zi.mode},t.prototype.mh=function(){return{_n:this.zi.autoScale,Ju:this.zi.invertScale,mh:this.zi.mode}},t.prototype.$u=function(t){var e=this.mh(),n=null;void 0!==t._n&&(this.zi.autoScale=t._n),void 0!==t.mh&&(this.zi.mode=t.mh,2!==t.mh&&3!==t.mh||(this.zi.autoScale=!0),this.Tu.Du=!1),1===e.mh&&t.mh!==e.mh&&(function(t,e){if(null===t)return!1;var n=Zi(t.pr(),e),i=Zi(t.gr(),e);return isFinite(n)&&isFinite(i)}(this.Tr,this.Ru)?null!==(n=Ji(this.Tr,this.Ru))&&this.Gu(n):this.zi.autoScale=!0),1===t.mh&&t.mh!==e.mh&&null!==(n=qi(this.Tr,this.Ru))&&this.Gu(n);var i=e.mh!==this.zi.mode;i&&(2===e.mh||this.vr())&&this.Xe(),i&&(3===e.mh||this.Zu())&&this.Xe(),void 0!==t.Ju&&e.Ju!==t.Ju&&(this.zi.invertScale=t.Ju,this.Qu()),this.Fu.m(e,this.mh())},t.prototype.ta=function(){return this.Fu},t.prototype.S=function(){return this.ju.fontSize},t.prototype.Yt=function(){return this.xu},t.prototype.ia=function(t){this.xu!==t&&(this.xu=t,this.Ku(),this.Pu=null)},t.prototype.na=function(){if(this.Cu)return this.Cu;var t=this.Yt()-this.sa()-this.ha();return this.Cu=t,t},t.prototype.Ar=function(){return this.ra(),this.Tr},t.prototype.Gu=function(t,e){var n=this.Tr;(e||null===n&&null!==t||null!==n&&!n.br(t))&&(this.Pu=null,this.Tr=t)},t.prototype.wi=function(){return this.ra(),0===this.xu||!this.Tr||this.Tr.wi()},t.prototype.ea=function(t){return this.Ju()?t:this.Yt()-1-t},t.prototype.xt=function(t,e){return this.vr()?t=Hi(t,e):this.Zu()&&(t=ji(t,e)),this.Yu(t,e)},t.prototype.us=function(t,e,n){this.ra();for(var i=this.ha(),s=xe(this.Ar()),r=s.pr(),o=s.gr(),a=this.na()-1,l=this.Ju(),c=a/(o-r),u=void 0===n?0:n.from,h=void 0===n?t.length:n.to,d=this.ua(),p=u;p<h;p++){var f=t[p],v=f.et;if(!isNaN(v)){var g=v;null!==d&&(g=d(f.et,e));var m=i+c*(g-r),y=l?m:this.xu-1-m;f.it=y}}},t.prototype.Ss=function(t,e,n){this.ra();for(var i=this.ha(),s=xe(this.Ar()),r=s.pr(),o=s.gr(),a=this.na()-1,l=this.Ju(),c=a/(o-r),u=void 0===n?0:n.from,h=void 0===n?t.length:n.to,d=this.ua(),p=u;p<h;p++){var f=t[p],v=f.open,g=f.high,m=f.low,y=f.close;null!==d&&(v=d(f.open,e),g=d(f.high,e),m=d(f.low,e),y=d(f.close,e));var b=i+c*(v-r),w=l?b:this.xu-1-b;f.xs=w,b=i+c*(g-r),w=l?b:this.xu-1-b,f.ys=w,b=i+c*(m-r),w=l?b:this.xu-1-b,f.ks=w,b=i+c*(y-r),w=l?b:this.xu-1-b,f.Cs=w}},t.prototype.qi=function(t,e){var n=this.Hu(t,e);return this.aa(n,e)},t.prototype.aa=function(t,e){var n=t;return this.vr()?n=function(t,e){return e<0&&(t=-t),t/100*e+e}(n,e):this.Zu()&&(n=function(t,e){return t-=100,e<0&&(t=-t),t/100*e+e}(n,e)),n},t.prototype.Ge=function(){return this.Ou},t.prototype.oa=function(){if(this.Vu)return this.Vu;for(var t=[],e=0;e<this.Ou.length;e++){var n=this.Ou[e];null===n.xi()&&n.Ci(e+1),t.push(n)}return t=ns(t),this.Vu=t,this.Vu},t.prototype.la=function(t){-1===this.Ou.indexOf(t)&&(this.Ou.push(t),this.Xe(),this.fa())},t.prototype.ca=function(t){var e=this.Ou.indexOf(t);if(-1===e)throw new Error("source is not attached to scale");this.Ou.splice(e,1),0===this.Ou.length&&(this.$u({_n:!0}),this.Gu(null)),this.Xe(),this.fa()},t.prototype.kt=function(){for(var t=null,e=0,n=this.Ou;e<n.length;e++){var i=n[e].kt();null!==i&&(null===t||i.Ve<t.Ve)&&(t=i)}return null===t?null:t.St},t.prototype.Ju=function(){return this.zi.invertScale},t.prototype.au=function(){var t=null===this.kt();if(null!==this.Pu&&(t||this.Pu.va===t))return this.Pu.au;this.Uu.pu();var e=this.Uu.au();return this.Pu={au:e,va:t},this.Eu.m(),e},t.prototype._a=function(){return this.Eu},t.prototype.da=function(t){this.vr()||this.Zu()||null===this.Wu&&null===this.Su&&(this.wi()||(this.Wu=this.xu-t,this.Su=xe(this.Ar()).mr()))},t.prototype.wa=function(t){if(!this.vr()&&!this.Zu()&&null!==this.Wu){this.$u({_n:!1}),(t=this.xu-t)<0&&(t=0);var e=(this.Wu+.2*(this.xu-1))/(t+.2*(this.xu-1)),n=xe(this.Su).mr();e=Math.max(e,.1),n.kr(e),this.Gu(n)}},t.prototype.Ma=function(){this.vr()||this.Zu()||(this.Wu=null,this.Su=null)},t.prototype.ba=function(t){this.Xu()||null===this.zu&&null===this.Su&&(this.wi()||(this.zu=t,this.Su=xe(this.Ar()).mr()))},t.prototype.ma=function(t){if(!this.Xu()&&null!==this.zu){var e=xe(this.Ar()).yr()/(this.na()-1),n=t-this.zu;this.Ju()&&(n*=-1);var i=n*e,s=xe(this.Su).mr();s.Nr(i),this.Gu(s,!0),this.Pu=null}},t.prototype.pa=function(){this.Xu()||null!==this.zu&&(this.zu=null,this.Su=null)},t.prototype.qe=function(){return this.Ue||this.Xe(),this.Ue},t.prototype.Mi=function(t,e){switch(this.zi.mode){case 2:return this.qe().format(Hi(t,e));case 3:return this.qe().format(ji(t,e));default:return this.ga(t)}},t.prototype.ku=function(t){switch(this.zi.mode){case 2:case 3:return this.qe().format(t);default:return this.ga(t)}},t.prototype.Fr=function(t){return this.ga(t,xe(this.ya()).qe())},t.prototype.Ne=function(t,e){return t=Hi(t,e),is.format(t)},t.prototype.ka=function(){return this.Ou},t.prototype.Na=function(t){this.Tu={Au:t,Du:!1}},t.prototype.hn=function(){this.Ou.forEach((function(t){return t.hn()}))},t.prototype.Xe=function(){this.Pu=null;var t=this.ya(),e=100;null!==t&&(e=Math.round(1/t.je())),this.Ue=ss,this.vr()?(this.Ue=is,e=100):this.Zu()?(this.Ue=new $n(100,1),e=100):null!==t&&(this.Ue=t.qe()),this.Uu=new es(this,e,this.Hu.bind(this),this.Yu.bind(this)),this.Uu.pu()},t.prototype.fa=function(){this.Vu=null},t.prototype.ya=function(){return this.Ou[0]||null},t.prototype.sa=function(){return this.Ju()?this.zi.scaleMargins.bottom*this.Yt()+this.Lu:this.zi.scaleMargins.top*this.Yt()+this.Bu},t.prototype.ha=function(){return this.Ju()?this.zi.scaleMargins.top*this.Yt()+this.Bu:this.zi.scaleMargins.bottom*this.Yt()+this.Lu},t.prototype.ra=function(){this.Tu.Du||(this.Tu.Du=!0,this.xa())},t.prototype.Ku=function(){this.Cu=null},t.prototype.Yu=function(t,e){if(this.ra(),this.wi())return 0;t=this.Nu()&&t?Xi(t,this.Ru):t;var n=xe(this.Ar()),i=this.ha()+(this.na()-1)*(t-n.pr())/n.yr();return this.ea(i)},t.prototype.Hu=function(t,e){if(this.ra(),this.wi())return 0;var n=this.ea(t),i=xe(this.Ar()),s=i.pr()+i.yr()*((n-this.ha())/(this.na()-1));return this.Nu()?Zi(s,this.Ru):s},t.prototype.Qu=function(){this.Pu=null,this.Uu.pu()},t.prototype.xa=function(){var t=this.Tu.Au;if(null!==t){for(var e,n,i=null,s=0,r=0,o=0,a=this.ka();o<a.length;o++){var l=a[o];if(l.yt()){var c=l.kt();if(null!==c){var u=l.Re(t.In(),t.jn()),h=u&&u.Ar();if(null!==h){switch(this.zi.mode){case 1:h=qi(h,this.Ru);break;case 2:h=Gi(h,c.St);break;case 3:h=Yi(h,c.St)}if(i=null===i?h:i.Nn(xe(h)),null!==u){var d=u.Br();null!==d&&(s=Math.max(s,d.above),r=Math.max(s,d.below))}}}}}if(s===this.Bu&&r===this.Lu||(this.Bu=s,this.Lu=r,this.Pu=null,this.Ku()),null!==i){if(i.pr()===i.gr()){var p=this.ya(),f=5*(null===p||this.vr()||this.Zu()?1:p.je());this.Nu()&&(i=Ji(i,this.Ru)),i=new Di(i.pr()-f,i.gr()+f),this.Nu()&&(i=qi(i,this.Ru))}if(this.Nu()){var v=Ji(i,this.Ru),g=Ki(v);if(e=g,n=this.Ru,e.lu!==n.lu||e.fu!==n.fu){var m=null!==this.Su?Ji(this.Su,this.Ru):null;this.Ru=g,i=qi(v,g),null!==m&&(this.Su=qi(m,g))}}this.Gu(i)}else null===this.Tr&&(this.Gu(new Di(-.5,.5)),this.Ru=Ki(null));this.Tu.Du=!0}},t.prototype.ua=function(){var t=this;return this.vr()?Hi:this.Zu()?ji:this.Nu()?function(e){return Xi(e,t.Ru)}:null},t.prototype.ga=function(t,e){return void 0===this.qu.priceFormatter?(void 0===e&&(e=this.qe()),e.format(t)):this.qu.priceFormatter(t)},t}(),os=function(){function t(t,e){this.Ou=[],this.Ca=new Map,this.xu=0,this.hh=0,this.Sa=1e3,this.Vu=null,this.Ta=new Ne,this.Da=t,this.pi=e,this.Aa=new Fi(this);var n=e.W();this.Ba=this.La("left",n.leftPriceScale),this.Ea=this.La("right",n.rightPriceScale),this.Ba.ta().u(this.Fa.bind(this,this.Ba),this),this.Ea.ta().u(this.Fa.bind(this,this.Ba),this),this.Oa(n)}return t.prototype.Oa=function(t){if(t.leftPriceScale&&this.Ba.Pr(t.leftPriceScale),t.rightPriceScale&&this.Ea.Pr(t.rightPriceScale),t.localization&&(this.Ba.Xe(),this.Ea.Xe()),t.overlayPriceScales)for(var e=0,n=Array.from(this.Ca.values());e<n.length;e++){var i=xe(n[e][0].Ct());i.Pr(t.overlayPriceScales),t.localization&&i.Xe()}},t.prototype.Va=function(t){switch(t){case"left":return this.Ba;case"right":return this.Ea}return this.Ca.has(t)?Me(this.Ca.get(t))[0].Ct():null},t.prototype.g=function(){this.jt().Pa().M(this),this.Ba.ta().M(this),this.Ea.ta().M(this),this.Ou.forEach((function(t){t.g&&t.g()})),this.Ta.m()},t.prototype.Wa=function(){return this.Sa},t.prototype.za=function(t){this.Sa=t},t.prototype.jt=function(){return this.pi},t.prototype.Ht=function(){return this.hh},t.prototype.Yt=function(){return this.xu},t.prototype.Ra=function(t){this.hh=t,this.Ia()},t.prototype.ia=function(t){var e=this;this.xu=t,this.Ba.ia(t),this.Ea.ia(t),this.Ou.forEach((function(n){if(e.lh(n)){var i=n.Ct();null!==i&&i.ia(t)}})),this.Ia()},t.prototype.Ge=function(){return this.Ou},t.prototype.lh=function(t){var e=t.Ct();return null===e||this.Ba!==e&&this.Ea!==e},t.prototype.la=function(t,e,n){var i=void 0!==n?n:this.qa().ja+1;this.Ua(t,e,i)},t.prototype.ca=function(t){var e=this.Ou.indexOf(t);$e(-1!==e,"removeDataSource: invalid data source"),this.Ou.splice(e,1);var n=xe(t.Ct()).Ke();if(this.Ca.has(n)){var i=Me(this.Ca.get(n)),s=i.indexOf(t);-1!==s&&(i.splice(s,1),0===i.length&&this.Ca.delete(n))}var r=t.Ct();r&&r.Ge().indexOf(t)>=0&&r.ca(t),null!==r&&(r.fa(),this.Ha(r)),this.Vu=null},t.prototype._h=function(t){return t===this.Ba?"left":t===this.Ea?"right":"overlay"},t.prototype.Ya=function(){return this.Ba},t.prototype.$a=function(){return this.Ea},t.prototype.Ka=function(t,e){t.da(e)},t.prototype.Xa=function(t,e){t.wa(e),this.Ia()},t.prototype.Za=function(t){t.Ma()},t.prototype.Ja=function(t,e){t.ba(e)},t.prototype.Ga=function(t,e){t.ma(e),this.Ia()},t.prototype.Qa=function(t){t.pa()},t.prototype.Ia=function(){this.Ou.forEach((function(t){t.hn()}))},t.prototype.ji=function(){var t=null;return this.pi.W().rightPriceScale.visible&&0!==this.Ea.Ge().length?t=this.Ea:this.pi.W().leftPriceScale.visible&&0!==this.Ba.Ge().length?t=this.Ba:0!==this.Ou.length&&(t=this.Ou[0].Ct()),null===t&&(t=this.Ea),t},t.prototype.fh=function(){var t=null;return this.pi.W().rightPriceScale.visible?t=this.Ea:this.pi.W().leftPriceScale.visible&&(t=this.Ba),t},t.prototype.Ha=function(t){null!==t&&t.Xu()&&this.io(t)},t.prototype.no=function(t){var e=this.Da.ss();t.$u({_n:!0}),null!==e&&t.Na(e),this.Ia()},t.prototype.so=function(){this.io(this.Ba),this.io(this.Ea)},t.prototype.ho=function(){var t=this;this.Ha(this.Ba),this.Ha(this.Ea),this.Ou.forEach((function(e){t.lh(e)&&t.Ha(e.Ct())})),this.Ia(),this.pi.Wr()},t.prototype.oa=function(){return null===this.Vu&&(this.Vu=ns(this.Ou)),this.Vu},t.prototype.ro=function(){return this.Ta},t.prototype.eo=function(){return this.Aa},t.prototype.io=function(t){var e=t.ka();if(e&&e.length>0&&!this.Da.wi()){var n=this.Da.ss();null!==n&&t.Na(n)}t.hn()},t.prototype.qa=function(){var t=this.oa();if(0===t.length)return{uo:0,ja:0};for(var e=0,n=0,i=0;i<t.length;i++){var s=t[i].xi();null!==s&&(s<e&&(e=s),s>n&&(n=s))}return{uo:e,ja:n}},t.prototype.Ua=function(t,e,n){var i=this.Va(e);if(null===i&&(i=this.La(e,this.pi.W().overlayPriceScales)),this.Ou.push(t),!wn(e)){var s=this.Ca.get(e)||[];s.push(t),this.Ca.set(e,s)}i.la(t),t.Si(i),t.Ci(n),this.Ha(i),this.Vu=null},t.prototype.Fa=function(t,e,n){e.mh!==n.mh&&this.io(t)},t.prototype.La=function(t,e){var n=ze({visible:!0,autoScale:!0},je(e)),i=new rs(t,n,this.pi.W().layout,this.pi.W().localization);return i.ia(this.Yt()),i},t}(),as=function(t){return t.getUTCFullYear()};var ls=function(){function t(t,e){void 0===t&&(t="yyyy-MM-dd"),void 0===e&&(e="default"),this.ao=t,this.oo=e}return t.prototype.lo=function(t){return function(t,e,n){return e.replace(/yyyy/g,function(t){return _n(as(t),4)}(t)).replace(/yy/g,function(t){return _n(as(t)%100,2)}(t)).replace(/MMMM/g,function(t,e){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(e,{month:"long"})}(t,n)).replace(/MMM/g,function(t,e){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(e,{month:"short"})}(t,n)).replace(/MM/g,function(t){return _n(function(t){return t.getUTCMonth()+1}(t),2)}(t)).replace(/dd/g,function(t){return _n(function(t){return t.getUTCDate()}(t),2)}(t))}(t,this.ao,this.oo)},t}(),cs=function(){function t(t){this.fo=t||"%h:%m:%s"}return t.prototype.lo=function(t){return this.fo.replace("%h",_n(t.getUTCHours(),2)).replace("%m",_n(t.getUTCMinutes(),2)).replace("%s",_n(t.getUTCSeconds(),2))},t}(),us={co:"yyyy-MM-dd",vo:"%h:%m:%s",_o:" ",do:"default"},hs=function(){function t(t){void 0===t&&(t={});var e=ze(ze({},us),t);this.wo=new ls(e.co,e.do),this.Mo=new cs(e.vo),this.bo=e._o}return t.prototype.lo=function(t){return"".concat(this.wo.lo(t)).concat(this.bo).concat(this.Mo.lo(t))},t}(),ds=function(){function t(t,e){void 0===e&&(e=50),this.mo=0,this.po=1,this.yo=1,this.Gs=new Map,this.ko=new Map,this.No=t,this.xo=e}return t.prototype.lo=function(t){var e=void 0===t.Co?new Date(1e3*t.So).getTime():new Date(Date.UTC(t.Co.year,t.Co.month-1,t.Co.day)).getTime(),n=this.Gs.get(e);if(void 0!==n)return n.To;if(this.mo===this.xo){var i=this.ko.get(this.yo);this.ko.delete(this.yo),this.Gs.delete(Me(i)),this.yo++,this.mo--}var s=this.No(t);return this.Gs.set(e,{To:s,Do:this.po}),this.ko.set(this.po,e),this.mo++,this.po++,s},t}(),ps=function(){function t(t,e){$e(t<=e,"right should be >= left"),this.Ao=t,this.Bo=e}return t.prototype.In=function(){return this.Ao},t.prototype.jn=function(){return this.Bo},t.prototype.Lo=function(){return this.Bo-this.Ao+1},t.prototype.Uh=function(t){return this.Ao<=t&&t<=this.Bo},t.prototype.br=function(t){return this.Ao===t.In()&&this.Bo===t.jn()},t}();function fs(t,e){return null===t||null===e?t===e:t.br(e)}var vs,gs=function(){function t(){this.Eo=new Map,this.Gs=null}return t.prototype.Fo=function(t,e){this.Oo(e),this.Gs=null;for(var n=e;n<t.length;++n){var i=t[n],s=this.Eo.get(i.Vo);void 0===s&&(s=[],this.Eo.set(i.Vo,s)),s.push({vs:n,rt:i.rt,Po:i.Vo})}},t.prototype.Wo=function(t,e){var n=Math.ceil(e/t);return null!==this.Gs&&this.Gs.zo===n||(this.Gs={au:this.Ro(n),zo:n}),this.Gs.au},t.prototype.Oo=function(t){if(0!==t){var e=[];this.Eo.forEach((function(n,i){t<=n[0].vs?e.push(i):n.splice(Tn(n,t,(function(e){return e.vs<t})),1/0)}));for(var n=0,i=e;n<i.length;n++){var s=i[n];this.Eo.delete(s)}}else this.Eo.clear()},t.prototype.Ro=function(t){for(var e=[],n=0,i=Array.from(this.Eo.keys()).sort((function(t,e){return e-t}));n<i.length;n++){var s=i[n];if(this.Eo.get(s)){var r=e;e=[];for(var o=r.length,a=0,l=Me(this.Eo.get(s)),c=l.length,u=1/0,h=-1/0,d=0;d<c;d++){for(var p=l[d],f=p.vs;a<o;){var v=r[a],g=v.vs;if(!(g<f)){u=g;break}a++,e.push(v),h=g,u=1/0}u-f>=t&&f-h>=t&&(e.push(p),h=f)}for(;a<o;a++)e.push(r[a])}}return e},t}(),ms=function(){function t(t){this.Io=t}return t.prototype.jo=function(){return null===this.Io?null:new ps(Math.floor(this.Io.In()),Math.ceil(this.Io.jn()))},t.prototype.qo=function(){return this.Io},t.Uo=function(){return new t(null)},t}();!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(vs||(vs={}));var ys,bs=function(){function t(t,e,n){this.hh=0,this.Ho=null,this.Yo=[],this.zu=null,this.Wu=null,this.$o=new gs,this.Ko=new Map,this.Xo=ms.Uo(),this.Zo=!0,this.Jo=new Ne,this.Go=new Ne,this.Qo=new Ne,this.tl=null,this.il=null,this.nl=[],this.zi=e,this.qu=n,this.sl=e.rightOffset,this.hl=e.barSpacing,this.pi=t,this.rl()}return t.prototype.W=function(){return this.zi},t.prototype.el=function(t){Oe(this.qu,t),this.ul(),this.rl()},t.prototype.Pr=function(t,e){var n;Oe(this.zi,t),this.zi.fixLeftEdge&&this.al(),this.zi.fixRightEdge&&this.ol(),void 0!==t.barSpacing&&this.pi.gn(t.barSpacing),void 0!==t.rightOffset&&this.pi.yn(t.rightOffset),void 0!==t.minBarSpacing&&this.pi.gn(null!==(n=t.barSpacing)&&void 0!==n?n:this.hl),this.ul(),this.rl(),this.Qo.m()},t.prototype.gi=function(t){var e;return(null===(e=this.Yo[t])||void 0===e?void 0:e.rt)||null},t.prototype.Ze=function(t,e){if(this.Yo.length<1)return null;if(t.So>this.Yo[this.Yo.length-1].rt.So)return e?this.Yo.length-1:null;var n=Tn(this.Yo,t.So,(function(t,e){return t.rt.So<e}));return t.So<this.Yo[n].rt.So?e?n:null:n},t.prototype.wi=function(){return 0===this.hh||0===this.Yo.length||null===this.Ho},t.prototype.ss=function(){return this.ll(),this.Xo.jo()},t.prototype.fl=function(){return this.ll(),this.Xo.qo()},t.prototype.cl=function(){var t=this.ss();if(null===t)return null;var e={from:t.In(),to:t.jn()};return this.vl(e)},t.prototype.vl=function(t){var e=Math.round(t.from),n=Math.round(t.to),i=xe(this._l()),s=xe(this.dl());return{from:xe(this.gi(Math.max(i,e))),to:xe(this.gi(Math.min(s,n)))}},t.prototype.wl=function(t){return{from:xe(this.Ze(t.from,!0)),to:xe(this.Ze(t.to,!0))}},t.prototype.Ht=function(){return this.hh},t.prototype.Ra=function(t){if(isFinite(t)&&!(t<=0)&&this.hh!==t){if(this.zi.lockVisibleTimeRangeOnResize&&this.hh){var e=this.hl*t/this.hh;this.hl=e}if(this.zi.fixLeftEdge){var n=this.ss();if(null!==n&&n.In()<=0){var i=this.hh-t;this.sl-=Math.round(i/this.hl)+1}}this.hh=t,this.Zo=!0,this.Ml(),this.bl()}},t.prototype.At=function(t){if(this.wi()||!We(t))return 0;var e=this.ml()+this.sl-t;return this.hh-(e+.5)*this.hl-1},t.prototype.es=function(t,e){for(var n=this.ml(),i=void 0===e?0:e.from,s=void 0===e?t.length:e.to,r=i;r<s;r++){var o=t[r].rt,a=n+this.sl-o,l=this.hh-(a+.5)*this.hl-1;t[r].tt=l}},t.prototype.pl=function(t){return Math.ceil(this.gl(t))},t.prototype.yn=function(t){this.Zo=!0,this.sl=t,this.bl(),this.pi.yl(),this.pi.Wr()},t.prototype.ws=function(){return this.hl},t.prototype.gn=function(t){this.kl(t),this.bl(),this.pi.yl(),this.pi.Wr()},t.prototype.Nl=function(){return this.sl},t.prototype.au=function(){if(this.wi())return null;if(null!==this.il)return this.il;for(var t=this.hl,e=5*(this.pi.W().layout.fontSize+4),n=Math.round(e/t),i=xe(this.ss()),s=Math.max(i.In(),i.In()-n),r=Math.max(i.jn(),i.jn()-n),o=this.$o.Wo(t,e),a=this._l()+n,l=this.dl()-n,c=this.xl(),u=this.zi.fixLeftEdge||c,h=this.zi.fixRightEdge||c,d=0,p=0,f=o;p<f.length;p++){var v=f[p];if(s<=v.vs&&v.vs<=r){var g=void 0;d<this.nl.length?((g=this.nl[d]).su=this.At(v.vs),g.yu=this.Cl(v.rt,v.Po),g.Po=v.Po):(g={Sl:!1,su:this.At(v.vs),yu:this.Cl(v.rt,v.Po),Po:v.Po},this.nl.push(g)),this.hl>e/2&&!c?g.Sl=!1:g.Sl=u&&v.vs<=a||h&&v.vs>=l,d++}}return this.nl.length=d,this.il=this.nl,this.nl},t.prototype.Tl=function(){this.Zo=!0,this.gn(this.zi.barSpacing),this.yn(this.zi.rightOffset)},t.prototype.Dl=function(t){this.Zo=!0,this.Ho=t,this.bl(),this.al()},t.prototype.Al=function(t,e){var n=this.gl(t),i=this.ws(),s=i+e*(i/10);this.gn(s),this.zi.rightBarStaysOnScroll||this.yn(this.Nl()+(n-this.gl(t)))},t.prototype.da=function(t){this.zu&&this.pa(),null===this.Wu&&null===this.tl&&(this.wi()||(this.Wu=t,this.Bl()))},t.prototype.wa=function(t){if(null!==this.tl){var e=Fn(this.hh-t,0,this.hh),n=Fn(this.hh-xe(this.Wu),0,this.hh);0!==e&&0!==n&&this.gn(this.tl.ws*e/n)}},t.prototype.Ma=function(){null!==this.Wu&&(this.Wu=null,this.Ll())},t.prototype.ba=function(t){null===this.zu&&null===this.tl&&(this.wi()||(this.zu=t,this.Bl()))},t.prototype.ma=function(t){if(null!==this.zu){var e=(this.zu-t)/this.ws();this.sl=xe(this.tl).Nl+e,this.Zo=!0,this.bl()}},t.prototype.pa=function(){null!==this.zu&&(this.zu=null,this.Ll())},t.prototype.El=function(){this.Fl(this.zi.rightOffset)},t.prototype.Fl=function(t,e){var n=this;if(void 0===e&&(e=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var i=this.sl,s=performance.now(),r=function(){var o=(performance.now()-s)/e,a=o>=1,l=a?t:i+(t-i)*o;n.yn(l),a||setTimeout(r,20)};r()},t.prototype.vt=function(t,e){this.Zo=!0,this.Yo=t,this.$o.Fo(t,e),this.bl()},t.prototype.Ol=function(){return this.Jo},t.prototype.Vl=function(){return this.Go},t.prototype.Pl=function(){return this.Qo},t.prototype.ml=function(){return this.Ho||0},t.prototype.Wl=function(t){var e=t.Lo();this.kl(this.hh/e),this.sl=t.jn()-this.ml(),this.bl(),this.Zo=!0,this.pi.yl(),this.pi.Wr()},t.prototype.zl=function(){var t=this._l(),e=this.dl();null!==t&&null!==e&&this.Wl(new ps(t,e+this.zi.rightOffset))},t.prototype.Rl=function(t){var e=new ps(t.from,t.to);this.Wl(e)},t.prototype.yi=function(t){return void 0!==this.qu.timeFormatter?this.qu.timeFormatter(t.Co||t.So):this.Il.lo(new Date(1e3*t.So))},t.prototype.xl=function(){var t=this.pi.W(),e=t.handleScroll,n=t.handleScale;return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||n.axisDoubleClickReset||n.axisPressedMouseMove.time||n.mouseWheel||n.pinch)},t.prototype._l=function(){return 0===this.Yo.length?null:0},t.prototype.dl=function(){return 0===this.Yo.length?null:this.Yo.length-1},t.prototype.jl=function(t){return(this.hh-1-t)/this.hl},t.prototype.gl=function(t){var e=this.jl(t),n=this.ml()+this.sl-e;return Math.round(1e6*n)/1e6},t.prototype.kl=function(t){var e=this.hl;this.hl=t,this.Ml(),e!==this.hl&&(this.Zo=!0,this.ql())},t.prototype.ll=function(){if(this.Zo)if(this.Zo=!1,this.wi())this.Ul(ms.Uo());else{var t=this.ml(),e=this.hh/this.hl,n=this.sl+t,i=new ps(n-e+1,n);this.Ul(new ms(i))}},t.prototype.Ml=function(){var t=this.Hl();if(this.hl<t&&(this.hl=t,this.Zo=!0),0!==this.hh){var e=.5*this.hh;this.hl>e&&(this.hl=e,this.Zo=!0)}},t.prototype.Hl=function(){return this.zi.fixLeftEdge&&this.zi.fixRightEdge&&0!==this.Yo.length?this.hh/this.Yo.length:this.zi.minBarSpacing},t.prototype.bl=function(){var t=this.Yl();this.sl>t&&(this.sl=t,this.Zo=!0);var e=this.$l();null!==e&&this.sl<e&&(this.sl=e,this.Zo=!0)},t.prototype.$l=function(){var t=this._l(),e=this.Ho;return null===t||null===e?null:t-e-1+(this.zi.fixLeftEdge?this.hh/this.hl:Math.min(2,this.Yo.length))},t.prototype.Yl=function(){return this.zi.fixRightEdge?0:this.hh/this.hl-Math.min(2,this.Yo.length)},t.prototype.Bl=function(){this.tl={ws:this.ws(),Nl:this.Nl()}},t.prototype.Ll=function(){this.tl=null},t.prototype.Cl=function(t,e){var n=this,i=this.Ko.get(e);return void 0===i&&(i=new ds((function(t){return n.Kl(t,e)})),this.Ko.set(e,i)),i.lo(t)},t.prototype.Kl=function(t,e){var n,i=function(t,e,n){switch(t){case 0:case 10:return e?n?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return e?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e,this.zi.timeVisible,this.zi.secondsVisible);return void 0!==this.zi.tickMarkFormatter?this.zi.tickMarkFormatter(null!==(n=t.Co)&&void 0!==n?n:t.So,i,this.qu.locale):function(t,e,n){var i={};switch(e){case 0:i.year="numeric";break;case 1:i.month="short";break;case 2:i.day="numeric";break;case 3:i.hour12=!1,i.hour="2-digit",i.minute="2-digit";break;case 4:i.hour12=!1,i.hour="2-digit",i.minute="2-digit",i.second="2-digit"}var s=void 0===t.Co?new Date(1e3*t.So):new Date(Date.UTC(t.Co.year,t.Co.month-1,t.Co.day));return new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()).toLocaleString(n,i)}(t,i,this.qu.locale)},t.prototype.Ul=function(t){var e=this.Xo;this.Xo=t,fs(e.jo(),this.Xo.jo())||this.Jo.m(),fs(e.qo(),this.Xo.qo())||this.Go.m(),this.ql()},t.prototype.ql=function(){this.il=null},t.prototype.ul=function(){this.ql(),this.Ko.clear()},t.prototype.rl=function(){var t=this.qu.dateFormat;this.zi.timeVisible?this.Il=new hs({co:t,vo:this.zi.secondsVisible?"%h:%m:%s":"%h:%m",_o:"   ",do:this.qu.locale}):this.Il=new ls(t,this.qu.locale)},t.prototype.al=function(){if(this.zi.fixLeftEdge){var t=this._l();if(null!==t){var e=this.ss();if(null!==e){var n=e.In()-t;if(n<0){var i=this.sl-n-1;this.yn(i)}this.Ml()}}}},t.prototype.ol=function(){this.bl(),this.Ml()},t}(),ws=function(t){function e(e){var n=t.call(this)||this;return n.Xl=new Map,n.Bt=e,n}return Re(e,t),e.prototype.Y=function(t){},e.prototype.K=function(t){if(this.Bt.yt){t.save();for(var e=0,n=0,i=this.Bt.Zl;n<i.length;n++)if(0!==(l=i[n]).Gt.length){t.font=l.T;var s=this.Jl(t,l.Gt);s>this.Bt.Ht?l.Al=this.Bt.Ht/s:l.Al=1,e+=l.Gl*l.Al}var r=0;switch(this.Bt.Ql){case"top":r=0;break;case"center":r=Math.max((this.Bt.Yt-e)/2,0);break;case"bottom":r=Math.max(this.Bt.Yt-e,0)}t.fillStyle=this.Bt.A;for(var o=0,a=this.Bt.Zl;o<a.length;o++){var l=a[o];t.save();var c=0;switch(this.Bt.tf){case"left":t.textAlign="left",c=l.Gl/2;break;case"center":t.textAlign="center",c=this.Bt.Ht/2;break;case"right":t.textAlign="right",c=this.Bt.Ht-1-l.Gl/2}t.translate(c,r),t.textBaseline="top",t.font=l.T,t.scale(l.Al,l.Al),t.fillText(l.Gt,0,l.if),t.restore(),r+=l.Gl*l.Al}t.restore()}},e.prototype.Jl=function(t,e){var n=this.nf(t.font),i=n.get(e);return void 0===i&&(i=t.measureText(e).width,n.set(e,i)),i},e.prototype.nf=function(t){var e=this.Xl.get(t);return void 0===e&&(e=new Map,this.Xl.set(t,e)),e},e}(Qe),Ss=function(){function t(t){this.ft=!0,this.Wt={yt:!1,A:"",Yt:0,Ht:0,Zl:[],Ql:"center",tf:"center"},this.zt=new ws(this.Wt),this.Rt=t}return t.prototype.vt=function(){this.ft=!0},t.prototype.dt=function(t,e){return this.ft&&(this.wt(t,e),this.ft=!1),this.zt},t.prototype.wt=function(t,e){var n=this.Rt.W(),i=this.Wt;i.yt=n.visible,i.yt&&(i.A=n.color,i.Ht=e,i.Yt=t,i.tf=n.horzAlign,i.Ql=n.vertAlign,i.Zl=[{Gt:n.text,T:qe(n.fontSize,n.fontFamily,n.fontStyle),Gl:1.2*n.fontSize,if:0,Al:0}])},t}(),_s=function(t){function e(e,n){var i=t.call(this)||this;return i.zi=n,i.Hi=new Ss(i),i}return Re(e,t),e.prototype.nn=function(){return[]},e.prototype.tn=function(){return[this.Hi]},e.prototype.W=function(){return this.zi},e.prototype.hn=function(){this.Hi.vt()},e}(yn);!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(ys||(ys={}));var $s,Ms,xs,Cs=function(){function t(t,e){this.sf=[],this.hf=[],this.hh=0,this.rf=null,this.ef=null,this.uf=new Ne,this.af=new Ne,this.lf=null,this.ff=t,this.zi=e,this.cf=new Je(this),this.Da=new bs(this,e.timeScale,this.zi.localization),this.ct=new bn(this,e.crosshair),this.vf=new Ui(e.crosshair),this._f=new _s(this,e.watermark),this.df(),this.sf[0].za(2e3),this.wf=this.Mf(0),this.bf=this.Mf(1)}return t.prototype.Ce=function(){this.mf(new Sn(3))},t.prototype.Wr=function(){this.mf(new Sn(2))},t.prototype.We=function(){this.mf(new Sn(1))},t.prototype.Se=function(t){var e=this.pf(t);this.mf(e)},t.prototype.gf=function(){return this.ef},t.prototype.yf=function(t){var e=this.ef;this.ef=t,null!==e&&this.Se(e.kf),null!==t&&this.Se(t.kf)},t.prototype.W=function(){return this.zi},t.prototype.Pr=function(t){Oe(this.zi,t),this.sf.forEach((function(e){return e.Oa(t)})),void 0!==t.timeScale&&this.Da.Pr(t.timeScale),void 0!==t.localization&&this.Da.el(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.uf.m(),this.wf=this.Mf(0),this.bf=this.Mf(1),this.Ce()},t.prototype.Nf=function(t,e){if("left"!==t)if("right"!==t){var n=this.xf(t);null!==n&&(n.Ct.Pr(e),this.uf.m())}else this.Pr({rightPriceScale:e});else this.Pr({leftPriceScale:e})},t.prototype.xf=function(t){for(var e=0,n=this.sf;e<n.length;e++){var i=n[e],s=i.Va(t);if(null!==s)return{It:i,Ct:s}}return null},t.prototype.bt=function(){return this.Da},t.prototype.Cf=function(){return this.sf},t.prototype.Sf=function(){return this._f},t.prototype.Tf=function(){return this.ct},t.prototype.Df=function(){return this.af},t.prototype.Af=function(t,e){t.ia(e),this.yl()},t.prototype.Ra=function(t){this.hh=t,this.Da.Ra(this.hh),this.sf.forEach((function(e){return e.Ra(t)})),this.yl()},t.prototype.df=function(t){var e=new os(this.Da,this);void 0!==t?this.sf.splice(t,0,e):this.sf.push(e);var n=void 0===t?this.sf.length-1:t,i=new Sn(3);return i.cn(n,{vn:0,_n:!0}),this.mf(i),e},t.prototype.Ka=function(t,e,n){t.Ka(e,n)},t.prototype.Xa=function(t,e,n){t.Xa(e,n),this.Te(),this.mf(this.Bf(t,2))},t.prototype.Za=function(t,e){t.Za(e),this.mf(this.Bf(t,2))},t.prototype.Ja=function(t,e,n){e.Xu()||t.Ja(e,n)},t.prototype.Ga=function(t,e,n){e.Xu()||(t.Ga(e,n),this.Te(),this.mf(this.Bf(t,2)))},t.prototype.Qa=function(t,e){e.Xu()||(t.Qa(e),this.mf(this.Bf(t,2)))},t.prototype.no=function(t,e){t.no(e),this.mf(this.Bf(t,2))},t.prototype.Lf=function(t){this.Da.da(t)},t.prototype.Ef=function(t,e){var n=this.bt();if(!n.wi()&&0!==e){var i=n.Ht();t=Math.max(1,Math.min(t,i)),n.Al(t,e),this.yl()}},t.prototype.Ff=function(t){this.Of(0),this.Vf(t),this.Pf()},t.prototype.Wf=function(t){this.Da.wa(t),this.yl()},t.prototype.zf=function(){this.Da.Ma(),this.Wr()},t.prototype.Of=function(t){this.rf=t,this.Da.ba(t)},t.prototype.Vf=function(t){var e=!1;return null!==this.rf&&Math.abs(t-this.rf)>20&&(this.rf=null,e=!0),this.Da.ma(t),this.yl(),e},t.prototype.Pf=function(){this.Da.pa(),this.Wr(),this.rf=null},t.prototype._t=function(){return this.hf},t.prototype.Rf=function(t,e,n){this.ct.Yi(t,e);var i=NaN,s=this.Da.pl(t),r=this.Da.ss();null!==r&&(s=Math.min(Math.max(r.In(),s),r.jn()));var o=n.ji(),a=o.kt();null!==a&&(i=o.qi(e,a)),i=this.vf.Je(i,s,n),this.ct.Zi(s,i,n),this.We(),this.af.m(this.ct.Mt(),{x:t,y:e})},t.prototype.If=function(){this.Tf().Gi(),this.We(),this.af.m(null,null)},t.prototype.Te=function(){var t=this.ct.It();if(null!==t){var e=this.ct.Ki(),n=this.ct.Xi();this.Rf(e,n,t)}this.ct.hn()},t.prototype.jf=function(t,e,n){var i=this.Da.gi(0);void 0!==e&&void 0!==n&&this.Da.vt(e,n);var s=this.Da.gi(0),r=this.Da.ml(),o=this.Da.ss();if(null!==o&&null!==i&&null!==s){var a=o.Uh(r),l=i.So>s.So,c=null!==t&&t>r&&!l,u=a&&this.Da.W().shiftVisibleRangeOnNewBar;if(c&&!u){var h=t-r;this.Da.yn(this.Da.Nl()-h)}}this.Da.Dl(t)},t.prototype.Be=function(t){null!==t&&t.ho()},t.prototype.oh=function(t){var e=this.sf.find((function(e){return e.oa().includes(t)}));return void 0===e?null:e},t.prototype.yl=function(){this._f.hn(),this.sf.forEach((function(t){return t.ho()})),this.Te()},t.prototype.g=function(){this.sf.forEach((function(t){return t.g()})),this.sf.length=0,this.zi.localization.priceFormatter=void 0,this.zi.localization.timeFormatter=void 0},t.prototype.qf=function(){return this.cf},t.prototype.dh=function(){return this.cf.W()},t.prototype.Pa=function(){return this.uf},t.prototype.Uf=function(t,e){var n=this.sf[0],i=this.Hf(e,t,n);return this.hf.push(i),1===this.hf.length?this.Ce():this.Wr(),i},t.prototype.Yf=function(t){var e=this.oh(t),n=this.hf.indexOf(t);$e(-1!==n,"Series not found"),this.hf.splice(n,1),xe(e).ca(t),t.g&&t.g()},t.prototype.xe=function(t,e){var n=xe(this.oh(t));n.ca(t);var i=this.xf(e);if(null===i){var s=t.xi();n.la(t,e,s)}else s=i.It===n?t.xi():void 0,i.It.la(t,e,s)},t.prototype.zl=function(){var t=new Sn(2);t.Mn(),this.mf(t)},t.prototype.$f=function(t){var e=new Sn(2);e.mn(t),this.mf(e)},t.prototype.pn=function(){var t=new Sn(2);t.pn(),this.mf(t)},t.prototype.gn=function(t){var e=new Sn(2);e.gn(t),this.mf(e)},t.prototype.yn=function(t){var e=new Sn(2);e.yn(t),this.mf(e)},t.prototype.Kf=function(){return this.zi.rightPriceScale.visible?"right":"left"},t.prototype.Xf=function(){return this.bf},t.prototype.Zf=function(){return this.wf},t.prototype.Dt=function(t){var e=this.bf,n=this.wf;if(e===n)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.lf||this.lf.Pn!==n||this.lf.Wn!==e)this.lf={Pn:n,Wn:e,Jf:new Map};else{var i=this.lf.Jf.get(t);if(void 0!==i)return i}var s=function(t,e,n){var i=Pe(t),s=i[0],r=i[1],o=i[2],a=i[3],l=Pe(e),c=l[0],u=l[1],h=l[2],d=l[3],p=[De(s+n*(c-s)),De(r+n*(u-r)),De(o+n*(h-o)),Ve(a+n*(d-a))];return"rgba(".concat(p[0],", ").concat(p[1],", ").concat(p[2],", ").concat(p[3],")")}(n,e,t/100);return this.lf.Jf.set(t,s),s},t.prototype.Bf=function(t,e){var n=new Sn(e);if(null!==t){var i=this.sf.indexOf(t);n.cn(i,{vn:e})}return n},t.prototype.pf=function(t,e){return void 0===e&&(e=2),this.Bf(this.oh(t),e)},t.prototype.mf=function(t){this.ff&&this.ff(t),this.sf.forEach((function(t){return t.eo().ou().vt()}))},t.prototype.Hf=function(t,e,n){var i=new zi(this,t,e),s=void 0!==t.priceScaleId?t.priceScaleId:this.Kf();return n.la(i,s),wn(s)||i.Pr(t),i},t.prototype.Mf=function(t){var e=this.zi.layout;return"gradient"===e.background.type?0===t?e.background.topColor:e.background.bottomColor:e.background.color},t}();function ks(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function Ds(t){return!Fe(t)&&!He(t)}function Vs(t){return Fe(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}($s||($s={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(Ms||(Ms={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(xs||(xs={}));var As=function(){function t(t,e){this.Ft=t,this.Ot=e}return t.prototype.br=function(t){return this.Ft===t.Ft&&this.Ot===t.Ot},t}();function Ts(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function Bs(t){var e=xe(t.getContext("2d"));return e.setTransform(1,0,0,1,0,0),e}function Ls(t,e){var n=t.createElement("canvas"),i=Ts(n);return n.style.width="".concat(e.Ft,"px"),n.style.height="".concat(e.Ot,"px"),n.width=e.Ft*i,n.height=e.Ot*i,n}function Ps(t,e){var n=xe(t.ownerDocument).createElement("canvas");t.appendChild(n);var i,s=(void 0===(i={allowDownsampling:!1})&&(i=ge),new we(n,i));return s.resizeCanvas({width:e.Ft,height:e.Ot}),s}function Es(t,e){return t.Gf-e.Gf}function Is(t,e,n){var i=(t.Gf-e.Gf)/(t.rt-e.rt);return Math.sign(i)*Math.min(Math.abs(i),n)}var Rs=function(){function t(t,e,n,i){this.Qf=null,this.tc=null,this.ic=null,this.nc=null,this.sc=null,this.hc=0,this.rc=0,this.ec=!1,this.uc=t,this.ac=e,this.oc=n,this.Cn=i}return t.prototype.lc=function(t,e){if(null!==this.Qf){if(this.Qf.rt===e)return void(this.Qf.Gf=t);if(Math.abs(this.Qf.Gf-t)<this.Cn)return}this.nc=this.ic,this.ic=this.tc,this.tc=this.Qf,this.Qf={rt:e,Gf:t}},t.prototype.xh=function(t,e){if(null!==this.Qf&&null!==this.tc&&!(e-this.Qf.rt>50)){var n=0,i=Is(this.Qf,this.tc,this.ac),s=Es(this.Qf,this.tc),r=[i],o=[s];if(n+=s,null!==this.ic){var a=Is(this.tc,this.ic,this.ac);if(Math.sign(a)===Math.sign(i)){var l=Es(this.tc,this.ic);if(r.push(a),o.push(l),n+=l,null!==this.nc){var c=Is(this.ic,this.nc,this.ac);if(Math.sign(c)===Math.sign(i)){var u=Es(this.ic,this.nc);r.push(c),o.push(u),n+=u}}}}for(var h,d,p,f=0,v=0;v<r.length;++v)f+=o[v]/n*r[v];Math.abs(f)<this.uc||(this.sc={Gf:t,rt:e},this.rc=f,this.hc=(h=Math.abs(f),d=this.oc,p=Math.log(d),Math.log(1*p/-h)/p))}},t.prototype.fc=function(t){var e=xe(this.sc),n=t-e.rt;return e.Gf+this.rc*(Math.pow(this.oc,n)-1)/Math.log(this.oc)},t.prototype.cc=function(t){return null===this.sc||this.vc(t)===this.hc},t.prototype._c=function(){return this.ec},t.prototype.dc=function(){this.ec=!0},t.prototype.vc=function(t){var e=t-xe(this.sc).rt;return Math.min(e,this.hc)},t}(),zs="undefined"!=typeof window;function Us(){return!!zs&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Ns(){return!!zs&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var Os=function(){function t(t,e,n){var i=this;this.wc=0,this.Mc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.mc=0,this.gc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.kc=null,this.Nc=!1,this.xc=null,this.Cc=null,this.Sc=!1,this.Tc=!1,this.Dc=!1,this.Ac=null,this.Bc=null,this.Lc=null,this.Ec=null,this.Fc=null,this.Oc=null,this.Vc=null,this.Pc=0,this.Wc=!1,this.zc=!1,this.Rc=!1,this.Ic=0,this.jc=null,this.qc=!Ns(),this.Uc=function(t){i.Hc(t)},this.Yc=function(t){if(i.$c(t)){var e=i.Kc(t);++i.mc,i.gc&&i.mc>1&&(i.Zc(Hs(t),i.yc).Xc<30&&!i.Dc&&i.Jc(e,i.Qc.Gc),i.tv())}else e=i.Kc(t),++i.wc,i.Mc&&i.wc>1&&(i.Zc(Hs(t),i.bc).Xc<5&&!i.Tc&&i.iv(e,i.Qc.nv),i.sv())},this.hv=t,this.Qc=e,this.zi=n,this.rv()}return t.prototype.g=function(){null!==this.Ac&&(this.Ac(),this.Ac=null),null!==this.Bc&&(this.Bc(),this.Bc=null),null!==this.Ec&&(this.Ec(),this.Ec=null),null!==this.Fc&&(this.Fc(),this.Fc=null),null!==this.Oc&&(this.Oc(),this.Oc=null),null!==this.Lc&&(this.Lc(),this.Lc=null),this.ev(),this.sv()},t.prototype.uv=function(t){var e=this;this.Ec&&this.Ec();var n=this.av.bind(this);if(this.Ec=function(){e.hv.removeEventListener("mousemove",n)},this.hv.addEventListener("mousemove",n),!this.$c(t)){var i=this.Kc(t);this.iv(i,this.Qc.ov),this.qc=!0}},t.prototype.sv=function(){null!==this.Mc&&clearTimeout(this.Mc),this.wc=0,this.Mc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}},t.prototype.tv=function(){null!==this.gc&&clearTimeout(this.gc),this.mc=0,this.gc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}},t.prototype.av=function(t){if(!this.Rc&&null===this.Cc&&!this.$c(t)){var e=this.Kc(t);this.iv(e,this.Qc.lv),this.qc=!0}},t.prototype.fv=function(t){var e=js(t.changedTouches,xe(this.jc));if(null!==e&&(this.Ic=Gs(t),null===this.Vc&&!this.zc)){this.Wc=!0;var n=this.Zc(Hs(e),xe(this.Cc)),i=n.cv,s=n.vv,r=n.Xc;if(this.Sc||!(r<5)){if(!this.Sc){var o=.5*i,a=s>=o&&!this.zi._v(),l=o>s&&!this.zi.dv();a||l||(this.zc=!0),this.Sc=!0,this.Dc=!0,this.ev(),this.tv()}if(!this.zc){var c=this.Kc(t,e);this.Jc(c,this.Qc.wv),Ws(t)}}}},t.prototype.Mv=function(t){if(0===t.button&&(this.Zc(Hs(t),xe(this.xc)).Xc>=5&&(this.Tc=!0,this.sv()),this.Tc)){var e=this.Kc(t);this.iv(e,this.Qc.bv)}},t.prototype.Zc=function(t,e){var n=Math.abs(e.tt-t.tt),i=Math.abs(e.it-t.it);return{cv:n,vv:i,Xc:n+i}},t.prototype.mv=function(t){var e=js(t.changedTouches,xe(this.jc));if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this.jc=null,this.Ic=Gs(t),this.ev(),this.Cc=null,this.Oc&&(this.Oc(),this.Oc=null);var n=this.Kc(t,e);this.Jc(n,this.Qc.pv),++this.mc,this.gc&&this.mc>1?(this.Zc(Hs(e),this.yc).Xc<30&&!this.Dc&&this.Jc(n,this.Qc.Gc),this.tv()):this.Dc||(this.Jc(n,this.Qc.gv),this.Qc.gv&&Ws(t)),0===this.mc&&Ws(t),0===t.touches.length&&this.Nc&&(this.Nc=!1,Ws(t))}},t.prototype.Hc=function(t){if(0===t.button){var e=this.Kc(t);this.xc=null,this.Rc=!1,this.Fc&&(this.Fc(),this.Fc=null),Us()&&this.hv.ownerDocument.documentElement.removeEventListener("mouseleave",this.Uc),this.$c(t)||(this.iv(e,this.Qc.yv),++this.wc,this.Mc&&this.wc>1?(this.Zc(Hs(t),this.bc).Xc<5&&!this.Tc&&this.iv(e,this.Qc.nv),this.sv()):this.Tc||this.iv(e,this.Qc.kv))}},t.prototype.ev=function(){null!==this.kc&&(clearTimeout(this.kc),this.kc=null)},t.prototype.Nv=function(t){if(null===this.jc){var e=t.changedTouches[0];this.jc=e.identifier,this.Ic=Gs(t);var n=this.hv.ownerDocument.documentElement;this.Dc=!1,this.Sc=!1,this.zc=!1,this.Cc=Hs(e),this.Oc&&(this.Oc(),this.Oc=null);var i=this.fv.bind(this),s=this.mv.bind(this);this.Oc=function(){n.removeEventListener("touchmove",i),n.removeEventListener("touchend",s)},n.addEventListener("touchmove",i,{passive:!1}),n.addEventListener("touchend",s,{passive:!1}),this.ev(),this.kc=setTimeout(this.xv.bind(this,t),240);var r=this.Kc(t,e);this.Jc(r,this.Qc.Cv),this.gc||(this.mc=0,this.gc=setTimeout(this.tv.bind(this),500),this.yc=Hs(e))}},t.prototype.Sv=function(t){if(0===t.button){var e=this.hv.ownerDocument.documentElement;Us()&&e.addEventListener("mouseleave",this.Uc),this.Tc=!1,this.xc=Hs(t),this.Fc&&(this.Fc(),this.Fc=null);var n=this.Mv.bind(this),i=this.Hc.bind(this);if(this.Fc=function(){e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",i)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",i),this.Rc=!0,!this.$c(t)){var s=this.Kc(t);this.iv(s,this.Qc.Tv),this.Mc||(this.wc=0,this.Mc=setTimeout(this.sv.bind(this),500),this.bc=Hs(t))}}},t.prototype.rv=function(){var t=this;this.hv.addEventListener("mouseenter",this.uv.bind(this)),this.hv.addEventListener("touchcancel",this.ev.bind(this));var e=this.hv.ownerDocument,n=function(e){t.Qc.Dv&&(e.target&&t.hv.contains(e.target)||t.Qc.Dv())};this.Bc=function(){e.removeEventListener("touchstart",n)},this.Ac=function(){e.removeEventListener("mousedown",n)},e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!0}),Ns()&&(this.Lc=function(){t.hv.removeEventListener("dblclick",t.Yc)},this.hv.addEventListener("dblclick",this.Yc)),this.hv.addEventListener("mouseleave",this.Av.bind(this)),this.hv.addEventListener("touchstart",this.Nv.bind(this),{passive:!0}),function(t){zs&&void 0!==window.chrome&&t.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1}))}(this.hv),this.hv.addEventListener("mousedown",this.Sv.bind(this)),this.Bv(),this.hv.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype.Bv=function(){var t=this;void 0===this.Qc.Lv&&void 0===this.Qc.Ev&&void 0===this.Qc.Fv||(this.hv.addEventListener("touchstart",(function(e){return t.Ov(e.touches)}),{passive:!0}),this.hv.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t.Vc&&void 0!==t.Qc.Ev){var n=Fs(e.touches[0],e.touches[1])/t.Pc;t.Qc.Ev(t.Vc,n),Ws(e)}}),{passive:!1}),this.hv.addEventListener("touchend",(function(e){t.Ov(e.touches)})))},t.prototype.Ov=function(t){1===t.length&&(this.Wc=!1),2!==t.length||this.Wc||this.Nc?this.Vv():this.Pv(t)},t.prototype.Pv=function(t){var e=this.hv.getBoundingClientRect()||{left:0,top:0};this.Vc={tt:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,it:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Pc=Fs(t[0],t[1]),void 0!==this.Qc.Lv&&this.Qc.Lv(),this.ev()},t.prototype.Vv=function(){null!==this.Vc&&(this.Vc=null,void 0!==this.Qc.Fv&&this.Qc.Fv())},t.prototype.Av=function(t){if(this.Ec&&this.Ec(),!this.$c(t)&&this.qc){var e=this.Kc(t);this.iv(e,this.Qc.Wv),this.qc=!Ns()}},t.prototype.xv=function(t){var e=js(t.touches,xe(this.jc));if(null!==e){var n=this.Kc(t,e);this.Jc(n,this.Qc.zv),this.Dc=!0,this.Nc=!0}},t.prototype.$c=function(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:Gs(t)<this.Ic+500},t.prototype.Jc=function(t,e){e&&e.call(this.Qc,t)},t.prototype.iv=function(t,e){e&&e.call(this.Qc,t)},t.prototype.Kc=function(t,e){var n=e||t,i=this.hv.getBoundingClientRect()||{left:0,top:0};return{Rv:n.clientX,Iv:n.clientY,jv:n.pageX,qv:n.pageY,Uv:n.screenX,Hv:n.screenY,Yv:n.clientX-i.left,$v:n.clientY-i.top,Kv:t.ctrlKey,Xv:t.altKey,Zv:t.shiftKey,Jv:t.metaKey,Gv:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,Qv:t.type,t_:n.target,i_:t.view,n_:function(){"touchstart"!==t.type&&Ws(t)}}},t}();function Fs(t,e){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(n*n+i*i)}function Ws(t){t.cancelable&&t.preventDefault()}function Hs(t){return{tt:t.pageX,it:t.pageY}}function Gs(t){return t.timeStamp||performance.now()}function js(t,e){for(var n=0;n<t.length;++n)if(t[n].identifier===e)return t[n];return null}var Ys=function(){function t(t,e,n,i){this.rh=new si(200),this.R=0,this.s_="",this.Yh="",this.th=[],this.h_=new Map,this.R=t,this.s_=e,this.Yh=qe(t,n,i)}return t.prototype.g=function(){this.rh.ih(),this.th=[],this.h_.clear()},t.prototype.r_=function(t,e,n,i,s){var r=this.e_(t,e);if("left"!==s){var o=Ts(t.canvas);n-=Math.floor(r.u_*o)}i-=Math.floor(r.Yt/2),t.drawImage(r.a_,n,i,r.Ht,r.Yt)},t.prototype.e_=function(t,e){var n,i=this;if(this.h_.has(e))n=Me(this.h_.get(e));else{if(this.th.length>=200){var s=Me(this.th.shift());this.h_.delete(s)}var r=Ts(t.canvas),o=Math.ceil(this.R/4.5),a=Math.round(this.R/10),l=Math.ceil(this.rh.Qt(t,e)),c=Gn(Math.round(l+2*o)),u=Gn(this.R+2*o),h=Ls(document,new As(c,u));n={Gt:e,u_:Math.round(Math.max(1,l)),Ht:Math.ceil(c*r),Yt:Math.ceil(u*r),a_:h},0!==l&&(this.th.push(n.Gt),this.h_.set(n.Gt,n)),ln(t=Bs(n.a_),r,(function(){t.font=i.Yh,t.fillStyle=i.s_,t.fillText(e,0,u-o-a)}))}return n},t}(),Xs=function(){function t(t,e,n,i){var s=this;this._i=null,this.o_=null,this.l_=!1,this.f_=new si(50),this.c_=new Ys(11,"#000"),this.s_=null,this.Yh=null,this.v_=0,this.__=!1,this.d_=function(){s.w_(s.cf.W()),s.__||s.Di.M_().jt().Wr()},this.b_=function(){s.__||s.Di.M_().jt().Wr()},this.Di=t,this.zi=e,this.cf=n,this.m_="left"===i,this.p_=document.createElement("div"),this.p_.style.height="100%",this.p_.style.overflow="hidden",this.p_.style.width="25px",this.p_.style.left="0",this.p_.style.position="relative",this.g_=Ps(this.p_,new As(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var r=this.g_.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.y_=Ps(this.p_,new As(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var o=this.y_.canvas;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";var a={Tv:this.k_.bind(this),Cv:this.k_.bind(this),bv:this.N_.bind(this),wv:this.N_.bind(this),Dv:this.x_.bind(this),yv:this.C_.bind(this),pv:this.C_.bind(this),nv:this.S_.bind(this),Gc:this.S_.bind(this),ov:this.T_.bind(this),Wv:this.D_.bind(this)};this.A_=new Os(this.y_.canvas,a,{_v:function(){return!1},dv:function(){return!0}})}return t.prototype.g=function(){this.A_.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy(),null!==this._i&&this._i._a().M(this),this._i=null,this.c_.g()},t.prototype.B_=function(){return this.p_},t.prototype.ht=function(){return xe(this._i).W().borderColor},t.prototype.L_=function(){return this.zi.textColor},t.prototype.S=function(){return this.zi.fontSize},t.prototype.E_=function(){return qe(this.S(),this.zi.fontFamily)},t.prototype.F_=function(){var t=this.cf.W(),e=this.s_!==t.A,n=this.Yh!==t.T;return(e||n)&&(this.w_(t),this.s_=t.A),n&&(this.f_.ih(),this.Yh=t.T),t},t.prototype.O_=function(){if(null===this._i)return 0;var t=0,e=this.F_(),n=Bs(this.g_.canvas),i=this._i.au();n.font=this.E_(),i.length>0&&(t=Math.max(this.f_.Qt(n,i[0].yu),this.f_.Qt(n,i[i.length-1].yu)));for(var s=this.V_(),r=s.length;r--;){var o=this.f_.Qt(n,s[r].Gt());o>t&&(t=o)}var a=this._i.kt();if(null!==a&&null!==this.o_){var l=this._i.qi(1,a),c=this._i.qi(this.o_.Ot-2,a);t=Math.max(t,this.f_.Qt(n,this._i.Mi(Math.floor(Math.min(l,c))+.11111111111111,a)),this.f_.Qt(n,this._i.Mi(Math.ceil(Math.max(l,c))-.11111111111111,a)))}var u=t||34,h=Math.ceil(e.N+e.C+e.L+e.F+u);return h+h%2},t.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.o_&&this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.p_.style.width=t.Ft+"px",this.p_.style.height=t.Ot+"px",this.p_.style.minWidth=t.Ft+"px")},t.prototype.W_=function(){return xe(this.o_).Ft},t.prototype.Si=function(t){this._i!==t&&(null!==this._i&&this._i._a().M(this),this._i=t,t._a().u(this.Eu.bind(this),this))},t.prototype.Ct=function(){return this._i},t.prototype.ih=function(){var t=this.Di.z_();this.Di.M_().jt().no(t,xe(this.Ct()))},t.prototype.R_=function(t){if(null!==this.o_){if(1!==t){var e=Bs(this.g_.canvas);this.I_(),this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio),this.q_(e,this.g_.pixelRatio),this.U_(e,this.g_.pixelRatio)}var n=Bs(this.y_.canvas),i=this.o_.Ft,s=this.o_.Ot;ln(n,this.y_.pixelRatio,(function(){n.clearRect(0,0,i,s)})),this.H_(n,this.y_.pixelRatio)}},t.prototype.Y_=function(){return this.g_.canvas},t.prototype.vt=function(){var t;null===(t=this._i)||void 0===t||t.au()},t.prototype.k_=function(t){if(null!==this._i&&!this._i.wi()&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),n=this.Di.z_();this.l_=!0,e.Ka(n,this._i,t.$v)}},t.prototype.N_=function(t){if(null!==this._i&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),n=this.Di.z_(),i=this._i;e.Xa(n,i,t.$v)}},t.prototype.x_=function(){if(null!==this._i&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var t=this.Di.M_().jt(),e=this.Di.z_(),n=this._i;this.l_&&(this.l_=!1,t.Za(e,n))}},t.prototype.C_=function(t){if(null!==this._i&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),n=this.Di.z_();this.l_=!1,e.Za(n,this._i)}},t.prototype.S_=function(t){this.Di.M_().W().handleScale.axisDoubleClickReset&&this.ih()},t.prototype.T_=function(t){null!==this._i&&(!this.Di.M_().jt().W().handleScale.axisPressedMouseMove.price||this._i.vr()||this._i.Zu()||this.K_(1))},t.prototype.D_=function(t){this.K_(0)},t.prototype.V_=function(){var t=this,e=[],n=null===this._i?void 0:this._i;return function(i){for(var s=0;s<i.length;++s)for(var r=i[s].nn(t.Di.z_(),n),o=0;o<r.length;o++)e.push(r[o])}(this.Di.z_().oa()),e},t.prototype.j_=function(t,e){var n=this;if(null!==this.o_){var i=this.o_.Ft,s=this.o_.Ot;ln(t,e,(function(){var e=n.Di.z_().jt(),r=e.Zf(),o=e.Xf();r===o?cn(t,0,0,i,s,r):un(t,0,0,i,s,r,o)}))}},t.prototype.Rs=function(t,e){if(null!==this.o_&&null!==this._i&&this._i.W().borderVisible){t.save(),t.fillStyle=this.ht();var n,i=Math.max(1,Math.floor(this.F_().N*e));n=this.m_?Math.floor(this.o_.Ft*e)-i:0,t.fillRect(n,0,i,Math.ceil(this.o_.Ot*e)),t.restore()}},t.prototype.q_=function(t,e){if(null!==this.o_&&null!==this._i){var n=this._i.au();t.save(),t.strokeStyle=this.ht(),t.font=this.E_(),t.fillStyle=this.ht();var i=this.F_(),s=this._i.W().borderVisible&&this._i.W().drawTicks,r=this.m_?Math.floor((this.o_.Ft-i.C)*e-i.N*e):Math.floor(i.N*e),o=this.m_?Math.round(r-i.L*e):Math.round(r+i.C*e+i.L*e),a=this.m_?"right":"left",l=Math.max(1,Math.floor(e)),c=Math.floor(.5*e);if(s){var u=Math.round(i.C*e);t.beginPath();for(var h=0,d=n;h<d.length;h++){var p=d[h];t.rect(r,Math.round(p.su*e)-c,u,l)}t.fill()}t.fillStyle=this.L_();for(var f=0,v=n;f<v.length;f++)p=v[f],this.c_.r_(t,p.yu,o,Math.round(p.su*e),a);t.restore()}},t.prototype.I_=function(){if(null!==this.o_&&null!==this._i){var t=this.o_.Ot/2,e=[],n=this._i.oa().slice(),i=this.Di.z_(),s=this.F_();this._i===i.fh()&&this.Di.z_().oa().forEach((function(t){i.lh(t)&&n.push(t)}));var r=this._i.Ge()[0],o=this._i;n.forEach((function(n){var s=n.nn(i,o);s.forEach((function(t){t.oi(null),t.li()&&e.push(t)})),r===n&&s.length>0&&(t=s[0].ti())}));var a=e.filter((function(e){return e.ti()<=t})),l=e.filter((function(e){return e.ti()>t}));if(a.sort((function(t,e){return e.ti()-t.ti()})),a.length&&l.length&&l.push(a[0]),l.sort((function(t,e){return t.ti()-e.ti()})),e.forEach((function(t){return t.oi(t.ti())})),this._i.W().alignLabels){for(var c=1;c<a.length;c++){var u=a[c],h=(p=a[c-1]).Yt(s,!1);u.ti()>(f=p.ai())-h&&u.oi(f-h)}for(var d=1;d<l.length;d++){var p,f;u=l[d],h=(p=l[d-1]).Yt(s,!0),u.ti()<(f=p.ai())+h&&u.oi(f+h)}}}},t.prototype.U_=function(t,e){var n=this;if(null!==this.o_){t.save();var i=this.o_,s=this.V_(),r=this.F_(),o=this.m_?"right":"left";s.forEach((function(s){if(s.fi()){var a=s.dt(xe(n._i));t.save(),a.H(t,r,n.f_,i.Ft,o,e),t.restore()}})),t.restore()}},t.prototype.H_=function(t,e){var n=this;if(null!==this.o_&&null!==this._i){t.save();var i=this.o_,s=this.Di.M_().jt(),r=[],o=this.Di.z_(),a=s.Tf().nn(o,this._i);a.length&&r.push(a);var l=this.F_(),c=this.m_?"right":"left";r.forEach((function(s){s.forEach((function(s){t.save(),s.dt(xe(n._i)).H(t,l,n.f_,i.Ft,c,e),t.restore()}))})),t.restore()}},t.prototype.K_=function(t){this.p_.style.cursor=1===t?"ns-resize":"default"},t.prototype.Eu=function(){var t=this.O_();this.v_<t&&this.Di.M_().jt().Ce(),this.v_=t},t.prototype.w_=function(t){this.c_.g(),this.c_=new Ys(t.S,t.A,t.D)},t}();function Zs(t,e,n,i,s){t.$&&t.$(e,n,i,s)}function qs(t,e,n,i,s){t.H(e,n,i,s)}function Js(t,e){return t.tn(e)}function Ks(t,e){return void 0!==t.Pe?t.Pe(e):[]}var Qs=function(){function t(t,e){var n=this;this.o_=new As(0,0),this.X_=null,this.Z_=null,this.J_=null,this.G_=!1,this.Q_=new Ne,this.td=0,this.nd=!1,this.sd=null,this.hd=!1,this.rd=null,this.ed=null,this.__=!1,this.d_=function(){n.__||null===n.ud||n.pi().Wr()},this.b_=function(){n.__||null===n.ud||n.pi().Wr()},this.ad=t,this.ud=e,this.ud.ro().u(this.od.bind(this),this,!0),this.ld=document.createElement("td"),this.ld.style.padding="0",this.ld.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.fd=document.createElement("td"),this.fd.style.padding="0",this.vd=document.createElement("td"),this.vd.style.padding="0",this.ld.appendChild(i),this.g_=Ps(i,new As(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var s=this.g_.canvas;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.y_=Ps(i,new As(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var r=this.y_.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this._d=document.createElement("tr"),this._d.appendChild(this.fd),this._d.appendChild(this.ld),this._d.appendChild(this.vd),this.dd(),this.A_=new Os(this.y_.canvas,this,{_v:function(){return null===n.sd&&!n.ad.W().handleScroll.vertTouchDrag},dv:function(){return null===n.sd&&!n.ad.W().handleScroll.horzTouchDrag}})}return t.prototype.g=function(){null!==this.X_&&this.X_.g(),null!==this.Z_&&this.Z_.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy(),null!==this.ud&&this.ud.ro().M(this),this.A_.g()},t.prototype.z_=function(){return xe(this.ud)},t.prototype.wd=function(e){null!==this.ud&&this.ud.ro().M(this),this.ud=e,null!==this.ud&&this.ud.ro().u(t.prototype.od.bind(this),this,!0),this.dd()},t.prototype.M_=function(){return this.ad},t.prototype.B_=function(){return this._d},t.prototype.dd=function(){if(null!==this.ud&&(this.Md(),0!==this.pi()._t().length)){if(null!==this.X_){var t=this.ud.Ya();this.X_.Si(xe(t))}if(null!==this.Z_){var e=this.ud.$a();this.Z_.Si(xe(e))}}},t.prototype.bd=function(){null!==this.X_&&this.X_.vt(),null!==this.Z_&&this.Z_.vt()},t.prototype.Wa=function(){return null!==this.ud?this.ud.Wa():0},t.prototype.za=function(t){this.ud&&this.ud.za(t)},t.prototype.ov=function(t){if(this.ud){this.md();var e=t.Yv,n=t.$v;this.pd(e,n)}},t.prototype.Tv=function(t){this.md(),this.gd(),this.pd(t.Yv,t.$v)},t.prototype.lv=function(t){if(this.ud){this.md();var e=t.Yv,n=t.$v;this.pd(e,n);var i=this.$h(e,n);this.pi().yf(i&&{kf:i.kf,yd:i.yd})}},t.prototype.kv=function(t){if(null!==this.ud){this.md();var e=t.Yv,n=t.$v;if(this.Q_.p()){var i=this.pi().Tf().Mt();this.Q_.m(i,{x:e,y:n})}}},t.prototype.bv=function(t){this.md(),this.kd(t),this.pd(t.Yv,t.$v)},t.prototype.yv=function(t){null!==this.ud&&(this.md(),this.nd=!1,this.Nd(t))},t.prototype.zv=function(t){if(this.nd=!0,null===this.sd){var e={x:t.Yv,y:t.$v};this.xd(e,e)}},t.prototype.Wv=function(t){null!==this.ud&&(this.md(),this.ud.jt().yf(null),this.Cd())},t.prototype.Sd=function(){return this.Q_},t.prototype.Lv=function(){this.td=1,this.Td()},t.prototype.Ev=function(t,e){if(this.ad.W().handleScale.pinch){var n=5*(e-this.td);this.td=e,this.pi().Ef(t.tt,n)}},t.prototype.Cv=function(t){if(this.nd=!1,this.hd=null!==this.sd,this.gd(),null!==this.sd){var e=this.pi().Tf();this.rd={x:e.$t(),y:e.Kt()},this.sd={x:t.Yv,y:t.$v}}},t.prototype.wv=function(t){if(null!==this.ud){var e=t.Yv,n=t.$v;if(null===this.sd)this.kd(t);else{this.hd=!1;var i=xe(this.rd),s=i.x+(e-this.sd.x),r=i.y+(n-this.sd.y);this.pd(s,r)}}},t.prototype.pv=function(t){0===this.M_().W().trackingMode.exitMode&&(this.hd=!0),this.Dd(),this.Nd(t)},t.prototype.$h=function(t,e){var n=this.ud;if(null===n)return null;for(var i=0,s=n.oa();i<s.length;i++){var r=s[i],o=this.Ad(r.tn(n),t,e);if(null!==o)return{kf:r,i_:o.i_,yd:o.yd}}return null},t.prototype.Bd=function(t,e){xe("left"===e?this.X_:this.Z_).P_(new As(t,this.o_.Ot))},t.prototype.Ld=function(){return this.o_},t.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.ld.style.width=t.Ft+"px",this.ld.style.height=t.Ot+"px")},t.prototype.Ed=function(){var t=xe(this.ud);t.Ha(t.Ya()),t.Ha(t.$a());for(var e=0,n=t.Ge();e<n.length;e++){var i=n[e];if(t.lh(i)){var s=i.Ct();null!==s&&t.Ha(s),i.hn()}}},t.prototype.Y_=function(){return this.g_.canvas},t.prototype.R_=function(t){if(0!==t&&null!==this.ud){if(t>1&&this.Ed(),null!==this.X_&&this.X_.R_(t),null!==this.Z_&&this.Z_.R_(t),1!==t){var e=Bs(this.g_.canvas);e.save(),this.j_(e,this.g_.pixelRatio),this.ud&&(this.Fd(e,this.g_.pixelRatio),this.Od(e,this.g_.pixelRatio),this.Vd(e,this.g_.pixelRatio,Js)),e.restore()}var n=Bs(this.y_.canvas);n.clearRect(0,0,Math.ceil(this.o_.Ft*this.y_.pixelRatio),Math.ceil(this.o_.Ot*this.y_.pixelRatio)),this.Vd(n,this.g_.pixelRatio,Ks),this.Pd(n,this.y_.pixelRatio)}},t.prototype.Wd=function(){return this.X_},t.prototype.zd=function(){return this.Z_},t.prototype.od=function(){null!==this.ud&&this.ud.ro().M(this),this.ud=null},t.prototype.j_=function(t,e){var n=this;ln(t,e,(function(){var e=n.pi(),i=e.Zf(),s=e.Xf();i===s?cn(t,0,0,n.o_.Ft,n.o_.Ot,s):un(t,0,0,n.o_.Ft,n.o_.Ot,i,s)}))},t.prototype.Fd=function(t,e){var n=xe(this.ud),i=n.eo().ou().dt(n.Yt(),n.Ht());null!==i&&(t.save(),i.H(t,e,!1),t.restore())},t.prototype.Od=function(t,e){var n=this.pi().Sf();this.Rd(t,e,Js,Zs,n),this.Rd(t,e,Js,qs,n)},t.prototype.Pd=function(t,e){this.Rd(t,e,Js,qs,this.pi().Tf())},t.prototype.Vd=function(t,e,n){for(var i=xe(this.ud).oa(),s=0,r=i;s<r.length;s++){var o=r[s];this.Rd(t,e,n,Zs,o)}for(var a=0,l=i;a<l.length;a++)o=l[a],this.Rd(t,e,n,qs,o)},t.prototype.Rd=function(t,e,n,i,s){for(var r=xe(this.ud),o=n(s,r),a=r.Yt(),l=r.Ht(),c=r.jt().gf(),u=null!==c&&c.kf===s,h=null!==c&&u&&void 0!==c.yd?c.yd.Kh:void 0,d=0,p=o;d<p.length;d++){var f=p[d].dt(a,l);null!==f&&(t.save(),i(f,t,e,u,h),t.restore())}},t.prototype.Ad=function(t,e,n){for(var i=0,s=t;i<s.length;i++){var r=s[i],o=r.dt(this.o_.Ot,this.o_.Ft);if(null!==o&&o.$h){var a=o.$h(e,n);if(null!==a)return{i_:r,yd:a}}}return null},t.prototype.Md=function(){if(null!==this.ud){var t=this.ad,e=this.ud.Ya().W().visible,n=this.ud.$a().W().visible;e||null===this.X_||(this.fd.removeChild(this.X_.B_()),this.X_.g(),this.X_=null),n||null===this.Z_||(this.vd.removeChild(this.Z_.B_()),this.Z_.g(),this.Z_=null);var i=t.jt().qf();e&&null===this.X_&&(this.X_=new Xs(this,t.W().layout,i,"left"),this.fd.appendChild(this.X_.B_())),n&&null===this.Z_&&(this.Z_=new Xs(this,t.W().layout,i,"right"),this.vd.appendChild(this.Z_.B_()))}},t.prototype.Id=function(t){return t.Gv&&this.nd||null!==this.sd},t.prototype.jd=function(t){return Math.max(0,Math.min(t,this.o_.Ft-1))},t.prototype.qd=function(t){return Math.max(0,Math.min(t,this.o_.Ot-1))},t.prototype.pd=function(t,e){this.pi().Rf(this.jd(t),this.qd(e),xe(this.ud))},t.prototype.Cd=function(){this.pi().If()},t.prototype.Dd=function(){this.hd&&(this.sd=null,this.Cd())},t.prototype.xd=function(t,e){this.sd=t,this.hd=!1,this.pd(e.x,e.y);var n=this.pi().Tf();this.rd={x:n.$t(),y:n.Kt()}},t.prototype.pi=function(){return this.ad.jt()},t.prototype.Ud=function(){var t=this.pi(),e=this.z_(),n=e.ji();t.Qa(e,n),t.Pf(),this.J_=null,this.G_=!1},t.prototype.Nd=function(t){var e=this;if(this.G_){var n=performance.now();if(null!==this.ed&&this.ed.xh(t.Yv,n),null===this.ed||this.ed.cc(n))this.Ud();else{var i=this.pi(),s=i.bt(),r=this.ed,o=function(){if(!r._c()){var t=performance.now(),n=r.cc(t);if(!r._c()){var a=s.Nl();i.Vf(r.fc(t)),a===s.Nl()&&(n=!0,e.ed=null)}n?e.Ud():requestAnimationFrame(o)}};requestAnimationFrame(o)}}},t.prototype.md=function(){this.sd=null},t.prototype.gd=function(){if(this.ud){if(this.Td(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)xe(document.activeElement).blur();else{var t=document.getSelection();null!==t&&t.removeAllRanges()}!this.ud.ji().wi()&&this.pi().bt().wi()}},t.prototype.kd=function(t){if(null!==this.ud){var e=this.pi();if(!e.bt().wi()){var n=this.ad.W(),i=n.handleScroll,s=n.kineticScroll;if(i.pressedMouseMove&&!t.Gv||(i.horzTouchDrag||i.vertTouchDrag)&&t.Gv){var r=this.ud.ji(),o=performance.now();null!==this.J_||this.Id(t)||(this.J_={x:t.Rv,y:t.Iv,So:o,Yv:t.Yv,$v:t.$v}),null!==this.ed&&this.ed.lc(t.Yv,o),null===this.J_||this.G_||this.J_.x===t.Rv&&this.J_.y===t.Iv||(null===this.ed&&(t.Gv&&s.touch||!t.Gv&&s.mouse)&&(this.ed=new Rs(.2,7,.997,15),this.ed.lc(this.J_.Yv,this.J_.So),this.ed.lc(t.Yv,o)),r.wi()||e.Ja(this.ud,r,t.$v),e.Of(t.Yv),this.G_=!0),this.G_&&(r.wi()||e.Ga(this.ud,r,t.$v),e.Vf(t.Yv))}}}},t.prototype.Td=function(){var t=performance.now(),e=null===this.ed||this.ed.cc(t);null!==this.ed&&(e||this.Ud()),null!==this.ed&&(this.ed.dc(),this.ed=null)},t}(),tr=function(){function t(t,e,n,i,s){var r=this;this.ft=!0,this.o_=new As(0,0),this.d_=function(){return r.R_(3)},this.m_="left"===t,this.cf=n.qf,this.zi=e,this.Hd=i,this.Yd=s,this.p_=document.createElement("div"),this.p_.style.width="25px",this.p_.style.height="100%",this.p_.style.overflow="hidden",this.g_=Ps(this.p_,new As(16,16)),this.g_.subscribeCanvasConfigured(this.d_)}return t.prototype.g=function(){this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy()},t.prototype.B_=function(){return this.p_},t.prototype.Ld=function(){return this.o_},t.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.o_.br(t)||(this.o_=t,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.p_.style.width="".concat(t.Ft,"px"),this.p_.style.minWidth="".concat(t.Ft,"px"),this.p_.style.height="".concat(t.Ot,"px"),this.ft=!0)},t.prototype.R_=function(t){if((!(t<3)||this.ft)&&0!==this.o_.Ft&&0!==this.o_.Ot){this.ft=!1;var e=Bs(this.g_.canvas);this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio)}},t.prototype.Y_=function(){return this.g_.canvas},t.prototype.Rs=function(t,e){if(this.Hd()){var n=this.o_.Ft;t.save(),t.fillStyle=this.zi.timeScale.borderColor;var i=Math.floor(this.cf.W().N*e),s=this.m_?Math.round(n*e)-i:0;t.fillRect(s,0,i,i),t.restore()}},t.prototype.j_=function(t,e){var n=this;ln(t,e,(function(){cn(t,0,0,n.o_.Ft,n.o_.Ot,n.Yd())}))},t}();function er(t,e){return t.Po>e.Po?t:e}var nr=function(){function t(t){var e=this;this.$d=null,this.Kd=null,this.k=null,this.Xd=!1,this.o_=new As(0,0),this.Zd=new Ne,this.f_=new si(5),this.__=!1,this.d_=function(){e.__||e.ad.jt().Wr()},this.b_=function(){e.__||e.ad.jt().Wr()},this.ad=t,this.zi=t.W().layout,this.Jd=document.createElement("tr"),this.Gd=document.createElement("td"),this.Gd.style.padding="0",this.Qd=document.createElement("td"),this.Qd.style.padding="0",this.p_=document.createElement("td"),this.p_.style.height="25px",this.p_.style.padding="0",this.tw=document.createElement("div"),this.tw.style.width="100%",this.tw.style.height="100%",this.tw.style.position="relative",this.tw.style.overflow="hidden",this.p_.appendChild(this.tw),this.g_=Ps(this.tw,new As(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var n=this.g_.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.y_=Ps(this.tw,new As(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var i=this.y_.canvas;i.style.position="absolute",i.style.zIndex="2",i.style.left="0",i.style.top="0",this.Jd.appendChild(this.Gd),this.Jd.appendChild(this.p_),this.Jd.appendChild(this.Qd),this.iw(),this.ad.jt().Pa().u(this.iw.bind(this),this),this.A_=new Os(this.y_.canvas,this,{_v:function(){return!0},dv:function(){return!1}})}return t.prototype.g=function(){this.A_.g(),null!==this.$d&&this.$d.g(),null!==this.Kd&&this.Kd.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy()},t.prototype.B_=function(){return this.Jd},t.prototype.nw=function(){return this.$d},t.prototype.sw=function(){return this.Kd},t.prototype.Tv=function(t){if(!this.Xd){this.Xd=!0;var e=this.ad.jt();!e.bt().wi()&&this.ad.W().handleScale.axisPressedMouseMove.time&&e.Lf(t.Yv)}},t.prototype.Cv=function(t){this.Tv(t)},t.prototype.Dv=function(){var t=this.ad.jt();!t.bt().wi()&&this.Xd&&(this.Xd=!1,this.ad.W().handleScale.axisPressedMouseMove.time&&t.zf())},t.prototype.bv=function(t){var e=this.ad.jt();!e.bt().wi()&&this.ad.W().handleScale.axisPressedMouseMove.time&&e.Wf(t.Yv)},t.prototype.wv=function(t){this.bv(t)},t.prototype.yv=function(){this.Xd=!1;var t=this.ad.jt();t.bt().wi()&&!this.ad.W().handleScale.axisPressedMouseMove.time||t.zf()},t.prototype.pv=function(){this.yv()},t.prototype.nv=function(){this.ad.W().handleScale.axisDoubleClickReset&&this.ad.jt().pn()},t.prototype.Gc=function(){this.nv()},t.prototype.ov=function(){this.ad.jt().W().handleScale.axisPressedMouseMove.time&&this.K_(1)},t.prototype.Wv=function(){this.K_(0)},t.prototype.Ld=function(){return this.o_},t.prototype.hw=function(){return this.Zd},t.prototype.rw=function(t,e,n){this.o_&&this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.p_.style.width=t.Ft+"px",this.p_.style.height=t.Ot+"px",this.Zd.m(t)),null!==this.$d&&this.$d.P_(new As(e,t.Ot)),null!==this.Kd&&this.Kd.P_(new As(n,t.Ot))},t.prototype.ew=function(){var t=this.uw();return Math.ceil(t.N+t.C+t.S+t.O+t.B)},t.prototype.vt=function(){this.ad.jt().bt().au()},t.prototype.Y_=function(){return this.g_.canvas},t.prototype.R_=function(t){if(0!==t){if(1!==t){var e=Bs(this.g_.canvas);this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio),this.q_(e,this.g_.pixelRatio),null!==this.$d&&this.$d.R_(t),null!==this.Kd&&this.Kd.R_(t)}var n=Bs(this.y_.canvas),i=this.y_.pixelRatio;n.clearRect(0,0,Math.ceil(this.o_.Ft*i),Math.ceil(this.o_.Ot*i)),this.aw([this.ad.jt().Tf()],n,i)}},t.prototype.j_=function(t,e){var n=this;ln(t,e,(function(){cn(t,0,0,n.o_.Ft,n.o_.Ot,n.ad.jt().Xf())}))},t.prototype.Rs=function(t,e){if(this.ad.W().timeScale.borderVisible){t.save(),t.fillStyle=this.ow();var n=Math.max(1,Math.floor(this.uw().N*e));t.fillRect(0,0,Math.ceil(this.o_.Ft*e),n),t.restore()}},t.prototype.q_=function(t,e){var n=this,i=this.ad.jt().bt().au();if(i&&0!==i.length){var s=i.reduce(er,i[0]).Po;s>30&&s<50&&(s=30),t.save(),t.strokeStyle=this.ow();var r=this.uw(),o=r.N+r.C+r.O+r.S-r.V;t.textAlign="center",t.fillStyle=this.ow();var a=Math.floor(this.uw().N*e),l=Math.max(1,Math.floor(e)),c=Math.floor(.5*e);if(this.ad.jt().bt().W().borderVisible){t.beginPath();for(var u=Math.round(r.C*e),h=i.length;h--;){var d=Math.round(i[h].su*e);t.rect(d-c,a,l,u)}t.fill()}t.fillStyle=this.j(),ln(t,e,(function(){t.font=n.lw();for(var e=0,r=i;e<r.length;e++)if((u=r[e]).Po<s){var a=u.Sl?n.fw(t,u.su,u.yu):u.su;t.fillText(u.yu,a,o)}t.font=n.cw();for(var l=0,c=i;l<c.length;l++){var u;(u=c[l]).Po>=s&&(a=u.Sl?n.fw(t,u.su,u.yu):u.su,t.fillText(u.yu,a,o))}})),t.restore()}},t.prototype.fw=function(t,e,n){var i=this.f_.Qt(t,n),s=i/2,r=Math.floor(e-s)+.5;return r<0?e+=Math.abs(0-r):r+i>this.o_.Ft&&(e-=Math.abs(this.o_.Ft-(r+i))),e},t.prototype.aw=function(t,e,n){for(var i=this.uw(),s=0,r=t;s<r.length;s++)for(var o=0,a=r[s].Ti();o<a.length;o++){var l=a[o];e.save(),l.dt().H(e,i,n),e.restore()}},t.prototype.ow=function(){return this.ad.W().timeScale.borderColor},t.prototype.j=function(){return this.zi.textColor},t.prototype.R=function(){return this.zi.fontSize},t.prototype.lw=function(){return qe(this.R(),this.zi.fontFamily)},t.prototype.cw=function(){return qe(this.R(),this.zi.fontFamily,"bold")},t.prototype.uw=function(){null===this.k&&(this.k={N:1,V:NaN,O:NaN,B:NaN,mi:NaN,C:3,S:NaN,T:"",bi:new si});var t=this.k,e=this.lw();if(t.T!==e){var n=this.R();t.S=n,t.T=e,t.O=Math.ceil(n/2.5),t.B=t.O,t.mi=Math.ceil(n/2),t.V=Math.round(this.R()/5),t.bi.ih()}return this.k},t.prototype.K_=function(t){this.p_.style.cursor=1===t?"ew-resize":"default"},t.prototype.iw=function(){var t=this.ad.jt(),e=t.W();e.leftPriceScale.visible||null===this.$d||(this.Gd.removeChild(this.$d.B_()),this.$d.g(),this.$d=null),e.rightPriceScale.visible||null===this.Kd||(this.Qd.removeChild(this.Kd.B_()),this.Kd.g(),this.Kd=null);var n={qf:this.ad.jt().qf()},i=function(){return e.leftPriceScale.borderVisible&&t.bt().W().borderVisible},s=function(){return t.Xf()};e.leftPriceScale.visible&&null===this.$d&&(this.$d=new tr("left",e,n,i,s),this.Gd.appendChild(this.$d.B_())),e.rightPriceScale.visible&&null===this.Kd&&(this.Kd=new tr("right",e,n,i,s),this.Qd.appendChild(this.Kd.B_()))},t}(),ir=function(){function t(t,e){var n;this._w=[],this.dw=0,this.xu=0,this.hh=0,this.ww=0,this.Mw=0,this.bw=null,this.mw=!1,this.Q_=new Ne,this.af=new Ne,this.zi=e,this.Jd=document.createElement("div"),this.Jd.classList.add("tv-lightweight-charts"),this.Jd.style.overflow="hidden",this.Jd.style.width="100%",this.Jd.style.height="100%",(n=this.Jd).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.pw=document.createElement("table"),this.pw.setAttribute("cellspacing","0"),this.Jd.appendChild(this.pw),this.gw=this.yw.bind(this),this.Jd.addEventListener("wheel",this.gw,{passive:!1}),this.pi=new Cs(this.ff.bind(this),this.zi),this.jt().Df().u(this.kw.bind(this),this),this.Nw=new nr(this),this.pw.appendChild(this.Nw.B_());var i=this.zi.width,s=this.zi.height;if(0===i||0===s){var r=t.getBoundingClientRect();0===i&&(i=Math.floor(r.width),i-=i%2),0===s&&(s=Math.floor(r.height),s-=s%2)}this.xw(i,s),this.Cw(),t.appendChild(this.Jd),this.Sw(),this.pi.bt().Pl().u(this.pi.Ce.bind(this.pi),this),this.pi.Pa().u(this.pi.Ce.bind(this.pi),this)}return t.prototype.jt=function(){return this.pi},t.prototype.W=function(){return this.zi},t.prototype.Tw=function(){return this._w},t.prototype.Dw=function(){return this.Nw},t.prototype.g=function(){this.Jd.removeEventListener("wheel",this.gw),0!==this.dw&&window.cancelAnimationFrame(this.dw),this.pi.Df().M(this),this.pi.bt().Pl().M(this),this.pi.Pa().M(this),this.pi.g();for(var t=0,e=this._w;t<e.length;t++){var n=e[t];this.pw.removeChild(n.B_()),n.Sd().M(this),n.g()}this._w=[],xe(this.Nw).g(),null!==this.Jd.parentElement&&this.Jd.parentElement.removeChild(this.Jd),this.af.g(),this.Q_.g()},t.prototype.xw=function(t,e,n){if(void 0===n&&(n=!1),this.xu!==e||this.hh!==t){this.xu=e,this.hh=t;var i=e+"px",s=t+"px";xe(this.Jd).style.height=i,xe(this.Jd).style.width=s,this.pw.style.height=i,this.pw.style.width=s,n?this.Aw(new Sn(3)):this.pi.Ce()}},t.prototype.R_=function(t){void 0===t&&(t=new Sn(3));for(var e=0;e<this._w.length;e++)this._w[e].R_(t.wn(e).vn);this.zi.timeScale.visible&&this.Nw.R_(t.dn())},t.prototype.Pr=function(t){this.pi.Pr(t),this.Sw();var e=t.width||this.hh,n=t.height||this.xu;this.xw(e,n)},t.prototype.Sd=function(){return this.Q_},t.prototype.Df=function(){return this.af},t.prototype.Bw=function(){var t=this;null!==this.bw&&(this.Aw(this.bw),this.bw=null);var e=this._w[0],n=Ls(document,new As(this.hh,this.xu)),i=Bs(n),s=Ts(n);return ln(i,s,(function(){var n=0,s=0,r=function(e){for(var r=0;r<t._w.length;r++){var o=t._w[r],a=o.Ld().Ot,l=xe("left"===e?o.Wd():o.zd()),c=l.Y_();i.drawImage(c,n,s,l.W_(),a),s+=a}};t.Lw()&&(r("left"),n=xe(e.Wd()).W_()),s=0;for(var o=0;o<t._w.length;o++){var a=t._w[o],l=a.Ld(),c=a.Y_();i.drawImage(c,n,s,l.Ft,l.Ot),s+=l.Ot}n+=e.Ld().Ft,t.Ew()&&(s=0,r("right"));var u=function(e){var r=xe("left"===e?t.Nw.nw():t.Nw.sw()),o=r.Ld(),a=r.Y_();i.drawImage(a,n,s,o.Ft,o.Ot)};if(t.zi.timeScale.visible){n=0,t.Lw()&&(u("left"),n=xe(e.Wd()).W_());var h=t.Nw.Ld();c=t.Nw.Y_(),i.drawImage(c,n,s,h.Ft,h.Ot),t.Ew()&&(n+=e.Ld().Ft,u("right"),i.restore())}})),n},t.prototype.Fw=function(t){return"none"===t||"left"===t&&!this.Lw()||"right"===t&&!this.Ew()||0===this._w.length?0:xe("left"===t?this._w[0].Wd():this._w[0].zd()).W_()},t.prototype.Ow=function(){for(var t=0,e=0,n=0,i=0,s=this._w;i<s.length;i++){var r=s[i];this.Lw()&&(e=Math.max(e,xe(r.Wd()).O_())),this.Ew()&&(n=Math.max(n,xe(r.zd()).O_())),t+=r.Wa()}var o=this.hh,a=this.xu,l=Math.max(o-e-n,0),c=this.zi.timeScale.visible,u=c?this.Nw.ew():0;u%2&&(u+=1);for(var h=0+u,d=a<h?0:a-h,p=d/t,f=0,v=0;v<this._w.length;++v){(r=this._w[v]).wd(this.pi.Cf()[v]);var g,m;m=v===this._w.length-1?d-f:Math.round(r.Wa()*p),f+=g=Math.max(m,2),r.P_(new As(l,g)),this.Lw()&&r.Bd(e,"left"),this.Ew()&&r.Bd(n,"right"),r.z_()&&this.pi.Af(r.z_(),g)}this.Nw.rw(new As(c?l:0,u),c?e:0,c?n:0),this.pi.Ra(l),this.ww!==e&&(this.ww=e),this.Mw!==n&&(this.Mw=n)},t.prototype.yw=function(t){var e=t.deltaX/100,n=-t.deltaY/100;if(0!==e&&this.zi.handleScroll.mouseWheel||0!==n&&this.zi.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120,n*=120;break;case t.DOM_DELTA_LINE:e*=32,n*=32}if(0!==n&&this.zi.handleScale.mouseWheel){var i=Math.sign(n)*Math.min(1,Math.abs(n)),s=t.clientX-this.Jd.getBoundingClientRect().left;this.jt().Ef(s,i)}0!==e&&this.zi.handleScroll.mouseWheel&&this.jt().Ff(-80*e)}},t.prototype.Aw=function(t){var e,n=t.dn();3===n&&this.Vw(),3!==n&&2!==n||(this.Pw(t),this.Ww(t),this.Nw.vt(),this._w.forEach((function(t){t.bd()})),3===(null===(e=this.bw)||void 0===e?void 0:e.dn())&&(this.bw.Nn(t),this.Vw(),this.Pw(this.bw),this.Ww(this.bw),t=this.bw,this.bw=null)),this.R_(t)},t.prototype.Ww=function(t){for(var e=0,n=t.kn();e<n.length;e++){var i=n[e];this.xn(i)}},t.prototype.Pw=function(t){for(var e=this.pi.Cf(),n=0;n<e.length;n++)t.wn(n)._n&&e[n].so()},t.prototype.xn=function(t){var e=this.pi.bt();switch(t.bn){case 0:e.zl();break;case 1:e.Rl(t.St);break;case 2:e.gn(t.St);break;case 3:e.yn(t.St);break;case 4:e.Tl()}},t.prototype.ff=function(t){var e=this;null!==this.bw?this.bw.Nn(t):this.bw=t,this.mw||(this.mw=!0,this.dw=window.requestAnimationFrame((function(){if(e.mw=!1,e.dw=0,null!==e.bw){var t=e.bw;e.bw=null,e.Aw(t)}})))},t.prototype.Vw=function(){this.Cw()},t.prototype.Cw=function(){for(var t=this.pi.Cf(),e=t.length,n=this._w.length,i=e;i<n;i++){var s=Me(this._w.pop());this.pw.removeChild(s.B_()),s.Sd().M(this),s.g()}for(i=n;i<e;i++)(s=new Qs(this,t[i])).Sd().u(this.zw.bind(this),this),this._w.push(s),this.pw.insertBefore(s.B_(),this.Nw.B_());for(i=0;i<e;i++){var r=t[i];(s=this._w[i]).z_()!==r?s.wd(r):s.dd()}this.Sw(),this.Ow()},t.prototype.Rw=function(t,e){var n,i=new Map;if(null!==t&&this.pi._t().forEach((function(e){var n=e.er(t);null!==n&&i.set(e,n)})),null!==t){var s=this.pi.bt().gi(t);null!==s&&(n=s)}var r=this.jt().gf(),o=null!==r&&r.kf instanceof zi?r.kf:void 0,a=null!==r&&void 0!==r.yd?r.yd.Zh:void 0;return{rt:n,Iw:e||void 0,jw:o,qw:i,Uw:a}},t.prototype.zw=function(t,e){var n=this;this.Q_.m((function(){return n.Rw(t,e)}))},t.prototype.kw=function(t,e){var n=this;this.af.m((function(){return n.Rw(t,e)}))},t.prototype.Sw=function(){var t=this.zi.timeScale.visible?"":"none";this.Nw.B_().style.display=t},t.prototype.Lw=function(){return this._w[0].z_().Ya().W().visible},t.prototype.Ew=function(){return this._w[0].z_().$a().W().visible},t}();function sr(t,e,n){var i=n.value;return{vs:e,rt:t,St:[i,i,i,i]}}function rr(t,e,n){var i=n.value,s={vs:e,rt:t,St:[i,i,i,i]};return"color"in n&&void 0!==n.color&&(s.A=n.color),s}function or(t){return void 0!==t.St}function ar(t){return function(e,n,i){return void 0===(s=i).open&&void 0===s.value?{rt:e,vs:n}:t(e,n,i);var s}}var lr={Candlestick:ar((function(t,e,n){var i={vs:e,rt:t,St:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(i.A=n.color),"borderColor"in n&&void 0!==n.borderColor&&(i.Tt=n.borderColor),"wickColor"in n&&void 0!==n.wickColor&&(i.qs=n.wickColor),i})),Bar:ar((function(t,e,n){var i={vs:e,rt:t,St:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(i.A=n.color),i})),Area:ar(sr),Baseline:ar(sr),Histogram:ar(rr),Line:ar(rr)};function cr(t){return lr[t]}function ur(t){return 60*t*60*1e3}function hr(t){return 60*t*1e3}var dr=[{Hw:(1,1e3),Po:10},{Hw:hr(1),Po:20},{Hw:hr(5),Po:21},{Hw:hr(30),Po:22},{Hw:ur(1),Po:30},{Hw:ur(3),Po:31},{Hw:ur(6),Po:32},{Hw:ur(12),Po:33}];function pr(t,e){if(t.getUTCFullYear()!==e.getUTCFullYear())return 70;if(t.getUTCMonth()!==e.getUTCMonth())return 60;if(t.getUTCDate()!==e.getUTCDate())return 50;for(var n=dr.length-1;n>=0;--n)if(Math.floor(e.getTime()/dr[n].Hw)!==Math.floor(t.getTime()/dr[n].Hw))return dr[n].Po;return 0}function fr(t,e){if(void 0===e&&(e=0),0!==t.length){for(var n=0===e?null:t[e-1].rt.So,i=null!==n?new Date(1e3*n):null,s=0,r=e;r<t.length;++r){var o=t[r],a=new Date(1e3*o.rt.So);null!==i&&(o.Vo=pr(a,i)),s+=o.rt.So-(n||o.rt.So),n=o.rt.So,i=a}if(0===e&&t.length>1){var l=Math.ceil(s/(t.length-1)),c=new Date(1e3*(t[0].rt.So-l));t[0].Vo=pr(new Date(1e3*t[0].rt.So),c)}}}function vr(t){if(!Ds(t))throw new Error("time must be of type BusinessDay");var e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{So:Math.round(e.getTime()/1e3),Co:t}}function gr(t){if(!Vs(t))throw new Error("time must be of type isUTCTimestamp");return{So:t}}function mr(t){return 0===t.length?null:Ds(t[0].time)?vr:gr}function yr(t){return Vs(t)?gr(t):Ds(t)?vr(t):vr(br(t))}function br(t){var e=new Date(t);if(isNaN(e.getTime()))throw new Error("Invalid date string=".concat(t,", expected format=yyyy-mm-dd"));return{day:e.getUTCDate(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}}function wr(t){He(t.time)&&(t.time=br(t.time))}function Sr(t){return{vs:0,Yw:new Map,Ve:t}}function _r(t){if(void 0!==t&&0!==t.length)return{$w:t[0].rt.So,Kw:t[t.length-1].rt.So}}var $r=function(){function t(){this.Xw=new Map,this.Zw=new Map,this.Jw=new Map,this.Gw=[]}return t.prototype.g=function(){this.Xw.clear(),this.Zw.clear(),this.Jw.clear(),this.Gw=[]},t.prototype.Qw=function(t,e){var n=this,i=0!==this.Xw.size,s=!1,r=this.Zw.get(t);if(void 0!==r)if(1===this.Zw.size)i=!1,s=!0,this.Xw.clear();else for(var o=0,a=this.Gw;o<a.length;o++)a[o].pointData.Yw.delete(t)&&(s=!0);var l=[];if(0!==e.length){!function(t){t.forEach(wr)}(e);var c=xe(mr(e)),u=cr(t.Rr());l=e.map((function(e){var i=c(e.time),r=n.Xw.get(i.So);void 0===r&&(r=Sr(i),n.Xw.set(i.So,r),s=!0);var o=u(i,r.vs,e);return r.Yw.set(t,o),o}))}i&&this.tM(),this.iM(t,l);var h=-1;if(s){var d=[];this.Xw.forEach((function(t){d.push({Vo:0,rt:t.Ve,pointData:t})})),d.sort((function(t,e){return t.rt.So-e.rt.So})),h=this.nM(d)}return this.sM(t,h,function(t,e){var n=_r(t),i=_r(e);if(void 0!==n&&void 0!==i)return{Ae:n.Kw>=i.Kw&&n.$w>=i.$w}}(this.Zw.get(t),r))},t.prototype.Yf=function(t){return this.Qw(t,[])},t.prototype.hM=function(t,e){wr(e);var n=xe(mr([e]))(e.time),i=this.Jw.get(t);if(void 0!==i&&n.So<i.So)throw new Error("Cannot update oldest data, last time=".concat(i.So,", new time=").concat(n.So));var s=this.Xw.get(n.So),r=void 0===s;void 0===s&&(s=Sr(n),this.Xw.set(n.So,s));var o=cr(t.Rr())(n,s.vs,e);s.Yw.set(t,o),this.rM(t,o);var a={Ae:or(o)};if(!r)return this.sM(t,-1,a);var l={Vo:0,rt:s.Ve,pointData:s},c=Tn(this.Gw,l.rt.So,(function(t,e){return t.rt.So<e}));this.Gw.splice(c,0,l);for(var u=c;u<this.Gw.length;++u)Mr(this.Gw[u].pointData,u);return fr(this.Gw,c),this.sM(t,c,a)},t.prototype.rM=function(t,e){var n=this.Zw.get(t);void 0===n&&(n=[],this.Zw.set(t,n));var i=0!==n.length?n[n.length-1]:null;null===i||e.rt.So>i.rt.So?or(e)&&n.push(e):or(e)?n[n.length-1]=e:n.splice(-1,1),this.Jw.set(t,e.rt)},t.prototype.iM=function(t,e){0!==e.length?(this.Zw.set(t,e.filter(or)),this.Jw.set(t,e[e.length-1].rt)):(this.Zw.delete(t),this.Jw.delete(t))},t.prototype.tM=function(){for(var t=0,e=this.Gw;t<e.length;t++){var n=e[t];0===n.pointData.Yw.size&&this.Xw.delete(n.rt.So)}},t.prototype.nM=function(t){for(var e=-1,n=0;n<this.Gw.length&&n<t.length;++n){var i=this.Gw[n],s=t[n];if(i.rt.So!==s.rt.So){e=n;break}s.Vo=i.Vo,Mr(s.pointData,n)}if(-1===e&&this.Gw.length!==t.length&&(e=Math.min(this.Gw.length,t.length)),-1===e)return-1;for(n=e;n<t.length;++n)Mr(t[n].pointData,n);return fr(t,e),this.Gw=t,e},t.prototype.eM=function(){if(0===this.Zw.size)return null;var t=0;return this.Zw.forEach((function(e){0!==e.length&&(t=Math.max(t,e[e.length-1].vs))})),t},t.prototype.sM=function(t,e,n){var i={uM:new Map,bt:{ml:this.eM()}};if(-1!==e)this.Zw.forEach((function(e,s){i.uM.set(s,{ph:e,aM:s===t?n:void 0})})),this.Zw.has(t)||i.uM.set(t,{ph:[],aM:n}),i.bt.oM=this.Gw,i.bt.lM=e;else{var s=this.Zw.get(t);i.uM.set(t,{ph:s||[],aM:n})}return i},t}();function Mr(t,e){t.vs=e,t.Yw.forEach((function(t){t.vs=e}))}var xr={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:""},Cr=function(){function t(t){this.Lr=t}return t.prototype.applyOptions=function(t){this.Lr.Pr(t)},t.prototype.options=function(){return this.Lr.W()},t.prototype.fM=function(){return this.Lr},t}();function kr(t){var e=t.overlay,n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}(t,["overlay"]);return e&&(n.priceScaleId=""),n}var Dr=function(){function t(t,e,n){this.Kn=t,this.cM=e,this.vM=n}return t.prototype.priceFormatter=function(){return this.Kn.qe()},t.prototype.priceToCoordinate=function(t){var e=this.Kn.kt();return null===e?null:this.Kn.Ct().xt(t,e.St)},t.prototype.coordinateToPrice=function(t){var e=this.Kn.kt();return null===e?null:this.Kn.Ct().qi(t,e.St)},t.prototype.barsInLogicalRange=function(t){if(null===t)return null;var e=new ms(new ps(t.from,t.to)).jo(),n=this.Kn.an();if(n.wi())return null;var i=n.ne(e.In(),1),s=n.ne(e.jn(),-1),r=xe(n.Qr()),o=xe(n.un());if(null!==i&&null!==s&&i.vs>s.vs)return{barsBefore:t.from-r,barsAfter:o-t.to};var a={barsBefore:null===i||i.vs===r?t.from-r:i.vs-r,barsAfter:null===s||s.vs===o?o-t.to:o-s.vs};return null!==i&&null!==s&&(a.from=i.rt.Co||i.rt.So,a.to=s.rt.Co||s.rt.So),a},t.prototype.setData=function(t){this.Kn.Rr(),this.cM._M(this.Kn,t)},t.prototype.update=function(t){this.Kn.Rr(),this.cM.dM(this.Kn,t)},t.prototype.setMarkers=function(t){var e=t.map((function(t){return ze(ze({},t),{time:yr(t.time)})}));this.Kn.Le(e)},t.prototype.applyOptions=function(t){var e=kr(t);this.Kn.Pr(e)},t.prototype.options=function(){return je(this.Kn.W())},t.prototype.priceScale=function(){return this.vM.priceScale(this.Kn.Ct().Ke())},t.prototype.createPriceLine=function(t){var e=Oe(je(xr),t),n=this.Kn.Ee(e);return new Cr(n)},t.prototype.removePriceLine=function(t){this.Kn.Fe(t.fM())},t.prototype.seriesType=function(){return this.Kn.Rr()},t}(),Vr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Re(e,t),e.prototype.applyOptions=function(e){ks(e),t.prototype.applyOptions.call(this,e)},e}(Dr),Ar={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},Tr={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:Ze,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},Br={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:Ze},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:ze({},Ar),leftPriceScale:ze(ze({},Ar),{visible:!1}),rightPriceScale:ze(ze({},Ar),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},watermark:Tr,localization:{locale:zs?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},Lr={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Pr={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Er={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Ir={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Rr={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},zr={color:"#26a69a",base:0},Ur={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},Nr=function(){function t(t,e){this.wM=t,this.MM=e}return t.prototype.applyOptions=function(t){this.wM.jt().Nf(this.MM,t)},t.prototype.options=function(){return this._i().W()},t.prototype.width=function(){return wn(this.MM)?this.wM.Fw("left"===this.MM?"left":"right"):0},t.prototype._i=function(){return xe(this.wM.jt().xf(this.MM)).Ct},t}(),Or=function(){function t(t,e){this.bM=new Ne,this.Go=new Ne,this.Zd=new Ne,this.pi=t,this.Da=t.bt(),this.Nw=e,this.Da.Ol().u(this.mM.bind(this)),this.Da.Vl().u(this.pM.bind(this)),this.Nw.hw().u(this.gM.bind(this))}return t.prototype.g=function(){this.Da.Ol().M(this),this.Da.Vl().M(this),this.Nw.hw().M(this),this.bM.g(),this.Go.g(),this.Zd.g()},t.prototype.scrollPosition=function(){return this.Da.Nl()},t.prototype.scrollToPosition=function(t,e){e?this.Da.Fl(t,1e3):this.pi.yn(t)},t.prototype.scrollToRealTime=function(){this.Da.El()},t.prototype.getVisibleRange=function(){var t,e,n=this.Da.cl();return null===n?null:{from:null!==(t=n.from.Co)&&void 0!==t?t:n.from.So,to:null!==(e=n.to.Co)&&void 0!==e?e:n.to.So}},t.prototype.setVisibleRange=function(t){var e={from:yr(t.from),to:yr(t.to)},n=this.Da.wl(e);this.pi.$f(n)},t.prototype.getVisibleLogicalRange=function(){var t=this.Da.fl();return null===t?null:{from:t.In(),to:t.jn()}},t.prototype.setVisibleLogicalRange=function(t){$e(t.from<=t.to,"The from index cannot be after the to index."),this.pi.$f(t)},t.prototype.resetTimeScale=function(){this.pi.pn()},t.prototype.fitContent=function(){this.pi.zl()},t.prototype.logicalToCoordinate=function(t){var e=this.pi.bt();return e.wi()?null:e.At(t)},t.prototype.coordinateToLogical=function(t){return this.Da.wi()?null:this.Da.pl(t)},t.prototype.timeToCoordinate=function(t){var e=yr(t),n=this.Da.Ze(e,!1);return null===n?null:this.Da.At(n)},t.prototype.coordinateToTime=function(t){var e,n=this.pi.bt(),i=n.pl(t),s=n.gi(i);return null===s?null:null!==(e=s.Co)&&void 0!==e?e:s.So},t.prototype.width=function(){return this.Nw.Ld().Ft},t.prototype.height=function(){return this.Nw.Ld().Ot},t.prototype.subscribeVisibleTimeRangeChange=function(t){this.bM.u(t)},t.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.bM._(t)},t.prototype.subscribeVisibleLogicalRangeChange=function(t){this.Go.u(t)},t.prototype.unsubscribeVisibleLogicalRangeChange=function(t){this.Go._(t)},t.prototype.subscribeSizeChange=function(t){this.Zd.u(t)},t.prototype.unsubscribeSizeChange=function(t){this.Zd._(t)},t.prototype.applyOptions=function(t){this.Da.Pr(t)},t.prototype.options=function(){return je(this.Da.W())},t.prototype.mM=function(){this.bM.p()&&this.bM.m(this.getVisibleRange())},t.prototype.pM=function(){this.Go.p()&&this.Go.m(this.getVisibleLogicalRange())},t.prototype.gM=function(t){this.Zd.m(t.Ft,t.Ot)},t}();function Fr(t){if(void 0!==t&&"custom"!==t.type){var e=t;void 0!==e.minMove&&void 0===e.precision&&(e.precision=function(t){if(t>=1)return 0;for(var e=0;e<8;e++){var n=Math.round(t);if(Math.abs(n-t)<1e-8)return e;t*=10}return e}(e.minMove))}}function Wr(t){return function(t){if(Ge(t.handleScale)){var e=t.handleScale;t.handleScale={axisDoubleClickReset:e,axisPressedMouseMove:{time:e,price:e},mouseWheel:e,pinch:e}}else if(void 0!==t.handleScale&&Ge(t.handleScale.axisPressedMouseMove)){var n=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:n,price:n}}var i=t.handleScroll;Ge(i)&&(t.handleScroll={horzTouchDrag:i,vertTouchDrag:i,mouseWheel:i,pressedMouseMove:i})}(t),function(t){if(t.priceScale){t.leftPriceScale=t.leftPriceScale||{},t.rightPriceScale=t.rightPriceScale||{};var e=t.priceScale.position;delete t.priceScale.position,t.leftPriceScale=Oe(t.leftPriceScale,t.priceScale),t.rightPriceScale=Oe(t.rightPriceScale,t.priceScale),"left"===e&&(t.leftPriceScale.visible=!0,t.rightPriceScale.visible=!1),"right"===e&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!0),"none"===e&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!1),t.overlayPriceScales=t.overlayPriceScales||{},void 0!==t.priceScale.invertScale&&(t.overlayPriceScales.invertScale=t.priceScale.invertScale),void 0!==t.priceScale.scaleMargins&&(t.overlayPriceScales.scaleMargins=t.priceScale.scaleMargins)}}(t),function(t){t.layout&&t.layout.backgroundColor&&!t.layout.background&&(t.layout.background={type:"solid",color:t.layout.backgroundColor})}(t),t}var Hr,Gr=function(){function t(t,e){var n=this;this.yM=new $r,this.kM=new Map,this.NM=new Map,this.xM=new Ne,this.CM=new Ne;var i=void 0===e?je(Br):Oe(je(Br),Wr(e));this.wM=new ir(t,i),this.wM.Sd().u((function(t){n.xM.p()&&n.xM.m(n.SM(t()))}),this),this.wM.Df().u((function(t){n.CM.p()&&n.CM.m(n.SM(t()))}),this);var s=this.wM.jt();this.TM=new Or(s,this.wM.Dw())}return t.prototype.remove=function(){this.wM.Sd().M(this),this.wM.Df().M(this),this.TM.g(),this.wM.g(),this.kM.clear(),this.NM.clear(),this.xM.g(),this.CM.g(),this.yM.g()},t.prototype.resize=function(t,e,n){this.wM.xw(t,e,n)},t.prototype.addAreaSeries=function(t){void 0===t&&(t={}),Fr((t=kr(t)).priceFormat);var e=Oe(je(Ur),Ir,t),n=this.wM.jt().Uf("Area",e),i=new Dr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.addBaselineSeries=function(t){void 0===t&&(t={}),Fr((t=kr(t)).priceFormat);var e=Oe(je(Ur),je(Rr),t),n=this.wM.jt().Uf("Baseline",e),i=new Dr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.addBarSeries=function(t){void 0===t&&(t={}),Fr((t=kr(t)).priceFormat);var e=Oe(je(Ur),Pr,t),n=this.wM.jt().Uf("Bar",e),i=new Dr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.addCandlestickSeries=function(t){void 0===t&&(t={}),ks(t=kr(t)),Fr(t.priceFormat);var e=Oe(je(Ur),Lr,t),n=this.wM.jt().Uf("Candlestick",e),i=new Vr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.addHistogramSeries=function(t){void 0===t&&(t={}),Fr((t=kr(t)).priceFormat);var e=Oe(je(Ur),zr,t),n=this.wM.jt().Uf("Histogram",e),i=new Dr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.addLineSeries=function(t){void 0===t&&(t={}),Fr((t=kr(t)).priceFormat);var e=Oe(je(Ur),Er,t),n=this.wM.jt().Uf("Line",e),i=new Dr(n,this,this);return this.kM.set(i,n),this.NM.set(n,i),i},t.prototype.removeSeries=function(t){var e=Me(this.kM.get(t)),n=this.yM.Yf(e);this.wM.jt().Yf(e),this.DM(n),this.kM.delete(t),this.NM.delete(e)},t.prototype._M=function(t,e){this.DM(this.yM.Qw(t,e))},t.prototype.dM=function(t,e){this.DM(this.yM.hM(t,e))},t.prototype.subscribeClick=function(t){this.xM.u(t)},t.prototype.unsubscribeClick=function(t){this.xM._(t)},t.prototype.subscribeCrosshairMove=function(t){this.CM.u(t)},t.prototype.unsubscribeCrosshairMove=function(t){this.CM._(t)},t.prototype.priceScale=function(t){return void 0===t&&(t=this.wM.jt().Kf()),new Nr(this.wM,t)},t.prototype.timeScale=function(){return this.TM},t.prototype.applyOptions=function(t){this.wM.Pr(Wr(t))},t.prototype.options=function(){return this.wM.W()},t.prototype.takeScreenshot=function(){return this.wM.Bw()},t.prototype.DM=function(t){var e=this.wM.jt();e.jf(t.bt.ml,t.bt.oM,t.bt.lM),t.uM.forEach((function(t,e){return e.Z(t.ph,t.aM)})),e.yl()},t.prototype.AM=function(t){return Me(this.NM.get(t))},t.prototype.SM=function(t){var e=this,n=new Map;t.qw.forEach((function(t,i){n.set(e.AM(i),t)}));var i=void 0===t.jw?void 0:this.AM(t.jw);return{time:t.rt&&(t.rt.Co||t.rt.So),point:t.Iw,hoveredSeries:i,hoveredMarkerId:t.Uw,seriesPrices:n}},t}();class jr{_listeners=[];_listenersOnce=[];addEventListener(t){this._listeners.push(t)}once(t){this._listenersOnce.push(t)}removeEventListener(t){this._listeners.splice(this._listeners.indexOf(t),1)}emit(t){for(const e of this._listeners)e(t);for(const e of this._listenersOnce)e(t);this._listenersOnce=[]}}function Yr(t){return window.getComputedStyle(document.body).getPropertyValue(t)}!function(t){t[t.EndCenter=0]="EndCenter",t[t.EndRight=1]="EndRight",t[t.MiddleCenter=2]="MiddleCenter"}(Hr||(Hr={}));class Xr{settings;_chart;_lineSeriesList;_timeScale;_numberOfVisiblePoints;_lineChartDataList;_onCrosshairLabelUpdated=new jr;_autoScale=!0;currentMin;currentMax;get onCrosshairLabelUpdated(){return this._onCrosshairLabelUpdated}constructor(t,e,n){this.settings=n,this._numberOfVisiblePoints=n.numberOfVisiblePoints,this._lineChartDataList=e,this._chart=function(t,e){var n;if(He(t)){var i=document.getElementById(t);$e(null!==i,"Cannot find element in DOM with id=".concat(t)),n=i}else n=t;return new Gr(n,e)}(t,{...Zr,layout:{background:{color:this.settings.backgroundColor??Yr("--bg-color"),type:xs.Solid},textColor:this.settings.textColor??Yr("--text-color")},width:t.clientWidth,height:t.clientHeight}),this._timeScale=this._chart.timeScale(),this._timeScale.applyOptions({visible:this.settings.timeVisible,tickMarkFormatter:this.settings.tickMarkFormatter}),this._lineSeriesList=this._lineChartDataList.map(((t,e)=>{const n=this._chart.addLineSeries({lastValueVisible:!1,color:t.chartSettings.lineColor,lineWidth:t.chartSettings.lineSize});return t.onRecordUpdated.addEventListener((t=>{this.updateLineSeries(e,t)})),n.setData(t.getRecords()),n})),this._chart.subscribeCrosshairMove(this.onCrosshairMove.bind(this)),this.currentMin=Math.min(...this._lineChartDataList.map((t=>t.range.minValue))),this.currentMax=Math.max(...this._lineChartDataList.map((t=>t.range.maxValue))),this.applyMinMax(this.currentMin,this.currentMax),this.resetZoom()}setAutoScale(t){this._autoScale=t,t?this._lineSeriesList.forEach((t=>t.applyOptions({autoscaleInfoProvider:t=>t()}))):this.applyMinMax(this.currentMin,this.currentMax)}getImageUri(t="image/jpeg"){return this._chart.takeScreenshot().toDataURL(t)}setChartVisible(t,e){this._lineSeriesList[t].applyOptions({visible:e})}applyMinMax(t,e){this._autoScale||(this.currentMin=t,this.currentMax=e,this._lineSeriesList.forEach((n=>n.applyOptions({autoscaleInfoProvider:()=>({priceRange:{minValue:t,maxValue:e},margins:{above:.1,below:.1}})}))))}zoomIn(){let t;t=this.settings.chartAlignment==Hr.MiddleCenter&&this.settings.visibleRange?this._timeScale.getVisibleRange():this._timeScale.getVisibleLogicalRange();const e=t.to/10;t.to=t.to-e,t.from=t.from+e,t.to<t.from||(this.settings.chartAlignment==Hr.MiddleCenter&&this.settings.visibleRange?this._timeScale.setVisibleRange(t):this._timeScale.setVisibleLogicalRange(t))}zoomOut(){let t;t=this.settings.chartAlignment==Hr.MiddleCenter&&this.settings.visibleRange?this._timeScale.getVisibleRange():this._timeScale.getVisibleLogicalRange();const e=t.to/10;t.to=t.to+e,t.from=t.from-e,this.settings.chartAlignment==Hr.MiddleCenter&&this.settings.visibleRange?this._timeScale.setVisibleRange(t):this._timeScale.setVisibleLogicalRange(t)}resetZoom(){this._chart.applyOptions({rightPriceScale:{autoScale:!0}});const t=Math.max(...this._lineChartDataList.map((t=>t.getRecords().length)));this.settings.chartAlignment==Hr.EndCenter&&this._timeScale.setVisibleLogicalRange({from:t-this._numberOfVisiblePoints/2,to:t+this._numberOfVisiblePoints/2}),this.settings.chartAlignment==Hr.EndRight&&this._timeScale.setVisibleLogicalRange({from:t-this._numberOfVisiblePoints,to:t}),this.settings.chartAlignment==Hr.MiddleCenter&&this._timeScale.fitContent(),this.applyMinMax(this.currentMin,this.currentMax)}onCrosshairMove(t){const e=t.time&&t.seriesPrices.size>0;if(!e)return void this._onCrosshairLabelUpdated.emit({visible:!1});const n=[];this._lineSeriesList.forEach(((e,i)=>{if(!e.options().visible)return;const s=t.seriesPrices.get(e);null==s||Number.isNaN(s)||n.push({value:s,color:this._lineChartDataList[i].chartSettings.lineColor,unit:this._lineChartDataList[i].unit,name:this._lineChartDataList[i].name})})),this._onCrosshairLabelUpdated.emit({visible:e,currentTime:t.time,positionX:t.point.x,positionY:t.point.y,crossed:n})}resize(t,e){this._chart.resize(t,e,!0)}updateLineSeries(t,e){const n=this._lineSeriesList[t],i=this._lineChartDataList[t].chartSettings;this.settings.fixedX&&this.resetZoom(),e.forEach((e=>e.color=this._lineChartDataList[t].chartSettings.lineColor)),n.setData(e),i.markerColor,this._lineSeriesList[t].setMarkers(e.map((t=>{return e=t.time,n=i,{...qr,time:e,color:n.markerColor,size:n.markerSize};var e,n})))}dispose(){this._chart.remove()}}const Zr={crosshair:{vertLine:{labelVisible:!1}},rightPriceScale:{scaleMargins:{top:.01,bottom:.01},autoScale:!0}},qr={time:0,position:"inBar",color:"red",shape:"circle",size:.5};function Jr(t,e,n){const i=t.slice();return i[27]=e[n],i[29]=n,i}function Kr(t,e,n){const i=t.slice();return i[30]=e[n],i[29]=n,i}function Qr(t){let e,n=t[0],i=[];for(let e=0;e<n.length;e+=1)i[e]=to(Kr(t,n,e));return{c(){e=x("div");for(let t=0;t<i.length;t+=1)i[t].c();B(e,"class","legend svelte-1p3053s")},m(t,n){_(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null)},p(t,s){if(257&s[0]){let r;for(n=t[0],r=0;r<n.length;r+=1){const o=Kr(t,n,r);i[r]?i[r].p(o,s):(i[r]=to(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){t&&$(e),M(i,t)}}}function to(t){let e,n,i,s,r,o,a,l,c=t[30].name+"";function u(...e){return t[25](t[29],...e)}return{c(){e=x("span"),n=C(c),i=k(),s=x("input"),r=k(),o=x("br"),I(e,"color",t[30].chartSettings.lineColor,!1),B(s,"class","legend__checkbox svelte-1p3053s"),B(s,"type","checkbox"),s.checked=!0},m(t,c){_(t,e,c),S(e,n),_(t,i,c),_(t,s,c),_(t,r,c),_(t,o,c),a||(l=V(s,"change",u),a=!0)},p(i,s){t=i,1&s[0]&&c!==(c=t[30].name+"")&&P(n,c),1&s[0]&&I(e,"color",t[30].chartSettings.lineColor,!1)},d(t){t&&$(e),t&&$(i),t&&$(s),t&&$(r),t&&$(o),a=!1,l()}}}function eo(t){let e,n,i,s,r,o,a,l,c,u=`${t[6].positionY??0}px`,h=t[6].crossed&&no(t),d=t[5]&&so(t);return{c(){e=x("div"),n=x("span"),n.textContent=`${Tt.chartCrosshairValues}`,i=k(),s=x("br"),r=k(),h&&h.c(),o=k(),a=x("br"),l=k(),d&&d.c(),B(e,"class","crosshair-label svelte-1p3053s"),e.hidden=c=!t[6].visible,I(e,"top",u,!1),I(e,"left",t[10],!1),I(e,"right",t[9],!1)},m(t,c){_(t,e,c),S(e,n),S(e,i),S(e,s),S(e,r),h&&h.m(e,null),S(e,o),S(e,a),S(e,l),d&&d.m(e,null)},p(t,n){t[6].crossed?h?h.p(t,n):(h=no(t),h.c(),h.m(e,o)):h&&(h.d(1),h=null),t[5]?d?d.p(t,n):(d=so(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null),64&n[0]&&c!==(c=!t[6].visible)&&(e.hidden=c),64&n[0]&&u!==(u=`${t[6].positionY??0}px`)&&I(e,"top",u,!1),1024&n[0]&&I(e,"left",t[10],!1),512&n[0]&&I(e,"right",t[9],!1)},d(t){t&&$(e),h&&h.d(),d&&d.d()}}}function no(t){let e,n=t[6].crossed,i=[];for(let e=0;e<n.length;e+=1)i[e]=io(Jr(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=D()},m(t,n){for(let e=0;e<i.length;e+=1)i[e].m(t,n);_(t,e,n)},p(t,s){if(64&s[0]){let r;for(n=t[6].crossed,r=0;r<n.length;r+=1){const o=Jr(t,n,r);i[r]?i[r].p(o,s):(i[r]=io(o),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){M(i,t),t&&$(e)}}}function io(t){let e,n,i,s,r,o,a,l=t[27].name+"",c=t[27].value+"",u=t[27].unit+"";return{c(){e=x("span"),n=C(l),i=C("\r\n                        : "),s=C(c),r=k(),o=C(u),a=x("br"),I(e,"color",t[27].color,!1)},m(t,l){_(t,e,l),S(e,n),S(e,i),S(e,s),S(e,r),S(e,o),_(t,a,l)},p(t,i){64&i[0]&&l!==(l=t[27].name+"")&&P(n,l),64&i[0]&&c!==(c=t[27].value+"")&&P(s,c),64&i[0]&&u!==(u=t[27].unit+"")&&P(o,u),64&i[0]&&I(e,"color",t[27].color,!1)},d(t){t&&$(e),t&&$(a)}}}function so(t){let e,n,i,s,r,o,a,l=Tt.chartCrosshairTime+"",c=Rt(t[6].currentTime,te.timeFormat)+"",u=zt(te.timeFormat)+"";return{c(){e=x("span"),n=C(l),i=k(),s=C(c),r=C("\r\n                    ["),o=C(u),a=C("]")},m(t,l){_(t,e,l),S(e,n),S(e,i),S(e,s),S(e,r),S(e,o),S(e,a)},p(t,e){64&e[0]&&c!==(c=Rt(t[6].currentTime,te.timeFormat)+"")&&P(s,c)},d(t){t&&$(e)}}}function ro(e){let n,i,s,r,o,a,l,c,u,h=(e[2]??"")+"",d=(e[1]??"")+"",p=e[4]&&Qr(e),f=e[3]&&eo(e);return{c(){n=x("div"),p&&p.c(),i=k(),s=x("div"),f&&f.c(),r=k(),o=x("div"),a=C(h),l=k(),c=x("div"),u=C(d),B(s,"class","chart svelte-1p3053s"),B(o,"class","chart-label chart-label-y svelte-1p3053s"),B(c,"class","chart-label chart-label-x svelte-1p3053s"),B(n,"class","chart-wrapper svelte-1p3053s")},m(t,h){_(t,n,h),p&&p.m(n,null),S(n,i),S(n,s),f&&f.m(s,null),e[26](s),S(n,r),S(n,o),S(o,a),S(n,l),S(n,c),S(c,u)},p(t,e){t[4]?p?p.p(t,e):(p=Qr(t),p.c(),p.m(n,i)):p&&(p.d(1),p=null),t[3]?f?f.p(t,e):(f=eo(t),f.c(),f.m(s,null)):f&&(f.d(1),f=null),4&e[0]&&h!==(h=(t[2]??"")+"")&&P(a,h),2&e[0]&&d!==(d=(t[1]??"")+"")&&P(u,d)},i:t,o:t,d(t){t&&$(n),p&&p.d(),f&&f.d(),e[26](null)}}}function oo(t,e,n){let i,s,r,o,a,{chartDataList:l}=e,{labelX:c}=e,{labelY:u}=e,{numberOfVisiblePoints:h}=e,{visibleRange:d}=e,{showCrosshairLabel:p=!0}=e,{showLegend:f=!0}=e,{fixedX:v=!1}=e,{autoscale:g=!0}=e,{timeVisible:m=!0}=e,{chartAlignment:y=Hr.EndCenter}=e,{currentMin:b}=e,{currentMax:w}=e,S={visible:!1};function _(t){a?.setAutoScale(t)}W((()=>{n(8,a=new Xr(o,l,{numberOfVisiblePoints:h||Math.max(...l.map((t=>t.getRecords().length))),tickMarkFormatter:t=>Rt(t,te.timeFormat),timeVisible:m,fixedX:v,visibleRange:d,chartAlignment:y})),a.onCrosshairLabelUpdated.addEventListener((t=>n(6,S=t)));const t=()=>{a.resize(o.clientWidth,o.clientHeight)};return window.addEventListener("resize",t),setTimeout(t,300),_(g),()=>{window.removeEventListener("resize",t),a.dispose(),n(8,a=null)}}));return t.$$set=t=>{"chartDataList"in t&&n(0,l=t.chartDataList),"labelX"in t&&n(1,c=t.labelX),"labelY"in t&&n(2,u=t.labelY),"numberOfVisiblePoints"in t&&n(11,h=t.numberOfVisiblePoints),"visibleRange"in t&&n(12,d=t.visibleRange),"showCrosshairLabel"in t&&n(3,p=t.showCrosshairLabel),"showLegend"in t&&n(4,f=t.showLegend),"fixedX"in t&&n(13,v=t.fixedX),"autoscale"in t&&n(14,g=t.autoscale),"timeVisible"in t&&n(5,m=t.timeVisible),"chartAlignment"in t&&n(15,y=t.chartAlignment),"currentMin"in t&&n(16,b=t.currentMin),"currentMax"in t&&n(17,w=t.currentMax)},t.$$.update=()=>{192&t.$$.dirty[0]&&n(24,i=S.positionX<o?.clientWidth/2),16777280&t.$$.dirty[0]&&n(10,s=i?S.positionX+"px":""),16777408&t.$$.dirty[0]&&n(9,r=i?"":o?.clientWidth-S.positionX+"px"),16384&t.$$.dirty[0]&&_(g),196864&t.$$.dirty[0]&&a&&b&&w&&(n(8,a.currentMin=b,a),n(8,a.currentMax=w,a),a.applyMinMax(b,w),a.resetZoom())},[l,c,u,p,f,m,S,o,a,r,s,h,d,v,g,y,b,w,function(t,e){a?.applyMinMax(t,e)},_,function(t){return a?.getImageUri(t)},function(){return a?.zoomIn()},function(){return a?.zoomOut()},function(){return a?.resetZoom()},i,(t,e)=>{a.setChartVisible(t,e.currentTarget.checked)},function(t){J[t?"unshift":"push"]((()=>{o=t,n(7,o)}))}]}class ao extends Mt{constructor(t){super(),$t(this,t,oo,ro,o,{chartDataList:0,labelX:1,labelY:2,numberOfVisiblePoints:11,visibleRange:12,showCrosshairLabel:3,showLegend:4,fixedX:13,autoscale:14,timeVisible:5,chartAlignment:15,currentMin:16,currentMax:17,applyMinMax:18,setAutoScale:19,getImageUri:20,zoomIn:21,zoomOut:22,resetZoom:23},null,[-1,-1])}get applyMinMax(){return this.$$.ctx[18]}get setAutoScale(){return this.$$.ctx[19]}get getImageUri(){return this.$$.ctx[20]}get zoomIn(){return this.$$.ctx[21]}get zoomOut(){return this.$$.ctx[22]}get resetZoom(){return this.$$.ctx[23]}}class lo{name;unit;range;get onRecordUpdated(){return this._onRecordsUpdated}_records=[];_onRecordsUpdated=new jr;_isPaused=!1;chartSettings;constructor(t,e,n,i){this.name=t,this.unit=e,this.range=n;const s=Jt[0];this.chartSettings={markerColor:s,lineColor:s,lineSize:2,markerSize:.5,...i}}addRecords(...t){const e=t.filter((t=>null!==t&&!Number.isNaN(t)&&ee(t.value,this.range.minValue,this.range.maxValue,10)));return!!e.length&&(this._records.push(...e),!1===this._isPaused&&this._onRecordsUpdated.emit(this._records),!0)}setRecords(t,e=!0){let n;return n=e?t.filter((t=>null!==t&&!Number.isNaN(t)&&ee(t.value,this.range.minValue,this.range.maxValue,10))):t,!!n.length&&(this._records=n,!1===this._isPaused&&this._onRecordsUpdated.emit(this._records),!0)}pause(){this._isPaused=!0}start(){this._isPaused=!1,this._onRecordsUpdated.emit(this._records)}getRecords(){return this._records}}function co(t){let e,n,i,r,o,a,l,u,h,d,p,f,v,g,m,y,b,w,M,C,D,A,T,L,P,E,I,R,z,N,O={labelX:`${Tt.time} [${zt(te.timeFormat)}]`,chartDataList:t[6],chartAlignment:Hr.EndRight};return r=new ao({props:O}),t[9](r),l=new qt({props:{headers:t[5],rows:t[7],keyColumn:0,valuesConverter:t[3]}}),{c(){e=x("div"),n=x("div"),i=x("div"),wt(r.$$.fragment),o=k(),a=x("div"),wt(l.$$.fragment),u=k(),h=x("div"),d=x("button"),p=x("img"),v=k(),g=x("button"),m=x("img"),w=k(),M=x("button"),C=x("img"),T=k(),L=x("button"),P=x("img"),B(i,"class","chart-wrapper svelte-1g2umti"),U(i,"hidden",t[1]!==Dt.Graphics),B(a,"class","table-wrapper"),U(a,"hidden",t[1]!==Dt.Measures),B(n,"class","measure-chart svelte-1g2umti"),c(p.src,f=t[1]===Dt.Measures?"ico_measure.png":"ico_graphics.png")||B(p,"src",f),B(d,"class","measure-graphics"),c(m.src,y="ico_zoom.png")||B(m,"src","ico_zoom.png"),B(m,"alt","zoom"),g.disabled=b=t[1]===Dt.Measures,c(C.src,D="ico_zoom_out.png")||B(C,"src","ico_zoom_out.png"),B(C,"alt","zoom_out"),M.disabled=A=t[1]===Dt.Measures,c(P.src,E="ico_zoom_in.png")||B(P,"src","ico_zoom_in.png"),B(P,"alt","zoom_in"),L.disabled=I=t[1]===Dt.Measures,B(h,"class","controls control-buttons svelte-1g2umti"),B(e,"class","work-zone svelte-1g2umti")},m(s,c){_(s,e,c),S(e,n),S(n,i),St(r,i,null),S(n,o),S(n,a),St(l,a,null),S(e,u),S(e,h),S(h,d),S(d,p),S(h,v),S(h,g),S(g,m),S(h,w),S(h,M),S(M,C),S(h,T),S(h,L),S(L,P),R=!0,z||(N=[V(d,"click",t[4]),V(g,"click",t[10]),V(M,"click",t[11]),V(L,"click",t[12])],z=!0)},p(t,e){r.$set({}),2&e&&U(i,"hidden",t[1]!==Dt.Graphics);const n={};8&e&&(n.valuesConverter=t[3]),l.$set(n),2&e&&U(a,"hidden",t[1]!==Dt.Measures),(!R||2&e&&!c(p.src,f=t[1]===Dt.Measures?"ico_measure.png":"ico_graphics.png"))&&B(p,"src",f),(!R||2&e&&b!==(b=t[1]===Dt.Measures))&&(g.disabled=b),(!R||2&e&&A!==(A=t[1]===Dt.Measures))&&(M.disabled=A),(!R||2&e&&I!==(I=t[1]===Dt.Measures))&&(L.disabled=I)},i(t){R||(pt(r.$$.fragment,t),pt(l.$$.fragment,t),R=!0)},o(t){ft(r.$$.fragment,t),ft(l.$$.fragment,t),R=!1},d(n){n&&$(e),t[9](null),_t(r),_t(l),z=!1,s(N)}}}function uo(t){let e,n;return e=new ve({props:{title:Tt.workWithSavedData_title,onBack:t[0],ico:"Logging.png",$$slots:{default:[co]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};1&n&&(i.onBack=t[0]),32782&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function ho(t,e,n){let i,{archiveValues:s={time:[],sensorsArchiveValues:[]}}=e,{onBack:r=null}=e;const o=[[Number.MIN_VALUE,Number.MAX_VALUE],...s.sensorsArchiveValues.map((t=>[t.mode.minValue,t.mode.maxValue]))];let a,l=Dt.Measures;const c=[`${Tt.time} [${zt(te.timeFormat)}]`];c.push(...s.sensorsArchiveValues.map((t=>`${Et.get(t.sensorType).name} [${t.mode.unit}]`)));const u=s.sensorsArchiveValues.map(((t,e)=>{const n=Jt[e%Jt.length],i=new lo(Et.get(t.sensorType).name,t.mode.unit,{minValue:t.mode.minValue,maxValue:t.mode.maxValue},{lineColor:n,lineSize:2,markerSize:1,markerColor:n});return i.addRecords(...t.values.map(((t,e)=>({value:t,time:s.time[e]})))),i})),h=[s.time,...s.sensorsArchiveValues.map((t=>t.values))],d=function(t){const e=t[0].length,n=Array(e);for(let i=0;i<e;i++)n[i]=t.map((t=>t[i]));return n}(h);return t.$$set=t=>{"archiveValues"in t&&n(8,s=t.archiveValues),"onBack"in t&&n(0,r=t.onBack)},n(3,i=ne(o)),[r,l,a,i,function(){n(1,l=l===Dt.Measures?Dt.Graphics:Dt.Measures)},c,u,d,s,function(t){J[t?"unshift":"push"]((()=>{a=t,n(2,a)}))},()=>{a.resetZoom},()=>{a.zoomOut},()=>{a.zoomIn}]}class po extends Mt{constructor(t){super(),$t(this,t,ho,uo,o,{archiveValues:8,onBack:0})}}const fo="sn",vo=new URL("api/lab",window.location.origin),go=new URL("https://45.147.179.96"),mo=new URL("api/lab",go);var yo;!function(t){t.SelectDevice="/select-device",t.Main="/",t.SavedData="/saved-data"}(yo||(yo={}));const bo=[];function wo(e,n=t){let i;const s=new Set;function r(t){if(o(e,t)&&(e=t,i)){const t=!bo.length;for(const t of s)t[1](),bo.push(t,e);if(t){for(let t=0;t<bo.length;t+=2)bo[t][0](bo[t+1]);bo.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(o,a=t){const l=[o,a];return s.add(l),1===s.size&&(i=n(r)||t),o(e),()=>{s.delete(l),0===s.size&&(i(),i=null)}}}}function So(e,n,i){const o=!Array.isArray(e),a=o?[e]:e,l=n.length<2;return c=e=>{let i=!1;const c=[];let h=0,d=t;const p=()=>{if(h)return;d();const i=n(o?c[0]:c,e);l?e(i):d=r(i)?i:t},f=a.map(((t,e)=>u(t,(t=>{c[e]=t,h&=~(1<<e),i&&p()}),(()=>{h|=1<<e}))));return i=!0,p(),function(){s(f),d()}},{subscribe:wo(i,c).subscribe};var c}const _o=wo(localStorage.getItem("server-url")??go.toString());class $o{static get serverApiBase(){return new URL("/api/lab/",h(_o)||go.toString()).toString()}static async IsArchiveAvailable(){try{return(await fetch(mo.toString(),{method:"HEAD"})).ok}catch(t){return console.debug(t),!1}}static async getArchiveValues(t){const e=await fetch(new URL(`get-archive/${t}`,this.serverApiBase).toString());return 0==e.ok?null:await e.json()}static async saveArchiveValues(t){const e=await fetch(new URL("upload-archive",this.serverApiBase).toString(),{body:JSON.stringify(t),method:"POST"});if(!e.ok)return null;const n=await e.text();return n?{id:n,url:new URL(`${yo.SavedData}/${n}`,this.serverApiBase).toString()}:null}}function Mo(t){let e,n,i;return{c(){e=x("button"),e.textContent=`${Tt.retry}`,B(e,"class","blue-button svelte-1ox1hfy")},m(s,o){_(s,e,o),n||(i=V(e,"click",(function(){r(t[1])&&t[1].apply(this,arguments)})),n=!0)},p(e,n){t=e},d(t){t&&$(e),n=!1,i()}}}function xo(e){let n,i,s,r,o,a=e[1]&&Mo(e);return{c(){n=x("div"),i=x("div"),s=x("span"),r=C(e[0]),o=k(),a&&a.c(),B(s,"class","svelte-1ox1hfy"),B(i,"class","m-auto message-box svelte-1ox1hfy"),B(n,"class","full flex")},m(t,e){_(t,n,e),S(n,i),S(i,s),S(s,r),S(i,o),a&&a.m(i,null)},p(t,[e]){1&e&&P(r,t[0]),t[1]?a?a.p(t,e):(a=Mo(t),a.c(),a.m(i,null)):a&&(a.d(1),a=null)},i:t,o:t,d(t){t&&$(n),a&&a.d()}}}function Co(t,e,n){let{errorMessage:i=""}=e,{retryCallback:s}=e;return t.$$set=t=>{"errorMessage"in t&&n(0,i=t.errorMessage),"retryCallback"in t&&n(1,s=t.retryCallback)},[i,s]}class ko extends Mt{constructor(t){super(),$t(this,t,Co,xo,o,{errorMessage:0,retryCallback:1})}}function Do(e){let n;return{c(){n=x("div"),n.innerHTML='<div class="loader-wrapper svelte-jen4bl"><svg class="loader svelte-jen4bl" id="L4" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 100 100" xml:space="preserve"><circle fill="#fff" stroke="none" cx="6" cy="50" r="6"><animate attributeName="opacity" dur="1s" values="0;1;0" repeatCount="indefinite" begin="0.1"></animate></circle><circle fill="#fff" stroke="none" cx="26" cy="50" r="6"><animate attributeName="opacity" dur="1s" values="0;1;0" repeatCount="indefinite" begin="0.2"></animate></circle><circle fill="#fff" stroke="none" cx="46" cy="50" r="6"><animate attributeName="opacity" dur="1s" values="0;1;0" repeatCount="indefinite" begin="0.3"></animate></circle></svg></div>',B(n,"class","full flex")},m(t,e){_(t,n,e)},p:t,i:t,o:t,d(t){t&&$(n)}}}class Vo extends Mt{constructor(t){super(),$t(this,t,null,Do,o,{})}}function Ao(e){let n,i;return n=new Vo({}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function To(t){let e,n;return e=new po({props:{archiveValues:t[0]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.archiveValues=t[0]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Bo(e){let n,i;return n=new ko({props:{errorMessage:Tt.serverNotResponding,retryCallback:e[2]}}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function Lo(t){let e,n,i,s;const r=[Bo,To,Ao],o=[];function a(t,e){return t[1]?0:t[0]?1:2}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,[s]){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function Po(t,e,n){let i,{savedDataId:s}=e,r=!1;async function o(){await $o.IsArchiveAvailable()&&s?(n(1,r=!1),n(0,i=await $o.getArchiveValues(s))):n(1,r=!0)}return W(o),t.$$set=t=>{"savedDataId"in t&&n(3,s=t.savedDataId)},[i,r,o,s]}class Eo extends Mt{constructor(t){super(),$t(this,t,Po,Lo,o,{savedDataId:3})}}const Io=t=>void 0===t,Ro=t=>"number"==typeof t;function zo(){let t=0;return()=>t++}const Uo="undefined"==typeof window;function No(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}const Oo=t=>`@@svnav-ctx__${t}`,Fo=Oo("LOCATION"),Wo=Oo("ROUTER"),Ho=Oo("ROUTE"),Go=Oo("ROUTE_PARAMS"),jo=Oo("FOCUS_ELEM"),Yo=/^:(.+)/,Xo=(t,e)=>t.substr(0,e.length)===e,Zo=t=>"*"===t[0],qo=t=>t.replace(/(^\/+|\/+$)/g,"");function Jo(t,e=!1){const n=qo(t).split("/");return e?n.filter(Boolean):n}const Ko=(t,e)=>t+(e?`?${e}`:""),Qo=t=>`/${qo(t)}`;function ta(...t){const e=t.map((t=>Jo(t,!0).join("/"))).join("/");return Qo(e)}const ea={1:"Link",2:"Route",3:"Router",4:"useFocus",5:"useLocation",6:"useMatch",7:"useNavigate",8:"useParams",9:"useResolvable",10:"useResolve",11:"navigate"},na=t=>ea[t];function ia(t,e,n,i){const s=n&&function(t,e){let n;return 2===t?n=e.path?`path="${e.path}"`:"default":1===t?n=`to="${e.to}"`:3===t&&(n=`basepath="${e.basepath||""}"`),`<${na(t)} ${n||""} />`}(i||t,n),r=s?`\n\nOccurred in: ${s}`:"",o=na(t);return`<${o}> ${"function"==typeof e?e(o):e}${r}`}const sa=t=>(...e)=>t(ia(...e)),ra=sa((t=>{throw new Error(t)})),oa=sa(console.warn);function aa(t,e){return{route:t,score:t.default?0:Jo(t.fullPath).reduce(((t,e)=>{let n=t;return n+=4,(t=>""===t)(e)?n+=1:(t=>Yo.test(t))(e)?n+=2:Zo(e)?n-=5:n+=3,n}),0),index:e}}function la(t,e){let n,i;const[s]=e.split("?"),r=Jo(s),o=""===r[0],a=function(t){return t.map(aa).sort(((t,e)=>t.score<e.score?1:t.score>e.score?-1:t.index-e.index))}(t);for(let t=0,s=a.length;t<s;t++){const{route:s}=a[t];let l=!1;const c={},u=t=>({...s,params:c,uri:t});if(s.default){i=u(e);continue}const h=Jo(s.fullPath),d=Math.max(r.length,h.length);let p=0;for(;p<d;p++){const t=h[p],e=r[p];if(!Io(t)&&Zo(t)){const e="*"===t?"*":t.slice(1);c[e]=r.slice(p).map(decodeURIComponent).join("/");break}if(Io(e)){l=!0;break}const n=Yo.exec(t);if(n&&!o){const t=decodeURIComponent(e);c[n[1]]=t}else if(t!==e){l=!0;break}}if(!l){n=u(ta(...r.slice(0,p)));break}}return n||i||null}function ca(t,e){return la([t],e)}function ua(t,e){const{pathname:n,hash:i="",search:s="",state:r}=t,o=Jo(e,!0),a=Jo(n,!0);for(;o.length;)o[0]!==a[0]&&ra(3,`Invalid state: All locations must begin with the basepath "${e}", found "${n}"`),o.shift(),a.shift();return{pathname:ta(...a),hash:i,search:s,state:r}}const ha=t=>1===t.length?"":t;function da(t){const e=t.indexOf("?"),n=t.indexOf("#"),i=-1!==e,s=-1!==n,r=s?ha(t.substr(n)):"",o=s?t.substr(0,n):t,a=i?ha(o.substr(e)):"";return{pathname:i?o.substr(0,e):o,search:a,hash:r}}function pa(t,e,n){return ta(n,function(t,e){if(Xo(t,"/"))return t;const[n,i]=t.split("?"),[s]=e.split("?"),r=Jo(n),o=Jo(s);if(""===r[0])return Ko(s,i);if(!Xo(r[0],".")){const t=o.concat(r).join("/");return Ko(("/"===s?"":"/")+t,i)}const a=o.concat(r),l=[];return a.forEach((t=>{".."===t?l.pop():"."!==t&&l.push(t)})),Ko(`/${l.join("/")}`,i)}(t,e))}function fa(t,e){const n=Qo(t.replace(/\*.*$/,""));const i=Jo(n,!0),s=ca({fullPath:n},ta(...Jo(e,!0).slice(0,i.length)));return s&&s.uri}const va="POP";function ga(t){return{...t.location,pathname:encodeURI(decodeURI(t.location.pathname)),state:t.history.state,_key:t.history.state&&t.history.state._key||"initial"}}function ma(t,e){return{...da(e),state:t}}const ya=!(Uo||!window.document||!window.document.createElement),ba=!Uo&&"null"===window.location.origin,wa=function(t){let e=[],n=ga(t),i=va;const s=(t=e)=>t.forEach((t=>t({location:n,action:i})));return{get location(){return n},listen(r){e.push(r);s([r]);const o=No(t,"popstate",(()=>{n=ga(t),i=va,s([r])}));return()=>{o(),e=e.filter((t=>t!==r))}},navigate(e,r){const{state:o={},replace:a=!1}=r||{};if(i=a?"REPLACE":"PUSH",Ro(e))r&&oa(11,"Navigation options (state or replace) are not supported, when passing a number as the first argument to navigate. They are ignored."),i=va,t.history.go(e);else{const n={...o,_key:Math.random().toString(36).substring(2)};try{t.history[a?"replaceState":"pushState"](n,"",e)}catch(n){t.location[a?"replace":"assign"](e)}}n=ga(t),s()}}}(ya&&!ba?window:function(t="/"){let e=0,n=[ma(null,t)];return{get entries(){return n},get location(){return n[e]},addEventListener(){},removeEventListener(){},history:{get state(){return n[e].state},pushState(t,i,s){e++,n=n.slice(0,e),n.push(ma(t,s))},replaceState(t,i,s){n[e]=ma(t,s)},go(t){const i=e+t;i<0||i>n.length-1||(e=i)}}}}());let Sa=null,_a=!0;function $a(t){(!Sa||t.level>Sa.level||t.level===Sa.level&&function(t,e){const n=document.querySelectorAll("[data-svnav-router]");for(let i=0;i<n.length;i++){const s=n[i],r=Number(s.dataset.svnavRouter);if(r===t)return!0;if(r===e)return!1}return!1}(t.routerId,Sa.routerId))&&(Sa=t)}function Ma(t){if(!t)return!1;const e="tabindex";try{if(!t.hasAttribute(e)){let n;t.setAttribute(e,"-1");const i=()=>{t.removeAttribute(e),n()};n=No(t,"blur",i)}return t.focus(),document.activeElement===t}catch(t){return!1}}function xa(t,e){return Number(t.dataset.svnavRouteEnd)===e}function Ca(t,e=document){return e.querySelector(t)}function ka(t){Promise.resolve(h(t.focusElement)).then((e=>{const n=e||function(t){let e=Ca(`[data-svnav-route-start="${t}"]`).nextElementSibling;for(;!xa(e,t);){if(/^H[1-6]$/i.test(e.tagName))return e;const t=Ca("h1,h2,h3,h4,h5,h6",e);if(t)return t;e=e.nextElementSibling}return null}(t.id);n||oa(3,'Could not find an element to focus. You should always render a header for accessibility reasons, or set a custom focus element via the "useFocus" hook. If you don\'t want this Route or Router to manage focus, pass "primary={false}" to it.',t,2);Ma(n)||Ma(document.documentElement)}))}const Da=(t,e,n)=>(i,s)=>(nt(),tt).then((()=>{if(Sa&&!_a){if(i&&ka(Sa.route),t.announcements&&s){const{path:i,fullPath:s,meta:r,params:o,uri:a}=Sa.route,l=t.createAnnouncement({path:i,fullPath:s,meta:r,params:o,uri:a},h(n));Promise.resolve(l).then((t=>{e.set(t)}))}Sa=null}else _a=!1}));function Va(t){let e,n,i,s,r;const o=t[20].default,a=p(o,t,t[19],null);let l=t[2]&&t[4]&&t[1].announcements&&function(t){let e,n;return{c(){e=x("div"),n=C(t[0]),B(e,"role","status"),B(e,"aria-atomic","true"),B(e,"aria-live","polite"),B(e,"style","position:fixed;top:-1px;left:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;")},m(t,i){_(t,e,i),S(e,n)},p(t,e){1&e[0]&&P(n,t[0])},d(t){t&&$(e)}}}(t);return{c(){e=x("div"),n=k(),a&&a.c(),i=k(),l&&l.c(),s=D(),I(e,"display","none"),B(e,"aria-hidden","true"),B(e,"data-svnav-router",t[3])},m(t,o){_(t,e,o),_(t,n,o),a&&a.m(t,o),_(t,i,o),l&&l.m(t,o),_(t,s,o),r=!0},p(t,e){a&&a.p&&(!r||524288&e[0])&&g(a,o,t,t[19],r?v(o,t[19],e,null):m(t[19]),null),t[2]&&t[4]&&t[1].announcements&&l.p(t,e)},i(t){r||(pt(a,t),r=!0)},o(t){ft(a,t),r=!1},d(t){t&&$(e),t&&$(n),a&&a.d(t),t&&$(i),l&&l.d(t),t&&$(s)}}}const Aa=zo(),Ta="/";function Ba(t,e,n){let i,s,r,o,a,{$$slots:l={},$$scope:c}=e,{basepath:u=Ta}=e,{url:h=null}=e,{history:p=wa}=e,{primary:f=!0}=e,{a11y:v={}}=e;const g={createAnnouncement:t=>`Navigated to ${t.uri}`,announcements:!0,...v},m=u,y=Qo(u),b=X(Fo),w=X(Wo),S=!b,_=Aa(),$=f&&!(w&&!w.manageFocus),M=wo("");d(t,M,(t=>n(0,a=t)));const x=wo([]);d(t,x,(t=>n(18,o=t)));const C=wo(null);d(t,C,(t=>n(16,s=t)));let k=!1;const D=S?0:w.level+1,V=S?wo(ua(Uo?da(h):p.location,y)):b;d(t,V,(t=>n(15,i=t)));const A=wo(i);d(t,A,(t=>n(17,r=t)));const T=Da(g,M,V),B=t=>e=>e.filter((e=>e.id!==t));return S||u===Ta||oa(3,'Only top-level Routers can have a "basepath" prop. It is ignored.',{basepath:u}),S&&(W((()=>p.listen((t=>{const e=ua(t.location,y);A.set(i),V.set(e)})))),Y(Fo,V)),Y(Wo,{activeRoute:C,registerRoute:function(t){if(Uo){if(k)return;const e=ca(t,i.pathname);if(e)return k=!0,e}else x.update((e=>{const n=B(t.id)(e);return n.push(t),n}))},unregisterRoute:function(t){x.update(B(t))},manageFocus:$,level:D,id:_,history:S?p:w.history,basepath:S?y:w.basepath}),t.$$set=t=>{"basepath"in t&&n(10,u=t.basepath),"url"in t&&n(11,h=t.url),"history"in t&&n(12,p=t.history),"primary"in t&&n(13,f=t.primary),"a11y"in t&&n(14,v=t.a11y),"$$scope"in t&&n(19,c=t.$$scope)},t.$$.update=()=>{if(1024&t.$$.dirty[0]&&u!==m&&oa(3,'You cannot change the "basepath" prop. It is ignored.'),294912&t.$$.dirty[0]){const t=la(o,i.pathname);C.set(t)}if(163840&t.$$.dirty[0]&&S){const t=!!i.hash,e=!t&&$,n=!t||i.pathname!==r.pathname;T(e,n)}65536&t.$$.dirty[0]&&$&&s&&s.primary&&$a({level:D,routerId:_,route:s})},[a,g,S,_,$,M,x,C,V,A,u,h,p,f,v,i,s,r,o,c,l]}var La=class extends Mt{constructor(t){super(),$t(this,t,Ba,Va,o,{basepath:10,url:11,history:12,primary:13,a11y:14},null,[-1,-1])}};function Pa(t,e,n=Wo,i=3){X(n)||ra(t,(t=>`You cannot use ${t} outside of a ${na(i)}.`),e)}function Ea(){return Pa(5),(t=>{const{subscribe:e}=X(t);return{subscribe:e}})(Fo)}function Ia(){const t=X(Ho);return t?So(t,(t=>t.base)):wo("/")}function Ra(){Pa(7);const t=function(){Pa(10);const t=Ia(),{basepath:e}=X(Wo);return n=>pa(n,h(t),e)}(),{navigate:e}=function(){const{history:t}=X(Wo);return t}();return(n,i)=>{const s=Ro(n)?n:t(n);return e(s,i)}}const za=t=>({params:16&t,location:8&t}),Ua=t=>({params:Uo?h(t[9]):t[4],location:t[3],navigate:t[10]});function Na(t){let e,n;return e=new La({props:{primary:t[1],$$slots:{default:[Wa]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.primary=t[1]),264217&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Oa(t){let e;const n=t[17].default,i=p(n,t,t[18],Ua);return{c(){i&&i.c()},m(t,n){i&&i.m(t,n),e=!0},p(t,s){i&&i.p&&(!e||262168&s)&&g(i,n,t,t[18],e?v(n,t[18],s,za):m(t[18]),Ua)},i(t){e||(pt(i,t),e=!0)},o(t){ft(i,t),e=!1},d(t){i&&i.d(t)}}}function Fa(t){let n,i,s;const r=[{location:t[3]},{navigate:t[10]},Uo?h(t[9]):t[4],t[11]];var o=t[0];function a(t){let n={};for(let t=0;t<r.length;t+=1)n=e(n,r[t]);return{props:n}}return o&&(n=new o(a())),{c(){n&&wt(n.$$.fragment),i=D()},m(t,e){n&&St(n,t,e),_(t,i,e),s=!0},p(t,e){const s=3608&e?function(t,e){const n={},i={},s={$$scope:1};let r=t.length;for(;r--;){const o=t[r],a=e[r];if(a){for(const t in o)t in a||(i[t]=1);for(const t in a)s[t]||(n[t]=a[t],s[t]=1);t[r]=a}else for(const t in o)s[t]=1}for(const t in i)t in n||(n[t]=void 0);return n}(r,[8&e&&{location:t[3]},1024&e&&{navigate:t[10]},528&e&&yt(Uo?h(t[9]):t[4]),2048&e&&yt(t[11])]):{};if(o!==(o=t[0])){if(n){ht();const t=n;ft(t.$$.fragment,1,0,(()=>{_t(t,1)})),dt()}o?(n=new o(a()),wt(n.$$.fragment),pt(n.$$.fragment,1),St(n,i.parentNode,i)):n=null}else o&&n.$set(s)},i(t){s||(n&&pt(n.$$.fragment,t),s=!0)},o(t){n&&ft(n.$$.fragment,t),s=!1},d(t){t&&$(i),n&&_t(n,t)}}}function Wa(t){let e,n,i,s;const r=[Fa,Oa],o=[];function a(t,e){return null!==t[0]?0:1}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,s){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function Ha(t){let e,n,i,s,r,o=t[2]&&Na(t);return{c(){e=x("div"),n=k(),o&&o.c(),i=k(),s=x("div"),I(e,"display","none"),B(e,"aria-hidden","true"),B(e,"data-svnav-route-start",t[5]),I(s,"display","none"),B(s,"aria-hidden","true"),B(s,"data-svnav-route-end",t[5])},m(t,a){_(t,e,a),_(t,n,a),o&&o.m(t,a),_(t,i,a),_(t,s,a),r=!0},p(t,[e]){t[2]?o?(o.p(t,e),4&e&&pt(o,1)):(o=Na(t),o.c(),pt(o,1),o.m(i.parentNode,i)):o&&(ht(),ft(o,1,1,(()=>{o=null})),dt())},i(t){r||(pt(o),r=!0)},o(t){ft(o),r=!1},d(t){t&&$(e),t&&$(n),o&&o.d(t),t&&$(i),t&&$(s)}}}const Ga=zo();function ja(t,n,i){let s;const r=["path","component","meta","primary"];let o,a,l,c,u=b(n,r),{$$slots:h={},$$scope:p}=n,{path:f=""}=n,{component:v=null}=n,{meta:g={}}=n,{primary:m=!0}=n;Pa(2,n);const w=Ga(),{registerRoute:S,unregisterRoute:_,activeRoute:$}=X(Wo);d(t,$,(t=>i(15,o=t)));const M=Ia();d(t,M,(t=>i(16,l=t)));const x=Ea();d(t,x,(t=>i(3,a=t)));const C=wo(null);let k;const D=wo(),V=wo({});d(t,V,(t=>i(4,c=t))),Y(Ho,D),Y(Go,V),Y(jo,C);const A=Ra();return Uo||G((()=>_(w))),t.$$set=t=>{i(23,n=e(e({},n),y(t))),i(11,u=b(n,r)),"path"in t&&i(12,f=t.path),"component"in t&&i(0,v=t.component),"meta"in t&&i(13,g=t.meta),"primary"in t&&i(1,m=t.primary),"$$scope"in t&&i(18,p=t.$$scope)},t.$$.update=()=>{if(77834&t.$$.dirty){const t=""===f,e=ta(l,f),n={id:w,path:f,meta:g,default:t,fullPath:t?"":e,base:t?l:fa(e,a.pathname),primary:m,focusElement:C};D.set(n),i(14,k=S(n))}if(49152&t.$$.dirty&&i(2,s=!!(k||o&&o.id===w)),49156&t.$$.dirty&&s){const{params:t}=k||o;V.set(t)}},n=y(n),[v,m,s,a,c,w,$,M,x,V,A,u,f,g,k,o,l,h,p]}var Ya=class extends Mt{constructor(t){super(),$t(this,t,ja,Ha,o,{path:12,component:0,meta:13,primary:1})}};function Xa(e){let n;return{c(){n=x("div"),n.innerHTML='<img src="logo.png" alt="" class="svelte-1ij4rl8"/>',B(n,"class","logo-wrapper svelte-1ij4rl8")},m(t,e){_(t,n,e)},p:t,i:t,o:t,d(t){t&&$(n)}}}class Za extends Mt{constructor(t){super(),$t(this,t,null,Xa,o,{})}}function qa(t){let e,n,i;const s=t[2].default,r=p(s,t,t[1],null);return{c(){e=x("div"),n=x("div"),r&&r.c(),B(n,"class","modal svelte-1d5o9oy"),B(e,"class","modal-wrapper svelte-1d5o9oy")},m(s,o){_(s,e,o),S(e,n),r&&r.m(n,null),t[3](n),i=!0},p(t,[e]){r&&r.p&&(!i||2&e)&&g(r,s,t,t[1],i?v(s,t[1],e,null):m(t[1]),null)},i(t){i||(pt(r,t),i=!0)},o(t){ft(r,t),i=!1},d(n){n&&$(e),r&&r.d(n),t[3](null)}}}function Ja(t,e,n){let i,s,{$$slots:r={},$$scope:o}=e;return W((()=>{s=document.createElement("div"),s.className="portal",document.body.appendChild(s),s.appendChild(i)})),G((()=>{document.body.removeChild(s)})),t.$$set=t=>{"$$scope"in t&&n(1,o=t.$$scope)},[i,o,r,function(t){J[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}class Ka extends Mt{constructor(t){super(),$t(this,t,Ja,qa,o,{})}}function Qa(t,e,n){const i=t.slice();return i[3]=e[n],i}function tl(t){let e,n,i,s,o=t[3].text+"";return{c(){e=x("button"),n=C(o)},m(o,a){_(o,e,a),S(e,n),i||(s=V(e,"click",(function(){r(t[3].onClick)&&t[3].onClick.apply(this,arguments)})),i=!0)},p(e,i){t=e,4&i&&o!==(o=t[3].text+"")&&P(n,o)},d(t){t&&$(e),i=!1,s()}}}function el(t){let e,n,i,s,r,o,a=t[2],l=[];for(let e=0;e<a.length;e+=1)l[e]=tl(Qa(t,a,e));return{c(){e=x("div"),n=x("span"),i=k(),s=x("span"),r=k(),o=x("div");for(let t=0;t<l.length;t+=1)l[t].c();B(n,"class","header svelte-1tgoahr"),B(s,"class","text svelte-1tgoahr"),B(o,"class","row modal-buttons"),B(e,"class","column wrapper svelte-1tgoahr")},m(a,c){_(a,e,c),S(e,n),n.innerHTML=t[0],S(e,i),S(e,s),s.innerHTML=t[1],S(e,r),S(e,o);for(let t=0;t<l.length;t+=1)l[t].m(o,null)},p(t,e){if(1&e&&(n.innerHTML=t[0]),2&e&&(s.innerHTML=t[1]),4&e){let n;for(a=t[2],n=0;n<a.length;n+=1){const i=Qa(t,a,n);l[n]?l[n].p(i,e):(l[n]=tl(i),l[n].c(),l[n].m(o,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=a.length}},d(t){t&&$(e),M(l,t)}}}function nl(t){let e,n;return e=new Ka({props:{$$slots:{default:[el]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};71&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function il(t,e,n){let{header:i=""}=e,{body:s=""}=e,{buttons:r=[]}=e;return t.$$set=t=>{"header"in t&&n(0,i=t.header),"body"in t&&n(1,s=t.body),"buttons"in t&&n(2,r=t.buttons)},[i,s,r]}class sl extends Mt{constructor(t){super(),$t(this,t,il,nl,o,{header:0,body:1,buttons:2})}}function rl(t){let e,n;return e=new sl({props:{header:t[0],body:t[1],buttons:t[2]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};1&n&&(i.header=t[0]),2&n&&(i.body=t[1]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function ol(t,e,n){let{header:i=""}=e,{body:s=""}=e,{onDismiss:r}=e;const o=[{text:"ok",onClick:r}];return t.$$set=t=>{"header"in t&&n(0,i=t.header),"body"in t&&n(1,s=t.body),"onDismiss"in t&&n(3,r=t.onDismiss)},[i,s,o,r]}class al extends Mt{constructor(t){super(),$t(this,t,ol,rl,o,{header:0,body:1,onDismiss:3})}}class ll{static toSingle(t,e){return new DataView(t).getFloat32(e,!0)}static toInt16(t,e){return new DataView(t).getInt16(e,!0)}static toUInt16(t,e){return new DataView(t).getUint16(e,!0)}static toUInt32(t,e){return new DataView(t).getUint32(e,!0)}static toInt32(t,e){return new DataView(t).getInt32(e,!0)}static toByte(t,e){return new Uint8Array(t)[e]}static getBytes(t){const e=new Uint8Array(4);for(let n=0;n<4;n++)e[n]=t>>8*n&255;return e}static getStringBytes(t){const e=Array.from({length:t.length},((e,n)=>t.charCodeAt(n)));return new Uint8Array(e)}static getFloatBytes(t){const e=new Float32Array([t]);return new Uint8Array(e.buffer)}}const cl=new Uint16Array([0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448]);function ul(t){let e=new Uint8Array(t),n=65535;for(const t of e)n=n>>>8^cl[255&(n^t)];return new Uint8Array([255&n,n>>8&255])}var hl,dl,pl,fl,vl,gl;!function(t){t[t.None=0]="None",t[t.Phys=1]="Phys",t[t.Chem=2]="Chem",t[t.Eco=3]="Eco",t[t.Bio=4]="Bio",t[t.Phsl=5]="Phsl"}(hl||(hl={})),function(t){t[t.None=0]="None",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Blue=4]="Blue",t[t.IR=8]="IR"}(dl||(dl={})),function(t){t[t.data_exchange=16]="data_exchange",t[t.raw_data_exchange=31]="raw_data_exchange",t[t.get_HW_Config=49]="get_HW_Config",t[t.get_HW_Config_BT=50]="get_HW_Config_BT",t[t.get_UserData=65]="get_UserData",t[t.get_ArchiveBt=34]="get_ArchiveBt",t[t.set_UserData=64]="set_UserData",t[t.proto_msgType_getInfo=0]="proto_msgType_getInfo",t[t.archive_Control=32]="archive_Control",t[t.getArchive=33]="getArchive",t[t.proto_msgType_bootloader_get_FW_Cfg=131]="proto_msgType_bootloader_get_FW_Cfg",t[t.HID_getData_buffer=18]="HID_getData_buffer"}(pl||(pl={}));class ml{static userDataLength=108;static unsupportMsg=255;static startByte=170;static startByteOscil=187;static getInfo(){const t=this.createBaseMessage(6,pl.proto_msgType_getInfo);return this.addCrc(t),t}static _readSensorValuesMessage;static getSensorValues(){if(null!=this._readSensorValuesMessage)return this._readSensorValuesMessage;const t=this.createBaseMessage(6,pl.data_exchange);return this.addCrc(t),this._readSensorValuesMessage=t,this._readSensorValuesMessage}static oscilloscopeStart(){return new Uint8Array([this.startByteOscil,2,1])}static oscilloscopeStop(){return new Uint8Array([this.startByteOscil,2,2])}static oscilloscopeRange(t){return new Uint8Array([this.startByteOscil,3,t])}static oscilloscopeInfo(t){return new Uint8Array([this.startByteOscil,1])}static oscilloscopeAttenuator(t,e){return new Uint8Array([this.startByteOscil,4,t,e])}static getFirmwareConfig(){const t=this.createBaseMessage(6,pl.proto_msgType_bootloader_get_FW_Cfg);return this.addCrc(t),t}static setScales(t,e){const n=this.createBaseMessage(8,pl.data_exchange);t!==Bt.AccelerometerXSensor&&t!==Bt.AccelerometerYSensor&&t!==Bt.AccelerometerZSensor||(n[4]=e),t===Bt.ConductivitySensor&&(n[5]=e>0?1:0);const i=this.calculateMessageCrc16(n);return n[6]=i[0],n[7]=i[1],n}static getFactorySettings(){const t=this.createBaseMessage(6,pl.get_HW_Config);return this.addCrc(t),t}static getUserSettings(t,e){const n=this.createBaseMessage(8,pl.get_UserData);return n[4]=t,n[5]=e,this.addCrc(n),n}static setUserSettingsUsb(t,e,n,i){let s,r=0;switch(t){case At.ColorimeterSensor:case At.UsbLightSensor:s=[n];break;case At.WristSensor:case At.SoilMoistureSensor:case At.CoSensor:s=[e,n];break;case At.OpticalDensitySensor:switch(i){case 0:r=8,s=[n];break;case 1:r=4,s=[n];break;case 2:r=0,s=[n];break;case 3:r=12,s=[e,n]}}const o=this.createBaseMessage(9+4*s.length,pl.set_UserData);o[4]=r,o[5]=4*s.length,o[6]=1;for(let t=0;t<s.length;t++)o.set(ll.getFloatBytes(s[t]),4*t+7);return this.addCrc(o),o}static setUserSettings(t,e){let n;switch(e){case hl.Phys:n=[[t[Bt.TempSensor][0].k,0],[t[Bt.TempSensor][0].delta,4],[t[Bt.TeslameterSensor][0].k,12],[t[Bt.TeslameterSensor][0].delta,16],[t[Bt.VoltmeterSensor][0].k,24],[t[Bt.VoltmeterSensor][0].delta,28],[t[Bt.AmmeterSensor][0].k,36],[t[Bt.AmmeterSensor][0].delta,40],[t[Bt.AbsolutePressureSensor][0].delta,48]];break;case hl.Chem:n=[[t[Bt.PhSensor][0].k,0],[t[Bt.PhSensor][0].delta,4],[t[Bt.TempSensor][0].k,12],[t[Bt.TempSensor][0].delta,16],[t[Bt.ConductivitySensor][1].k,24],[t[Bt.ConductivitySensor][1].delta,28],[t[Bt.ConductivitySensor][2].k,32],[t[Bt.ConductivitySensor][2].delta,36],[t[Bt.ConductivitySensor][3].k,40],[t[Bt.ConductivitySensor][3].delta,44]];break;case hl.Eco:n=[[t[Bt.TempSensor][0].k,0],[t[Bt.TempSensor][0].delta,4],[t[Bt.ConductivitySensor][1].k,8],[t[Bt.ConductivitySensor][1].delta,12],[t[Bt.ConductivitySensor][2].k,16],[t[Bt.ConductivitySensor][2].delta,20],[t[Bt.ConductivitySensor][3].k,24],[t[Bt.ConductivitySensor][3].delta,28],[t[Bt.TempOutsideSensor][0].delta,32],[t[Bt.HumiditySensor][0].delta,36],[t[Bt.LightSensor][0].delta,40],[t[Bt.IonomerSensor][0].k,44],[t[Bt.IonomerSensor][0].delta,48],[t[Bt.IonomerSensor][1].calibrationValues.length,52],...t[Bt.IonomerSensor][1].calibrationValues.flatMap(((t,e)=>[[t.delta,56+8*e],[t.value,60+8*e]])),[t[Bt.IonomerSensor][2].calibrationValues.length,96],...t[Bt.IonomerSensor][2].calibrationValues.flatMap(((t,e)=>[[t.delta,100+8*e],[t.value,104+8*e]]))];break;case hl.Bio:n=[[t[Bt.PhSensor][0].k,0],[t[Bt.PhSensor][0].delta,4],[t[Bt.TempSensor][0].k,12],[t[Bt.TempSensor][0].delta,16],[t[Bt.TempOutsideSensor][0].delta,24],[t[Bt.HumiditySensor][0].delta,28],[t[Bt.LightSensor][0].delta,32]];break;case hl.Phsl:n=[[t[Bt.BodyTempSensor][0].k,0],[t[Bt.BodyTempSensor][0].delta,4]]}const i=function(t,e){const n=[];for(let i=0;i<t.length;i+=e)n.push(t.slice(i,i+e));return n}(n,5),s=[];for(let t=0;t<i.length;t++){const e=i[t],n=e[e.length-1][1]-e[0][1]+4,r=this.createBaseMessage(n+9),o=e[0][1];r[3]=pl.set_UserData,r[4]=o,r[5]=n,r[6]=1;for(const[t,n]of e)r.set(ll.getFloatBytes(t),n-o+7);this.addCrc(r),s.push(r)}return s}static startLogging(t,e){const n=this.createBaseMessage(36,pl.archive_Control);n.set(ll.getBytes(e),4),n[8]=t;const i=new Date;return n[11]=i.getFullYear()-2e3,n[12]=i.getMonth(),n[13]=i.getDay(),n[14]=i.getHours(),n[15]=i.getMinutes(),n[16]=i.getSeconds(),this.addCrc(n),n}static getValuesHidSensors(t){let e;return void 0!==t?(e=this.createBaseMessage(7,pl.data_exchange),e[4]=t):e=this.createBaseMessage(6,pl.data_exchange),this.addCrc(e),e}static getValuesComSensors(t){const e=this.createBaseMessage(18,pl.raw_data_exchange);return e.set(ll.getFloatBytes(100*(t&dl.Red)),4),e.set(ll.getFloatBytes(100*(t&dl.Green)),8),e.set(ll.getFloatBytes(100*(t&dl.Blue)),12),this.addCrc(e),e}static getArchivePartial(t,e,n){const i=this.createBaseMessage(9,pl.get_ArchiveBt);return i[4]=t,i[5]=e,i[6]=n,this.addCrc(i),i}static getArchiveInfo(){const t=this.createBaseMessage(6,pl.archive_Control);return this.addCrc(t),t}static getFactorySettingsPartial(t,e){const n=this.createBaseMessage(10,pl.get_HW_Config_BT);return n.set(ll.getBytes(t),4),n.set(ll.getBytes(e),6),this.addCrc(n),n}static _getBufferCache;static getBuffer(){if(this._getBufferCache)return this._getBufferCache;const t=this.createBaseMessage(6,pl.HID_getData_buffer);return this.addCrc(t),this._getBufferCache=t}static createBaseMessage(t,e=0){const n=new Uint8Array(t);return n[0]=this.startByte,n.set(ll.getBytes(n.length),1),n[3]=e,n}static calculateMessageCrc16(t){return ul(t.slice(0,t.byteLength-2))}static addCrc(t){const e=ul(t.slice(0,t.byteLength-2));t[t.length-2]=e[0],t[t.length-1]=e[1]}static checkAnswer(t){if(t.byteLength<6)return!1;const e=new Uint8Array(t),n=this.calculateMessageCrc16(e);return n[0]==e[e.byteLength-2]&&n[1]==e[e.byteLength-1]}}function yl(){return new Proxy({},new bl)}class bl{get(t,e,n){return Reflect.get(t,e,n)||Reflect.set(t,e,[]),Reflect.get(t,e,n)}}class wl{intervalMs;stringRepresentation;static Intervals=[new wl(10,`100 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(20,`50 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(25,`40 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(50,`20 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(100,`10 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(200,`5 ${Tt.dots_many}/${Tt.seconds_short}`),new wl(250,`4 ${Tt.dots_few}/${Tt.seconds_short}`),new wl(500,`2 ${Tt.dots_few}/${Tt.seconds_short}`),new wl(1e3,`1 ${Tt.dots_one}/${Tt.seconds_short}`),new wl(6e4,`1 ${Tt.dots_one}/${Tt.minutes_short}`),new wl(6e5,`1 ${Tt.dots_one}/10 ${Tt.minutes_short}`),new wl(9e5,`1 ${Tt.dots_one}/15 ${Tt.minutes_short}`),new wl(18e5,`1 ${Tt.dots_one}/30 ${Tt.minutes_short}`),new wl(36e5,`1 ${Tt.dots_one}/${Tt.hours_short}`)];constructor(t,e){this.intervalMs=t,this.stringRepresentation=e}}class Sl{intervalMs;stringRepresentation;static Intervals=[new Sl(250,`4 ${Tt.dots_few}/${Tt.seconds_short}`),new Sl(500,`2 ${Tt.dots_few}/${Tt.seconds_short}`),new Sl(1e3,`1 ${Tt.dots_one}/${Tt.seconds_short}`),new Sl(6e4,`1 ${Tt.dots_one}/${Tt.minutes_short}`),new Sl(6e5,`1 ${Tt.dots_one}/10 ${Tt.minutes_short}`),new Sl(9e5,`1 ${Tt.dots_one}/15 ${Tt.minutes_short}`),new Sl(18e5,`1 ${Tt.dots_one}/30 ${Tt.minutes_short}`),new Sl(36e5,`1 ${Tt.dots_one}/${Tt.hours_short}`)];constructor(t,e){this.intervalMs=t,this.stringRepresentation=e}}!function(t){t[t.Empty=0]="Empty",t[t.Processing=1]="Processing",t[t.Loading=2]="Loading",t[t.Done=3]="Done"}(fl||(fl={}));class _l extends Error{innerError;constructor(t=null,e=Tt.parseError){super(e),this.innerError=t}}class $l{static parseLabType(t){return new Uint8Array(t)[10]}static parseFactorySettings(t){try{const e=yl();return e[Bt.ArterialPressureSensor][0]={k:ll.toSingle(t,0),delta:0},e[Bt.PhSensor][0]={k:1e3*ll.toSingle(t,0),delta:ll.toSingle(t,4)},e[Bt.VoltmeterSensor][0]={k:ll.toSingle(t,0),delta:ll.toSingle(t,4)},e[Bt.AmmeterSensor][0]={k:ll.toSingle(t,8),delta:ll.toSingle(t,12)},e[Bt.TempSensor][0]={k:ll.toSingle(t,16),delta:ll.toSingle(t,20)},e[Bt.TempSensor][1]={k:ll.toSingle(t,24),delta:ll.toSingle(t,28)},e[Bt.TeslameterSensor][0]={k:ll.toSingle(t,36),delta:ll.toSingle(t,40)},e[Bt.ConductivitySensor][0]={k:1,delta:0},e[Bt.ConductivitySensor][1]={k:ll.toSingle(t,36),delta:ll.toSingle(t,40)},e[Bt.ConductivitySensor][2]={k:ll.toSingle(t,60),delta:ll.toSingle(t,64)},e[Bt.ConductivitySensor][3]={k:ll.toSingle(t,68),delta:ll.toSingle(t,72)},e[Bt.LightSensor][0]={k:1,delta:ll.toSingle(t,44)},e[Bt.HumiditySensor][0]={k:1,delta:ll.toSingle(t,48)},e[Bt.TempOutsideSensor][0]={k:1,delta:ll.toSingle(t,52)},e[Bt.AbsolutePressureSensor][0]={k:.1,delta:ll.toSingle(t,56)},e[Bt.IonomerSensor]=Array(3).fill({k:1e3*ll.toSingle(t,0),delta:ll.toSingle(t,4)}),e[Bt.BodyTempSensor][0]={k:ll.toSingle(t,16),delta:ll.toSingle(t,20)},e}catch(t){throw new _l(t)}}static parseSpecialSettings(t){return{pointT:ll.toSingle(t,32)}}static parseUserSettings(t,e){const n=yl();let i;try{switch(t){case hl.Phys:n[Bt.TempSensor][0]={k:ll.toSingle(e,0),delta:ll.toSingle(e,4)},n[Bt.TeslameterSensor][0]={k:ll.toSingle(e,12),delta:ll.toSingle(e,16)},n[Bt.VoltmeterSensor][0]={k:ll.toSingle(e,24),delta:ll.toSingle(e,28)},n[Bt.AmmeterSensor][0]={k:ll.toSingle(e,36),delta:ll.toSingle(e,40)},n[Bt.AbsolutePressureSensor][0]={k:1,delta:ll.toSingle(e,48)};break;case hl.Chem:n[Bt.PhSensor][0]={k:ll.toSingle(e,0),delta:ll.toSingle(e,4)},n[Bt.TempSensor][0]={k:ll.toSingle(e,12),delta:ll.toSingle(e,16)},n[Bt.ConductivitySensor][0]={k:0,delta:0},n[Bt.ConductivitySensor][1]={k:ll.toSingle(e,24),delta:ll.toSingle(e,28)},n[Bt.ConductivitySensor][2]={k:ll.toSingle(e,32),delta:ll.toSingle(e,46)},n[Bt.ConductivitySensor][3]={k:ll.toSingle(e,40),delta:ll.toSingle(e,44)};break;case hl.Eco:n[Bt.TempSensor][0]={k:ll.toSingle(e,0),delta:ll.toSingle(e,4)},n[Bt.ConductivitySensor][0]={k:0,delta:0},n[Bt.ConductivitySensor][1]={k:ll.toSingle(e,8),delta:ll.toSingle(e,12)},n[Bt.ConductivitySensor][2]={k:ll.toSingle(e,16),delta:ll.toSingle(e,20)},n[Bt.ConductivitySensor][3]={k:ll.toSingle(e,24),delta:ll.toSingle(e,28)},n[Bt.TempOutsideSensor][0]={k:1,delta:ll.toSingle(e,32)},n[Bt.HumiditySensor][0]={k:1,delta:ll.toSingle(e,36)},n[Bt.LightSensor][0]={k:1,delta:ll.toSingle(e,40)},n[Bt.PhSensor][0]={k:ll.toSingle(e,44),delta:ll.toSingle(e,48)},n[Bt.IonomerSensor][0]={k:ll.toSingle(e,0),delta:ll.toSingle(e,4)},i=ll.toSingle(e,52),n[Bt.IonomerSensor][1]={calibrationValues:[{delta:ll.toSingle(e,56),value:ll.toSingle(e,60)},{delta:ll.toSingle(e,64),value:ll.toSingle(e,68)},{delta:ll.toSingle(e,72),value:ll.toSingle(e,76)},{delta:ll.toSingle(e,80),value:ll.toSingle(e,84)},{delta:ll.toSingle(e,88),value:ll.toSingle(e,92)}].slice(0,i)},i=ll.toSingle(e,96),n[Bt.IonomerSensor][2]={calibrationValues:[{delta:ll.toSingle(e,100),value:ll.toSingle(e,104)},{delta:ll.toSingle(e,108),value:ll.toSingle(e,112)},{delta:ll.toSingle(e,116),value:ll.toSingle(e,120)},{delta:ll.toSingle(e,124),value:ll.toSingle(e,128)},{delta:ll.toSingle(e,132),value:ll.toSingle(e,136)}].slice(0,i)};break;case hl.Bio:n[Bt.TempSensor][0]={k:ll.toSingle(e,12),delta:ll.toSingle(e,16)},n[Bt.TempOutsideSensor][0]={k:1,delta:ll.toSingle(e,24)},n[Bt.HumiditySensor][0]={k:1,delta:ll.toSingle(e,28)},n[Bt.LightSensor][0]={k:1,delta:ll.toSingle(e,32)};break;case hl.Phsl:n[Bt.BodyTempSensor][0]={k:ll.toSingle(e,0),delta:ll.toSingle(e,4)}}return n}catch(t){throw new _l(t)}}static parseRawValues(t){try{const e=new Uint8Array(t);let n=e[52]+(e[53]<<8)+(e[54]<<16);n>8388608&&(n-=16777215);const i={};return i[Bt.TempOutsideSensor]=ll.toInt16(t,8),i[Bt.IonomerSensor]=ll.toSingle(t,12)-ll.toSingle(t,16),i[Bt.PhSensor]=i[Bt.VoltmeterSensor]=i[Bt.CoSensor]=i[Bt.ColorimeterSensor]=i[Bt.SoilMoistureSensor]=ll.toSingle(t,12),i[Bt.AmmeterSensor]=ll.toSingle(t,16),i[Bt.TempSensor]=ll.toSingle(t,20),i[Bt.BodyTempSensor]=ll.toSingle(t,20),i[Bt.TeslameterSensor]=i[Bt.ConductivitySensor]=ll.toSingle(t,24),i[Bt.OpticalDensitySensor]=[ll.toSingle(t,12),ll.toSingle(t,16)],i[Bt.AccelerometerXSensor]=ll.toInt16(t,28),i[Bt.AccelerometerYSensor]=ll.toInt16(t,30),i[Bt.AccelerometerZSensor]=ll.toInt16(t,32),i[Bt.LightSensor]=i[Bt.UsbLightSensor]=ll.toSingle(t,36),i[Bt.HumiditySensor]=.01*ll.toUInt16(t,40),i[Bt.TempOutsideSensor]=.01*ll.toUInt16(t,42),i[Bt.AbsolutePressureSensor]=ll.toSingle(t,44),i[Bt.WristSensor]=n,i[Bt.ArterialPressureSensor]=[ll.toSingle(t,12),e[5],e[40],e[41],e[42],e[43]],i[Bt.PulseSensor]=ll.toSingle(t,16),i[Bt.RespirationRateSensor]=ll.toSingle(t,24),i}catch(t){throw new _l(t)}}static parseSensorsModes(t){const e=new Uint8Array(t);return{[Bt.ConductivitySensor]:e[1],[Bt.AccelerometerXSensor]:e[34],[Bt.AccelerometerYSensor]:e[34],[Bt.AccelerometerZSensor]:e[34]}}static parseArchiveInfo(t){try{const e=new Uint8Array(t),n=ll.toUInt32(t,4),i=wl.Intervals.find((t=>t.intervalMs==n))??wl.Intervals[0],s=e[8],r=e[9];let o=null;return r!=fl.Empty&&(o=new Date(e[11]+2e3,e[12],e[13],e[14],e[15],e[16])),{loggingInterval:i,recordsCount:s,startRecordDate:o,archiveStatus:r}}catch(t){throw new _l(t)}}static parseRawValuesLegacy(t){try{return{[Bt.ColorimeterSensor]:ll.toSingle(t,12)}}catch(t){throw new _l(t)}}static parseSerialNumber(t){return ll.toUInt32(t,4)}static parseFactorySettingsUsb(t){const e=yl();return e[Bt.WristSensor][0]=e[Bt.CoSensor][0]=e[Bt.SoilMoistureSensor][0]={k:ll.toSingle(t,0),delta:ll.toSingle(t,4)},e[Bt.ColorimeterSensor][0]=e[Bt.UsbLightSensor][0]={k:1,delta:ll.toSingle(t,0)},e[Bt.SoundSensor][0]=e[Bt.CardioSensor][0]={k:ll.toSingle(t,0),delta:0},e[Bt.OpticalDensitySensor][0]={k:1,delta:ll.toSingle(t,8)},e[Bt.OpticalDensitySensor][1]={k:1,delta:ll.toSingle(t,4)},e[Bt.OpticalDensitySensor][2]={k:1,delta:ll.toSingle(t,0)},e[Bt.OpticalDensitySensor][3]={k:ll.toSingle(t,12),delta:ll.toSingle(t,16)},e}static parseUserSettingsUsb(t){const e=yl();return e[Bt.ColorimeterSensor][0]=e[Bt.UsbLightSensor][0]={k:1,delta:ll.toSingle(t,0)},e[Bt.WristSensor][0]=e[Bt.CoSensor][0]=e[Bt.SoilMoistureSensor][0]={k:ll.toSingle(t,0),delta:ll.toSingle(t,4)},e[Bt.OpticalDensitySensor][2]={k:1,delta:ll.toSingle(t,0)},e[Bt.OpticalDensitySensor][1]={k:1,delta:ll.toSingle(t,4)},e[Bt.OpticalDensitySensor][0]={k:1,delta:ll.toSingle(t,8)},e[Bt.OpticalDensitySensor][3]={k:ll.toSingle(t,12),delta:0},e[Bt.OpticalDensitySensor][3]={k:1,delta:ll.toSingle(t,16)},e}}function Ml(t,e,n){return Math.max(t,Math.min(n,e))}function xl(t,e){if(null===t)return t;const n=Math.pow(10,e);return Math.floor(t*n)/n}class Cl extends Error{innerError;constructor(t=null,e=Tt.readSettingsError){super(e),this.innerError=t}}class kl extends Error{innerError;constructor(t=null,e=Tt.notResponseError){super(e),this.innerError=t}}class Dl extends Error{innerError;constructor(t=null,e=Tt.deviceDisconnectedMessage){super(e),this.innerError=t}}class Vl{_queue=[];awaiter=null;push(...t){this._queue.push(...t),this.awaiter?.()}async asyncPop(){return 0==this._queue.length&&await new Promise((t=>this.awaiter=t)),this._queue.shift()}}class Al{data;resolve;reject;awaiter;constructor(t){this.data=t,this.awaiter=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Tl{_requestAdapter;get onDisconnect(){return this._onDisconnect}_onDisconnect=new jr;isDisposed=!1;_latestSensorValues={};_queue=new Vl;ArchiveRecordSize=64;MaxReadPerRequest=11;constructor(t){this._requestAdapter=t,this.startProcessor(),t.onDisconnect.addEventListener((t=>{this._onDisconnect.emit(new Dl)}))}async getFactorySettings(){try{const t=await this.makeQuery(ml.getFactorySettings());return{calibrationValues:$l.parseFactorySettings(t.slice(36)),specialSettings:$l.parseSpecialSettings(t.slice(36))}}catch(t){throw new Cl(t)}}async getLabType(){const t=await this.makeQuery(ml.getInfo());return $l.parseLabType(t)}async getSerialNumber(){try{const t=await this.makeQuery(ml.getFirmwareConfig());return $l.parseSerialNumber(t)}catch(t){throw new Cl(t)}}async getUserSettings(t){try{const e=await this.makeQuery(ml.getUserSettings(0,140));return $l.parseUserSettings(t,e.slice(6))}catch(t){throw new Cl(t)}}async setUserSettings(t,e){const n=ml.setUserSettings(t,e);for(const t of n)try{if(!await this.makeQuery(t))return!1}catch(t){return console.debug(t),!1}return!0}async getSensorModes(){try{const t=await this.makeQuery(ml.getSensorValues());return this._latestSensorValues=$l.parseSensorsModes(t.slice(4))}catch(t){throw new Cl(t)}}async setSensorModes(t,e){try{const n=ml.setScales(t,e);return await this.makeQuery(n),!0}catch(t){throw new Cl(t)}}async getSensorsValuesAsync(){try{const t=await this.makeQuery(ml.getSensorValues());return this._latestSensorValues=$l.parseRawValues(t.slice(4))}catch(t){return{}}}makeQuery(t){const e=new Al(t);return this._queue.push(e),e.awaiter}async startProcessor(){for(;!this.isDisposed;){const t=await this._queue.asyncPop();try{const e=await this._requestAdapter.sendCommand(t.data);t.resolve(e)}catch(e){t.reject(new kl(e))}}}async startOfflineLogging(t,e){try{const n=ml.startLogging(t,e);return await this.makeQuery(n),!0}catch(t){return console.debug(t),!1}}async getArchiveValues(t){const e=await this.getArchiveInfo();if(!e||null==e.recordsCount||e.archiveStatus!=fl.Done)return null;const n=[];for(let i=0;i<e.recordsCount;i++){let e=0;const s=new Uint8Array(this.ArchiveRecordSize);for(;e<this.ArchiveRecordSize;){if(1==t?.cancelled)return null;const n=Ml(this.ArchiveRecordSize-e,0,this.MaxReadPerRequest),r=ml.getArchivePartial(i,e,n),o=await this.makeQuery(r);if(null==o||o.byteLength<10)return null;const a=new Uint8Array(o,7,o.byteLength-9);s.set(a,e),e+=a.length}n.push($l.parseRawValues(s.buffer))}return n}async getArchiveInfo(){try{const t=await this.makeQuery(ml.getArchiveInfo());return $l.parseArchiveInfo(t)}catch(t){return null}}async dispose(){this.isDisposed=!0,await this._requestAdapter.dispose()}}class Bl{isVisibleInMenu=!0;get userSettings(){return[]}chartSettings={markerColor:Jt[0],markerSize:1,lineColor:Jt[0],lineSize:3}}!function(t){t[t.DashboardSidebar=1]="DashboardSidebar",t[t.DashboardChart=16]="DashboardChart",t[t.MainScreen=256]="MainScreen"}(vl||(vl={}));class Ll extends Bl{get displayType(){return vl.DashboardChart|vl.DashboardSidebar|vl.MainScreen}get mode(){return this.modes[this._selectedModeIndex]}get unit(){return this.mode.unit}get modeIndex(){return this._selectedModeIndex}inSensorPack=!1;_selectedModeIndex=0;async setMode(t){if(!this.modes.includes(t))throw RangeError();await this.applyMode(t),this._selectedModeIndex=this.modes.indexOf(t)}_setModeIndex(t){this._selectedModeIndex=Ml(0,this.modes.length-1,t)}interval=Sl.Intervals[0];async calibrate(t){return!1}async resetCalibration(){return this.calibrate({calibrationValues:[],delta:0,k:1})}applyMode(t){return Promise.resolve()}}class Pl extends Ll{lab;sensorType;modes;name;ico;get calibrationSteps(){return this.mode.calibrationSteps??this._defaultCalibrationSteps}get userSettings(){return this.lab.userSettings[this.sensorType]}get onDisconnect(){return this.lab.onDisconnect}async disconnect(){await this.lab.disconnect()}get accuracy(){return this.mode.accuracy}get isStarted(){return!!this.lab.isStarted}async applyMode(t){await this.lab.setMode(this.sensorType,this.modes.indexOf(t))}_defaultCalibrationSteps;last10Values=[];constructor(t,e){super(),this.lab=t,this.sensorType=e;const n=Et.get(e);if(this.modes=n.modes,this.name=n.name,this.ico=n.ico,this._defaultCalibrationSteps=n.calibrationSteps,this._setModeIndex(t.getModeIdx(e)),0===this.modes.length)throw new Error("modes must contains a least one element")}getLatestValue(){const t=this.lab.getConvertedValue(this.sensorType);if(isNaN(t)||null==t)return null;if(this.sensorType===Vt.ConductivitySensor){10===this.last10Values.length&&this.last10Values.shift(),this.last10Values.push(t);const e=this.last10Values.reduce(((t,e)=>t+e))/this.last10Values.length;return console.debug(this.last10Values,e),xl(e,this.accuracy)}return xl(t,this.accuracy)}getLatestRawValue(){const t=this.lab.getValueWithFactory(this.lab.getRawValue(this.sensorType),this.sensorType);return isNaN(t)||null==t?null:t}calibrate(t){return this.lab.calibrate(this.sensorType,t)}resetCalibration(){return this.lab.calibrate(this.sensorType,{k:1,delta:0,calibrationValues:[]})}async start(){await this.lab.start(this.interval.intervalMs)}async stop(){await this.lab.stop()}dispose(){}}!function(t){t[t.M2G=0]="M2G",t[t.M4G=1]="M4G",t[t.M8G=2]="M8G",t[t.M16G=3]="M16G"}(gl||(gl={}));class El{static convert(t){const{sensorType:e,modeIndex:n,value:i,factorySettings:s,specialSettings:r,userSettings:o}={modeIndex:0,...t};let a=i;const l=s?.[Bt.ConductivitySensor][n],c=o?.[Bt.ConductivitySensor][n];switch(e){case Bt.ArterialPressureSensor:const t=i.slice();return t[0]*=s[e][0].k,t[1]*=s[e][0].k,t[2]*=s[e][0].k,t;case Bt.IonomerSensor:return 0==n?Rl(i instanceof Array?i[0]:i,s?.[e]?.[n],o?.[e]?.[n]):zl(i,s?.[e]?.[n],o?.[e]?.[n]);case Bt.TempSensor:return Rl(i,s?.[e]?.[i<r.pointT?0:1],o?.[e]?.[n]);case Bt.ConductivitySensor:return l&&(a=this.convertConductivitySensorFactory(a,c,r.k2)),c&&(a=this.convertConductivitySensorUser(a,c)),a;case Bt.AccelerometerXSensor:case Bt.AccelerometerYSensor:case Bt.AccelerometerZSensor:return s?i*El.getAccelerometerMultiplier(n):i;default:return Rl(i instanceof Array?i[0]:i,s?.[e]?.[n],o?.[e]?.[n])}}static convertConductivitySensorFactory(t,e,n){const i=Rl(t,e)*(n??1);return i<-1.2339723?-3e3*(i- -1.262104667)/.02813236699999999+2e4:i>=-1.2339723&&i<-1.178375667?-2e3*(i- -1.2339723)/.05559663299999995+17e3:i>=-1.178375667&&i<-1.123638333?-2e3*(i- -1.178375667)/.05473733400000014+15e3:i>=-1.123638333&&i<-1.036873?-2e3*(i- -1.123638333)/.086765333+13e3:i>=-1.036873&&i<-.900607667?-3e3*(i- -1.036873)/.136265333+11e3:i>=-.900607667&&i<-.739906?-2e3*(i- -.900607667)/.160701667+8e3:i>=-.739906&&i<-.51767?-2e3*(i- -.739906)/.222236+6e3:i>=-.51767&&i<.08760833?-2e3*(i- -.51767)/.60527833+4e3:i>=.08760833&&i<.676329?-1e3*(i-.08760833)/.58872067+2e3:i>=.676329&&i<1.2176703?-444*(i-.676329)/.5413413300000001+1e3:i>=1.21767033&&i<1.75265733?-336*(i-1.21767033)/.5349869999999999+556:i>=1.75265733&&i<1.988951?-120*(i-1.75265733)/.23629367+220:i>=1.988951&&i<2.06281233?-45*(i-1.988951)/.07386132999999995+100:i>=2.06281233&&i<=2.49?-55*(i-2.06281233)/(2.49-2.06281233)+55:void 0}static convertConductivitySensorUser(t,e){const n=t+(t*e.k+e.delta);return Math.max(0,n)}static getAccelerometerMultiplier(t){switch(t){case gl.M2G:return 64e-6;case gl.M4G:return 128e-6;case gl.M8G:return 256e-6;case gl.M16G:return 512e-6;default:return 64e-6}}}const Il={k:1,delta:0};function Rl(t,e,n){const i={...Il,...e},s={...Il,...n};return(t*i.k+i.delta)*s.k+s.delta}function zl(t,e,n){let i,s=Rl(t,e);if(!n)return s;if(n.calibrationValues.forEach((({delta:t},e)=>{t<=s&&(i=e)})),void 0===i||i===n.calibrationValues.length-1)return null;const r=n.calibrationValues[i],o=n.calibrationValues[i-1],a=(o.value-r.value)/(o.delta-r.delta),l=r.value-a*r.delta;return s*a+l}var Ul=function(t,e){return Ul=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Ul(t,e)};function Nl(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ul(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Ol(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fl(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(t){s={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function Wl(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}function Hl(t){return"function"==typeof t}function Gl(t){var e=t((function(t){Error.call(t),t.stack=(new Error).stack}));return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var jl=Gl((function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}));function Yl(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Xl=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var t,e,n,i,s;if(!this.closed){this.closed=!0;var r=this._parentage;if(r)if(this._parentage=null,Array.isArray(r))try{for(var o=Ol(r),a=o.next();!a.done;a=o.next()){a.value.remove(this)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}else r.remove(this);var l=this.initialTeardown;if(Hl(l))try{l()}catch(t){s=t instanceof jl?t.errors:[t]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=Ol(c),h=u.next();!h.done;h=u.next()){var d=h.value;try{Jl(d)}catch(t){s=null!=s?s:[],t instanceof jl?s=Wl(Wl([],Fl(s)),Fl(t.errors)):s.push(t)}}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}if(s)throw new jl(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)Jl(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&Yl(e,t)},t.prototype.remove=function(e){var n=this._finalizers;n&&Yl(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Zl=Xl.EMPTY;function ql(t){return t instanceof Xl||t&&"closed"in t&&Hl(t.remove)&&Hl(t.add)&&Hl(t.unsubscribe)}function Jl(t){Hl(t)?t():t.unsubscribe()}var Kl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ql={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=Ql.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,Wl([t,e],Fl(n))):setTimeout.apply(void 0,Wl([t,e],Fl(n)))},clearTimeout:function(t){var e=Ql.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function tc(){}var ec=null;function nc(t){if(Kl.useDeprecatedSynchronousErrorHandling){var e=!ec;if(e&&(ec={errorThrown:!1,error:null}),t(),e){var n=ec,i=n.errorThrown,s=n.error;if(ec=null,i)throw s}}else t()}var ic=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,ql(e)&&e.add(n)):n.destination=cc,n}return Nl(e,t),e.create=function(t,e,n){return new ac(t,e,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Xl),sc=Function.prototype.bind;function rc(t,e){return sc.call(t,e)}var oc=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){lc(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){lc(t)}else lc(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){lc(t)}},t}(),ac=function(t){function e(e,n,i){var s,r,o=t.call(this)||this;Hl(e)||!e?s={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:o&&Kl.useDeprecatedNextContext?((r=Object.create(e)).unsubscribe=function(){return o.unsubscribe()},s={next:e.next&&rc(e.next,r),error:e.error&&rc(e.error,r),complete:e.complete&&rc(e.complete,r)}):s=e;return o.destination=new oc(s),o}return Nl(e,t),e}(ic);function lc(t){var e;e=t,Ql.setTimeout((function(){throw e}))}var cc={closed:!0,next:tc,error:function(t){throw t},complete:tc},uc="function"==typeof Symbol&&Symbol.observable||"@@observable";function hc(t){return t}function dc(t){return 0===t.length?hc:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var pc=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i,s=this,r=(i=t)&&i instanceof ic||function(t){return t&&Hl(t.next)&&Hl(t.error)&&Hl(t.complete)}(i)&&ql(i)?t:new ac(t,e,n);return nc((function(){var t=s,e=t.operator,n=t.source;r.add(e?e.call(r,n):n?s._subscribe(r):s._trySubscribe(r))})),r},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=fc(e))((function(e,i){var s=new ac({next:function(e){try{t(e)}catch(t){i(t),s.unsubscribe()}},error:i,complete:e});n.subscribe(s)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[uc]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dc(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=fc(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function fc(t){var e;return null!==(e=null!=t?t:Kl.Promise)&&void 0!==e?e:Promise}function vc(t){return function(e){if(function(t){return Hl(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}var gc=function(t){function e(e,n,i,s,r,o){var a=t.call(this,e)||this;return a.onFinalize=r,a.shouldUnsubscribe=o,a._next=n?function(t){try{n(t)}catch(t){e.error(t)}}:t.prototype._next,a._error=s?function(t){try{s(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return Nl(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(ic),mc=Gl((function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),yc=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Nl(e,t),e.prototype.lift=function(t){var e=new bc(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new mc},e.prototype.next=function(t){var e=this;nc((function(){var n,i;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var s=Ol(e.currentObservers),r=s.next();!r.done;r=s.next()){r.value.next(t)}}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}))},e.prototype.error=function(t){var e=this;nc((function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var n=e.observers;n.length;)n.shift().error(t)}}))},e.prototype.complete=function(){var t=this;nc((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}}))},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,n=this,i=n.hasError,s=n.isStopped,r=n.observers;return i||s?Zl:(this.currentObservers=null,r.push(t),new Xl((function(){e.currentObservers=null,Yl(r,t)})))},e.prototype._checkFinalizedStatuses=function(t){var e=this,n=e.hasError,i=e.thrownError,s=e.isStopped;n?t.error(i):s&&t.complete()},e.prototype.asObservable=function(){var t=new pc;return t.source=this,t},e.create=function(t,e){return new bc(t,e)},e}(pc),bc=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return Nl(e,t),e.prototype.next=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)},e.prototype.error=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:Zl},e}(yc),wc=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return Nl(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){var t=this,e=t.hasError,n=t.thrownError,i=t._value;if(e)throw n;return this._throwIfClosed(),i},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(yc),Sc={now:function(){return(Sc.delegate||Date).now()},delegate:void 0},_c=function(t){function e(e,n){return t.call(this)||this}return Nl(e,t),e.prototype.schedule=function(t,e){return this},e}(Xl),$c={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=$c.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,Wl([t,e],Fl(n))):setInterval.apply(void 0,Wl([t,e],Fl(n)))},clearInterval:function(t){var e=$c.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},Mc=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return Nl(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),$c.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return e;$c.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n,i=!1;try{this.work(t)}catch(t){i=!0,n=t||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},e.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Yl(i,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(_c),xc=function(){function t(e,n){void 0===n&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(n,e)},t.now=Sc.now,t}(),Cc=new(function(t){function e(e,n){void 0===n&&(n=xc.now);var i=t.call(this,e,n)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return Nl(e,t),e.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(xc))(Mc),kc=Cc;function Dc(t,e){return vc((function(n,i){var s,r,o,a=0;n.subscribe(new gc(i,(function(n){i.next(t.call(e,n,a++))}),s,r,o))}))}function Vc(t,e,n){void 0===t&&(t=0),void 0===n&&(n=kc);var i,s=-1;return null!=e&&((i=e)&&Hl(i.schedule)?n=e:s=e),new pc((function(e){var i=function(t){return t instanceof Date&&!isNaN(t)}(t)?+t-n.now():t;i<0&&(i=0);var r=0;return n.schedule((function(){e.closed||(e.next(r++),0<=s?this.schedule(void 0,s):e.complete())}),i)}))}function Ac(t,e){return void 0===t&&(t=0),void 0===e&&(e=Cc),t<0&&(t=0),Vc(t,t,e)}class Tc extends Bl{lab;name;ico;unit;get currentValue(){return this._currentValue}get onDisconnect(){return this.lab.onDisconnect}get sensorType(){return Bt.ArterialPressureSensor}get displayType(){return vl.DashboardSidebar}_currentValue=new wc(Bc);constructor(t){super(),this.lab=t;const e=Et.get(this.sensorType);this.name=e.name,this.ico=e.ico,this.unit=e.modes[0].unit,this.lab.onUpdate.addEventListener((()=>{const t=this.parseRawValue(this.lab.getValueWithFactory(this.lab.getRawValue(this.sensorType),this.sensorType));this._currentValue.next(t)}))}parseRawValue(t){const[e,n,i,s,r,o]=t,a={...Bc};return a.error=Tc.getErrorById(o),a.status=Tc.getStatusById(r),a.absMmHg=Math.max(xl(e,1),0),6===o&&(a.pulse=xl(n,0),a.sys=xl(i,0),a.dia=xl(s,0)),a}static getStatusById(t){switch(t){case 0:return Tt.AP_status_0;case 1:return Tt.AP_status_1;case 2:return Tt.AP_status_2;case 3:return Tt.AP_status_3;case 4:return Tt.AP_status_4;case 5:return Tt.AP_status_5;case 6:return Tt.AP_status_6}}static getErrorById(t){switch(t){case 0:return Tt.AP_error_0;case 1:return Tt.AP_error_1;case 2:return Tt.AP_error_2;case 3:return Tt.AP_error_3;case 4:return Tt.AP_error_4;case 5:return Tt.AP_error_5;case 6:return Tt.AP_error_6}}async disconnect(){await this.lab.disconnect()}}const Bc={absMmHg:null,pulse:null,sys:null,dia:null,status:Tc.getStatusById(0),error:Tc.getErrorById(0)};class Lc{requestAdapter;_connectionType;_socket;labService;get onUpdate(){return this._onUpdate}get isStarted(){return!!this._updateIntervalSub}get isConnected(){return this.requestAdapter.isConnected}get ico(){return"Multisensor.png"}get connectionType(){return this._connectionType}get userSettings(){return this._userSettings}name;selectedModes;_onUpdate=new jr;_rawValues=null;_sensors=[];_factorySettings;_userSettings;specialSettings;_currentUpdateInterval;_updateIntervalSub=null;_wasStarted=!1;onDisconnect;constructor(t,e){this.requestAdapter=t,this._connectionType=e,this.reconnect(t)}get adapter(){return this.requestAdapter}reconnect(t){this.requestAdapter=t,this.labService=new Tl(t),this.labService.onDisconnect.addEventListener((async()=>{this._rawValues=null;const t=this.isStarted||this._wasStarted;await this.stop(),this._wasStarted=t})),this._wasStarted&&this.start(this._currentUpdateInterval),this.onDisconnect=this.labService.onDisconnect}async connect(){await this.requestAdapter.connect()}async init(){const t=await this.labService.getFactorySettings();if(this._userSettings=await this.labService.getUserSettings(this.labType),console.debug(t,this._userSettings),!t||!this._userSettings)throw new Cl;return this._factorySettings=t.calibrationValues,this.specialSettings=t.specialSettings,this.selectedModes=await this.labService.getSensorModes(),this._sensors=this.availableSensors.map((t=>t===Bt.ArterialPressureSensor?new Tc(this):new Pl(this,t))),this.name=function(t){switch(t){case hl.None:return"NONE";case hl.Phys:return"PHYS";case hl.Chem:return"CHEM";case hl.Eco:return"ECO";case hl.Bio:return"BIO";case hl.Phsl:return"PHSL"}}(this.labType)+" #"+await this.getSerialNumber(),this}async getSerialNumber(){return await this.labService.getSerialNumber()}getSensors(){return this._sensors}getConvertedValue(t){return this.convertValue(this.getRawValue(t),t)}convertValue(t,e){if(null===t)return null;let n=this.getValueWithFactory(t,e);return El.convert({sensorType:e,value:n,modeIndex:this.getModeIdx(e),specialSettings:this.specialSettings,userSettings:this._userSettings})}getRawValue(t){return this._rawValues&&this._rawValues[t]}getValueWithFactory(t,e){return El.convert({sensorType:e,value:t,modeIndex:this.getModeIdx(e),factorySettings:this._factorySettings,specialSettings:{...this.specialSettings,k2:this._userSettings[Bt.ConductivitySensor][this.getModeIdx(Bt.ConductivitySensor)]?.k2}})}async updateValues(){this._rawValues=await this.labService.getSensorsValuesAsync(),this._onUpdate.emit()}async setMode(t,e){await this.labService.setSensorModes(t,e),this.selectedModes[t]=e}getModeIdx(t){return this.selectedModes[t]||0}async start(t){this._updateIntervalSub&&this._currentUpdateInterval<=t||(this.stop(),this._currentUpdateInterval=t,this._updateIntervalSub=Ac(this._currentUpdateInterval).subscribe((()=>this.updateValues())))}async stop(){this._updateIntervalSub?.unsubscribe(),this._updateIntervalSub=null,this._wasStarted=!1}async disconnect(){this._socket?.close(),await this.requestAdapter.disconnect()}async calibrate(t,e){const n=this._userSettings[t][this.getModeIdx(t)];this._userSettings[t][this.getModeIdx(t)]={...n,...e};const i=await this.labService.setUserSettings(this._userSettings,this.labType);return i||(this._userSettings[t][this.getModeIdx(t)]=n),i}async startOfflineLogging(t,e){await this.labService.startOfflineLogging(t,e)}getArchiveInfo(){return this.labService.getArchiveInfo()}async getArchiveValues(t){try{const e=this._sensors.filter((t=>t instanceof Pl)).map((t=>({sensorType:t.sensorType,mode:t.mode,values:[]}))),n=await this.labService.getArchiveInfo(),i=await this.labService.getArchiveValues(t);if(!i)return null;i.forEach((t=>{e.forEach((e=>{let n=this.convertValue(t[e.sensorType],e.sensorType);n=xl(n,e.mode.accuracy??0),e.values.push(n)}))}));const s=Array(n.recordsCount);for(let t=0;t<s.length;t++)s[t]=n.loggingInterval.intervalMs*t;return{time:s,sensorsArchiveValues:e}}catch(t){return null}}connectToServer(t){return new Promise((async(e,n)=>{try{this._socket=new WebSocket(t),this._socket.binaryType="arraybuffer",this._socket.addEventListener("message",(async t=>{const e=await this.labService.makeQuery(t.data);this._socket.send(e)})),this._socket.addEventListener("open",e),this._socket.addEventListener("error",n)}catch(t){n(t)}}))}async dispose(){await this.stop(),this._socket?.close(),await this.labService.dispose()}}function Pc(e){let n,i;return{c(){n=x("div"),i=x("div"),B(i,"class","bar svelte-10mhw26"),I(i,"width",e[0],!1),B(n,"class","wrapper svelte-10mhw26")},m(t,e){_(t,n,e),S(n,i)},p(t,[e]){1&e&&I(i,"width",t[0],!1)},i:t,o:t,d(t){t&&$(n)}}}function Ec(t,e,n){let i,{progress:s=0}=e;return t.$$set=t=>{"progress"in t&&n(1,s=t.progress)},t.$$.update=()=>{2&t.$$.dirty&&n(0,i=s%100+"%")},[i,s]}class Ic extends Mt{constructor(t){super(),$t(this,t,Ec,Pc,o,{progress:1})}}class Rc{static _instance;_progress=new wc(0);_errorMessage=new wc("");_updateDownloaded=new wc(!1);get progress(){return this._progress}get errorMessage(){return this._errorMessage}get updateDownloaded(){return this._updateDownloaded}constructor(){self.ElectronAPI.addEventListener("download-progress",(t=>{this._progress.next(t)})),self.ElectronAPI.addEventListener("update-error",(t=>{this._errorMessage.next(t)}))}static get instance(){return this._instance||(this._instance=new Rc),this._instance}async checkUpdates(){const t=[];if(this._updateDownloaded.value)return null;const e=await new Promise((e=>{t.push(self.ElectronAPI.addEventListener("update-available",(t=>{e(t)}))),t.push(self.ElectronAPI.addEventListener("update-not-available",(()=>{e(null)}))),t.push(self.ElectronAPI.addEventListener("update-downloaded",(()=>{this._updateDownloaded.next(!0)}))),self.ElectronAPI.dispatchEvent("check-update")}));return t.forEach((t=>t.unsubscribe())),e}startUpdate(){self.ElectronAPI.dispatchEvent("download-update")}installUpdate(){this._updateDownloaded.value&&self.ElectronAPI.dispatchEvent("install-update")}}function zc(t){let e,n;return e=new al({props:{onDismiss:t[10],header:Tt.checkFWUpdate,body:Tt.checkingUpdates}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.onDismiss=t[10]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Uc(t){let e,n;return e=new al({props:{onDismiss:t[11],header:Tt.error,body:`${Tt.updateError}: ${t[3]}`}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.onDismiss=t[11]),8&n&&(i.body=`${Tt.updateError}: ${t[3]}`),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Nc(t){let e,n;return e=new al({props:{onDismiss:t[12],header:Tt.checkFWUpdate,body:Tt.allUpdated}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.onDismiss=t[12]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Oc(t){let e,n;return e=new sl({props:{header:Tt.updateFWTitle,body:`${Tt.newVersionAvailable}: ${t[4]}`,buttons:t[7]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};16&n&&(i.body=`${Tt.newVersionAvailable}: ${t[4]}`),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Fc(t){let e,n;return e=new Ka({props:{$$slots:{default:[Wc]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};16416&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Wc(t){let e,n,i;return n=new Ic({props:{progress:t[5]}}),{c(){e=x("div"),wt(n.$$.fragment),I(e,"width","40rem",!1)},m(t,s){_(t,e,s),St(n,e,null),i=!0},p(t,e){const i={};32&e&&(i.progress=t[5]),n.$set(i)},i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){t&&$(e),_t(n)}}}function Hc(e){let n,i;return n=new sl({props:{header:Tt.updateFWTitle,body:`${Tt.confirmInstallMessage}`,buttons:e[8]}}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function Gc(t){let e,n,i,s,r,o,a,l=t[2]===t[1].Fetching&&zc(t),c=t[2]===t[1].Error&&Uc(t),u=t[2]===t[1].Latest&&Nc(t),h=t[2]===t[1].ConfirmDownload&&Oc(t),d=t[2]===t[1].Downloading&&Fc(t),p=t[2]===t[1].ConfirmInstall&&Hc(t);return{c(){l&&l.c(),e=k(),c&&c.c(),n=k(),u&&u.c(),i=k(),h&&h.c(),s=k(),d&&d.c(),r=k(),p&&p.c(),o=D()},m(t,f){l&&l.m(t,f),_(t,e,f),c&&c.m(t,f),_(t,n,f),u&&u.m(t,f),_(t,i,f),h&&h.m(t,f),_(t,s,f),d&&d.m(t,f),_(t,r,f),p&&p.m(t,f),_(t,o,f),a=!0},p(t,[a]){t[2]===t[1].Fetching?l?(l.p(t,a),6&a&&pt(l,1)):(l=zc(t),l.c(),pt(l,1),l.m(e.parentNode,e)):l&&(ht(),ft(l,1,1,(()=>{l=null})),dt()),t[2]===t[1].Error?c?(c.p(t,a),6&a&&pt(c,1)):(c=Uc(t),c.c(),pt(c,1),c.m(n.parentNode,n)):c&&(ht(),ft(c,1,1,(()=>{c=null})),dt()),t[2]===t[1].Latest?u?(u.p(t,a),6&a&&pt(u,1)):(u=Nc(t),u.c(),pt(u,1),u.m(i.parentNode,i)):u&&(ht(),ft(u,1,1,(()=>{u=null})),dt()),t[2]===t[1].ConfirmDownload?h?(h.p(t,a),6&a&&pt(h,1)):(h=Oc(t),h.c(),pt(h,1),h.m(s.parentNode,s)):h&&(ht(),ft(h,1,1,(()=>{h=null})),dt()),t[2]===t[1].Downloading?d?(d.p(t,a),6&a&&pt(d,1)):(d=Fc(t),d.c(),pt(d,1),d.m(r.parentNode,r)):d&&(ht(),ft(d,1,1,(()=>{d=null})),dt()),t[2]===t[1].ConfirmInstall?p?(p.p(t,a),6&a&&pt(p,1)):(p=Hc(t),p.c(),pt(p,1),p.m(o.parentNode,o)):p&&(ht(),ft(p,1,1,(()=>{p=null})),dt())},i(t){a||(pt(l),pt(c),pt(u),pt(h),pt(d),pt(p),a=!0)},o(t){ft(l),ft(c),ft(u),ft(h),ft(d),ft(p),a=!1},d(t){l&&l.d(t),t&&$(e),c&&c.d(t),t&&$(n),u&&u.d(t),t&&$(i),h&&h.d(t),t&&$(s),d&&d.d(t),t&&$(r),p&&p.d(t),t&&$(o)}}}function jc(t,e,n){let i;var s;!function(t){t[t.Latest=0]="Latest",t[t.Fetching=1]="Fetching",t[t.ConfirmDownload=2]="ConfirmDownload",t[t.ConfirmInstall=3]="ConfirmInstall",t[t.Error=4]="Error",t[t.Downloading=5]="Downloading"}(s||(s={}));let{onClose:r}=e,{onDone:o}=e;const a=Rc.instance;let l,c=s.Fetching;const u=a.progress;let h;d(t,u,(t=>n(5,i=t))),W((()=>{const t=[];return t.push(a.errorMessage.subscribe((t=>{n(3,l=t),t&&n(2,c=s.Error)}))),t.push(a.updateDownloaded.subscribe((t=>{t&&n(2,c=s.ConfirmInstall)}))),a.checkUpdates().then((t=>{n(4,h=t),n(2,c=t?s.ConfirmDownload:s.Latest)})),()=>{t.forEach((t=>t.unsubscribe()))}}));let p=[{text:Tt.update,onClick:()=>{a.startUpdate(),n(2,c=s.Downloading)}},{text:Tt.cancel,onClick:r}],f=[{text:Tt.quitAndUpdate,onClick:()=>{a.installUpdate()}},{text:Tt.later,onClick:r}];return t.$$set=t=>{"onClose"in t&&n(0,r=t.onClose),"onDone"in t&&n(9,o=t.onDone)},[r,s,c,l,h,i,u,p,f,o,()=>{r()},()=>{r()},()=>{r()}]}class Yc extends Mt{constructor(t){super(),$t(this,t,jc,Gc,o,{onClose:0,onDone:9})}}function Xc(t){let e,n;return e=new al({props:{onDismiss:t[4],header:Tt.checkFWUpdate,body:Tt.allUpdated}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.onDismiss=t[4]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Zc(t){let e,n,i,s;const r=[Jc,qc],o=[];function a(t,e){return t[2]?1:0}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,s){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function qc(t){let e,n;return e=new Yc({props:{onClose:t[6],onDone:tu}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.onClose=t[6]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Jc(t){let e,n;return e=new al({props:{onDismiss:t[5],header:Tt.error,body:Tt.noInternetConnection}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.onDismiss=t[5]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Kc(e){let n,i,s,r,o,a,l,c,u,h,d,p,f,v,g,m,y=Tt.aboutContactCellphone+"",b=Tt.aboutSiteUrl+"",w=Tt.aboutSiteUrl+"";return{c(){n=x("div"),i=x("div"),s=x("span"),s.textContent=`${Tt.support}:`,r=k(),o=x("span"),a=k(),l=x("a"),c=C(b),u=k(),h=x("div"),d=x("span"),d.textContent=`${Tt.site}:`,p=k(),f=x("a"),v=C(w),g=k(),m=x("div"),B(s,"class","svelte-1lv9s8y"),B(o,"class","svelte-1lv9s8y"),B(l,"href",kt),B(l,"target","_blank"),B(l,"class","svelte-1lv9s8y"),B(i,"class","about-row svelte-1lv9s8y"),B(d,"class","svelte-1lv9s8y"),B(f,"href",kt),B(f,"target","_blank"),B(f,"class","svelte-1lv9s8y"),B(m,"class","svelte-1lv9s8y"),B(h,"class","about-row svelte-1lv9s8y"),B(n,"class","info svelte-1lv9s8y")},m(t,e){_(t,n,e),S(n,i),S(i,s),S(i,r),S(i,o),o.innerHTML=y,S(i,a),S(i,l),S(l,c),S(n,u),S(n,h),S(h,d),S(h,p),S(h,f),S(f,v),S(h,g),S(h,m)},p:t,d(t){t&&$(n)}}}function Qc(t){let e,n,i,s,r=t[1]&&Xc(t),o=t[0]&&Zc(t);return i=new ve({props:{subtitle:Tt.about,ico:"Info.png",$$slots:{default:[Kc]},$$scope:{ctx:t}}}),{c(){r&&r.c(),e=k(),o&&o.c(),n=k(),wt(i.$$.fragment)},m(t,a){r&&r.m(t,a),_(t,e,a),o&&o.m(t,a),_(t,n,a),St(i,t,a),s=!0},p(t,[s]){t[1]?r?(r.p(t,s),2&s&&pt(r,1)):(r=Xc(t),r.c(),pt(r,1),r.m(e.parentNode,e)):r&&(ht(),ft(r,1,1,(()=>{r=null})),dt()),t[0]?o?(o.p(t,s),1&s&&pt(o,1)):(o=Zc(t),o.c(),pt(o,1),o.m(n.parentNode,n)):o&&(ht(),ft(o,1,1,(()=>{o=null})),dt());const a={};128&s&&(a.$$scope={dirty:s,ctx:t}),i.$set(a)},i(t){s||(pt(r),pt(o),pt(i.$$.fragment,t),s=!0)},o(t){ft(r),ft(o),ft(i.$$.fragment,t),s=!1},d(t){r&&r.d(t),t&&$(e),o&&o.d(t),t&&$(n),_t(i,t)}}}const tu=()=>0;function eu(t,e,n){let{lab:i}=e,s=!1,r=!1,o=!1;fetch("https://google.com",{method:"HEAD"}).then((t=>{n(2,o=t.ok)})).catch();return t.$$set=t=>{"lab"in t&&n(3,i=t.lab)},[s,r,o,i,()=>{n(1,r=!1)},()=>n(0,s=!1),()=>n(0,s=!1)]}class nu extends Mt{constructor(t){super(),$t(this,t,eu,Qc,o,{lab:3})}}var iu,su,ru,ou;!function(t){t[t.IsPhoneSize=0]="IsPhoneSize",t[t.IsLocal=1]="IsLocal",t[t.SerialNumber=2]="SerialNumber",t[t.Theme=3]="Theme",t[t.ServerUrl=4]="ServerUrl"}(iu||(iu={})),function(t){t[t.DletaMultiplyer=0]="DletaMultiplyer",t[t.Alternative=1]="Alternative"}(su||(su={}));class au{numberOfSteps;_stepValues=[];_calibrationType=void 0;set calibrationType(t){this._calibrationType=t}get _multiplier(){return 2==this.numberOfSteps?(this._stepValues[2].newValue-this._stepValues[1].newValue)/(this._stepValues[2].rawValue-this._stepValues[1].rawValue):1}get _delta(){return 1==this.numberOfSteps?this._stepValues[1].newValue-this._stepValues[1].rawValue:2==this.numberOfSteps&&this._calibrationType==su.DletaMultiplyer?this._stepValues[1].newValue-this._multiplier*this._stepValues[1].rawValue:(this._calibrationType,void su.Alternative)}_getConductivityKDelta(){const t=this._stepValues[2].newValue,e=this._stepValues[1].rawValue,n=this._stepValues[2].rawValue;return{k:t/(n-e)-1,delta:-e*t/(n-e)}}checkIsValuesSet(){return this._stepValues.length===this.numberOfSteps+1&&0==this._stepValues.slice(1,this.numberOfSteps+1).includes(void 0)}getCalibratedValue(t,e){return this.checkIsValuesSet()?e===Bt.ConductivitySensor?El.convertConductivitySensorUser(t,this._getConductivityKDelta()):this._calibrationType===su.Alternative?zl(t,{k:1,delta:0},{calibrationValues:this._stepValues.map((t=>({value:t.newValue,delta:t.rawValue})))}):t*this._multiplier+this._delta:null}reset(){this._stepValues=[]}async applyCalibration(t){if(!this.checkIsValuesSet())return!1;let e;return e=t.sensorType===Bt.ConductivitySensor?await t.calibrate(this._getConductivityKDelta()):await t.calibrate({k:this._multiplier,delta:this._delta,calibrationValues:this._stepValues.map((t=>({value:t.newValue,delta:t.rawValue})))}),!!e&&(this.reset(),!0)}async resetCalibration(t){return!!await t.resetCalibration()&&(this.reset(),!0)}setupStep(t,e,n){this._stepValues[n]={newValue:e,rawValue:t}}}class lu extends Error{}function cu(t,e,n){const i=t.slice();return i[7]=e[n],i[9]=n,i}function uu(t){let e;return{c(){e=C(t[1])},m(t,n){_(t,e,n)},p(t,n){2&n&&P(e,t[1])},d(t){t&&$(e)}}}function hu(t){let e,n,i,s,r,o,a,l,u,h,d,p,f=t[7].name+"",v=!t[4]&&uu(t);function g(){return t[6](t[7],t[9])}return{c(){e=x("div"),n=x("img"),r=k(),o=x("span"),a=C(f),l=k(),u=x("button"),v&&v.c(),h=k(),c(n.src,i=t[7].ico)||B(n,"src",i),B(n,"alt",s=t[7].name),U(u,"blue-button",!t[4]),I(u,"background",t[4]?`url(${t[3]}) 100%/100% no-repeat`:"",!1),B(e,"class","sensor-grid__item")},m(t,i){_(t,e,i),S(e,n),S(e,r),S(e,o),S(o,a),S(e,l),S(e,u),v&&v.m(u,null),S(e,h),d||(p=V(u,"click",g),d=!0)},p(e,r){t=e,1&r&&!c(n.src,i=t[7].ico)&&B(n,"src",i),1&r&&s!==(s=t[7].name)&&B(n,"alt",s),1&r&&f!==(f=t[7].name+"")&&P(a,f),t[4]?v&&(v.d(1),v=null):v?v.p(t,r):(v=uu(t),v.c(),v.m(u,null)),16&r&&U(u,"blue-button",!t[4]),24&r&&I(u,"background",t[4]?`url(${t[3]}) 100%/100% no-repeat`:"",!1)},d(t){t&&$(e),v&&v.d(),d=!1,p()}}}function du(e){let n,i=e[0],s=[];for(let t=0;t<i.length;t+=1)s[t]=hu(cu(e,i,t));return{c(){n=x("div");for(let t=0;t<s.length;t+=1)s[t].c();B(n,"class","sensor-grid")},m(t,e){_(t,n,e);for(let t=0;t<s.length;t+=1)s[t].m(n,null)},p(t,[e]){if(31&e){let r;for(i=t[0],r=0;r<i.length;r+=1){const o=cu(t,i,r);s[r]?s[r].p(o,e):(s[r]=hu(o),s[r].c(),s[r].m(n,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:t,o:t,d(t){t&&$(n),M(s,t)}}}function pu(t,e,n){let i,{sensors:s}=e,{buttonText:r}=e,{onSelect:o}=e,{mobileButtonImage:a}=e;const l=X(iu.IsPhoneSize);d(t,l,(t=>n(4,i=t)));return t.$$set=t=>{"sensors"in t&&n(0,s=t.sensors),"buttonText"in t&&n(1,r=t.buttonText),"onSelect"in t&&n(2,o=t.onSelect),"mobileButtonImage"in t&&n(3,a=t.mobileButtonImage)},[s,r,o,a,i,l,(t,e)=>o(t,e)]}class fu extends Mt{constructor(t){super(),$t(this,t,pu,du,o,{sensors:0,buttonText:1,onSelect:2,mobileButtonImage:3})}}function vu(t,...e){return t.replace(/{(\d+)}/g,((t,n)=>void 0!==typeof e[n]?e[n]:t))}function gu(t,e){const n=Math.min(t,e),i=Math.max(t,e),s=Array.from({length:Math.abs(i-n+1)}).map(((t,e)=>e+n));return t>e?s.reverse():s}function mu(t,e,n){const i=t.slice();return i[24]=e[n],i[25]=e,i[26]=n,i}function yu(t,e,n){const i=t.slice();return i[24]=e[n],i}function bu(t){let e,n;return e=new al({props:{header:Tt.error,body:t[3],onDismiss:t[13]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8&n&&(i.body=t[3]),8&n&&(i.onDismiss=t[13]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function wu(e){let n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,D,A,T,L,E,I,z,U,N,O,F,W,H,G=Tt.currentValue+"",j=e[0].mode.unit+"",Y=Tt.calibrate+"",X=gu(e[0].calibrationSteps.min,e[0].calibrationSteps.max),Z=[];for(let t=0;t<X.length;t+=1)Z[t]=_u(yu(e,X,t));let q=gu(1,e[2].numberOfSteps),J=[];for(let t=0;t<q.length;t+=1)J[t]=$u(mu(e,q,t));return{c(){n=x("div"),i=x("div"),r=x("div"),o=x("label"),a=C(G),l=C(" ["),c=C(j),u=C("]:"),h=k(),d=x("span"),p=C(e[4]),f=k(),v=x("div"),g=x("label"),g.textContent=`${Tt.numberOfCalibrationSteps}:`,m=k(),y=x("select");for(let t=0;t<Z.length;t+=1)Z[t].c();b=k();for(let t=0;t<J.length;t+=1)J[t].c();w=k(),D=x("div"),A=x("label"),A.textContent=`${Tt.calibratedSensorValue}:`,T=k(),L=x("span"),E=C(e[5]),I=k(),z=x("button"),U=C(Y),O=k(),F=x("button"),F.textContent=`${Tt.reset}`,B(o,"for","latest-sensor-value"),B(o,"class","svelte-dxlmwx"),B(d,"id","latest-sensor-value"),B(d,"class","svelte-dxlmwx"),B(r,"class","calibration-row svelte-dxlmwx"),B(g,"for","select-steps"),B(g,"class","svelte-dxlmwx"),B(y,"id","select-steps"),B(y,"class","svelte-dxlmwx"),void 0===e[2].numberOfSteps&&it((()=>e[15].call(y))),B(v,"class","calibration-row svelte-dxlmwx"),B(A,"for","calibrated-sensor-value"),B(A,"class","svelte-dxlmwx"),B(L,"id","calibrated-sensor-value"),B(L,"class","svelte-dxlmwx"),B(D,"class","calibration-row svelte-dxlmwx"),B(i,"class","calibration-rows svelte-dxlmwx"),B(z,"class","blue-button calibrate-buttons svelte-dxlmwx"),z.disabled=N=Number.isNaN(e[5])||null==e[5],B(F,"class","red-button calibrate-buttons svelte-dxlmwx"),B(n,"class","calibration-wrapper")},m(t,s){_(t,n,s),S(n,i),S(i,r),S(r,o),S(o,a),S(o,l),S(o,c),S(o,u),S(r,h),S(r,d),S(d,p),S(i,f),S(i,v),S(v,g),S(v,m),S(v,y);for(let t=0;t<Z.length;t+=1)Z[t].m(y,null);R(y,e[2].numberOfSteps),S(i,b);for(let t=0;t<J.length;t+=1)J[t].m(i,null);S(i,w),S(i,D),S(D,A),S(D,T),S(D,L),S(L,E),S(n,I),S(n,z),S(z,U),S(n,O),S(n,F),W||(H=[V(y,"change",e[15]),V(z,"click",e[9]),V(F,"click",e[10])],W=!0)},p(t,e){if(1&e&&j!==(j=t[0].mode.unit+"")&&P(c,j),16&e&&P(p,t[4]),1&e){let n;for(X=gu(t[0].calibrationSteps.min,t[0].calibrationSteps.max),n=0;n<X.length;n+=1){const i=yu(t,X,n);Z[n]?Z[n].p(i,e):(Z[n]=_u(i),Z[n].c(),Z[n].m(y,null))}for(;n<Z.length;n+=1)Z[n].d(1);Z.length=X.length}if(5&e&&R(y,t[2].numberOfSteps),2117&e){let n;for(q=gu(1,t[2].numberOfSteps),n=0;n<q.length;n+=1){const s=mu(t,q,n);J[n]?J[n].p(s,e):(J[n]=$u(s),J[n].c(),J[n].m(i,w))}for(;n<J.length;n+=1)J[n].d(1);J.length=q.length}32&e&&P(E,t[5]),32&e&&N!==(N=Number.isNaN(t[5])||null==t[5])&&(z.disabled=N)},i:t,o:t,d(t){t&&$(n),M(Z,t),M(J,t),W=!1,s(H)}}}function Su(t){let e,n;return e=new fu({props:{sensors:t[7],onSelect:t[14],buttonText:Tt.calibrate,mobileButtonImage:"arrow-right.svg"}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};128&n&&(i.sensors=t[7]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function _u(t){let e,n,i,s=t[24]+"";return{c(){e=x("option"),n=C(s),e.__value=i=t[24],e.value=e.__value},m(t,i){_(t,e,i),S(e,n)},p(t,r){1&r&&s!==(s=t[24]+"")&&P(n,s),1&r&&i!==(i=t[24])&&(e.__value=i,e.value=e.__value)},d(t){t&&$(e)}}}function $u(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g=vu(Ct.realValueStep,t[24])+"";function m(){t[16].call(l,t[24])}function y(){return t[17](t[24])}return{c(){e=x("div"),n=x("label"),i=new N(!1),r=C(":"),a=k(),l=x("input"),d=k(),p=x("button"),p.textContent=`${Tt.apply}`,i.a=r,B(n,"for",o="real-value-step-"+t[24]),B(n,"class","svelte-dxlmwx"),B(l,"id",c="real-value-step-"+t[24]),B(l,"type","number"),B(l,"min",u=t[0].mode.minValue),B(l,"max",h=t[0].mode.maxValue),B(l,"class","svelte-dxlmwx"),B(p,"class","blue-button apply-button svelte-dxlmwx"),B(e,"class","calibration-row svelte-dxlmwx")},m(s,o){_(s,e,o),S(e,n),i.m(g,n),S(n,r),S(e,a),S(e,l),E(l,t[6][t[24]]),S(e,d),S(e,p),f||(v=[V(l,"input",m),V(p,"click",y)],f=!0)},p(e,s){t=e,4&s&&g!==(g=vu(Ct.realValueStep,t[24])+"")&&i.p(g),5&s&&o!==(o="real-value-step-"+t[24])&&B(n,"for",o),5&s&&c!==(c="real-value-step-"+t[24])&&B(l,"id",c),1&s&&u!==(u=t[0].mode.minValue)&&B(l,"min",u),1&s&&h!==(h=t[0].mode.maxValue)&&B(l,"max",h),69&s&&L(l.value)!==t[6][t[24]]&&E(l,t[6][t[24]])},d(t){t&&$(e),f=!1,s(v)}}}function Mu(t){let e,n,i,s;const r=[Su,wu],o=[];function a(t,e){return null==t[0]?0:1}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,s){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function xu(t){let e,n,i,s=t[3]&&bu(t);return n=new ve({props:{title:Tt.calibrationTitle,ico:"Calibr.png",subtitle:Tt.calibrationSubtitle,onBack:t[1]?t[1]:null!=t[0]?t[18]:null,$$slots:{default:[Mu]},$$scope:{ctx:t}}}),{c(){s&&s.c(),e=k(),wt(n.$$.fragment)},m(t,r){s&&s.m(t,r),_(t,e,r),St(n,t,r),i=!0},p(t,[i]){t[3]?s?(s.p(t,i),8&i&&pt(s,1)):(s=bu(t),s.c(),pt(s,1),s.m(e.parentNode,e)):s&&(ht(),ft(s,1,1,(()=>{s=null})),dt());const r={};3&i&&(r.onBack=t[1]?t[1]:null!=t[0]?t[18]:null),536871157&i&&(r.$$scope={dirty:i,ctx:t}),n.$set(r)},i(t){i||(pt(s),pt(n.$$.fragment,t),i=!0)},o(t){ft(s),ft(n.$$.fragment,t),i=!1},d(t){s&&s.d(t),t&&$(e),_t(n,t)}}}function Cu(t,e,n){let i,{sensors:s=[]}=e,{onBack:r=null}=e,{selectedSensor:o=null}=e;X(iu.IsPhoneSize);const a=new au;let l,c="",u=0,h=0,d=[0,0,0,0,0,0,0,0,0,0,0];function p(t,e=null){f(),n(0,o=e||(i[t]||null)),o&&(a.reset(),n(2,a.calibrationType=o.calibrationSteps.max<=2?su.DletaMultiplyer:su.Alternative,a),n(2,a.numberOfSteps=o.calibrationSteps.max,a),a.reset(),o?.start(),l=self.setInterval(v,250))}async function f(){clearInterval(l),await(o?.stop())}function v(){n(4,u=o.getLatestValue()),n(5,h=a.getCalibratedValue(o.getLatestRawValue(),o.sensorType)),null==h&&n(5,h=o.getLatestValue()),n(5,h=h&&xl(h,o.accuracy))}function g(t,e,i){if(Number.isNaN(e))n(3,c=Tt.inputMustBeANumber);else try{a.setupStep(t,e,i)}catch(t){n(3,c=t instanceof lu?Tt.calibrateEqualsError:Tt.unknownError)}}W((()=>{o&&p(null,o)})),W((()=>async()=>{await f()}));return t.$$set=t=>{"sensors"in t&&n(12,s=t.sensors),"onBack"in t&&n(1,r=t.onBack),"selectedSensor"in t&&n(0,o=t.selectedSensor)},t.$$.update=()=>{4096&t.$$.dirty&&n(7,i=s.filter((t=>t.calibrationSteps.min>0)))},[o,r,a,c,u,h,d,i,p,async function(){await a.applyCalibration(o)||n(3,c=Tt.calibrationNotSuccess)},async function(){await a.resetCalibration(o)||n(3,c=Tt.calibrationNotSuccess)},g,s,()=>n(3,c=""),(t,e)=>p(e),function(){a.numberOfSteps=z(this),n(2,a),n(0,o)},function(t){d[t]=L(this.value),n(6,d)},t=>g(o.getLatestRawValue(),d[t],t),()=>p(null)]}class ku extends Mt{constructor(t){super(),$t(this,t,Cu,xu,o,{sensors:12,onBack:1,selectedSensor:0})}}function Du(t){let e,n;return{c(){e=x("span"),n=C(t[4]),B(e,"class","error-message svelte-1w8fx9g")},m(t,i){_(t,e,i),S(e,n)},p(t,e){16&e&&P(n,t[4])},d(t){t&&$(e)}}}function Vu(t){let e,n,i;return{c(){e=x("input"),B(e,"type","text")},m(s,r){_(s,e,r),E(e,t[5]),n||(i=V(e,"input",t[7]),n=!0)},p(t,n){32&n&&e.value!==t[5]&&E(e,t[5])},d(t){t&&$(e),n=!1,i()}}}function Au(t){let e,n,i;return{c(){e=x("input"),B(e,"type","password")},m(s,r){_(s,e,r),E(e,t[5]),n||(i=V(e,"input",t[6]),n=!0)},p(t,n){32&n&&e.value!==t[5]&&E(e,t[5])},d(t){t&&$(e),n=!1,i()}}}function Tu(t){let e,n,i,o,a,l,c,u,h,d,p,f=t[4]&&Du(t);function v(t,e){return t[3]?Au:Vu}let g=v(t),m=g(t);return{c(){e=x("div"),n=x("span"),i=k(),f&&f.c(),o=k(),m.c(),a=k(),l=x("div"),c=x("button"),c.textContent=`${Tt.confirm}`,u=k(),h=x("button"),h.textContent=`${Tt.reject}`,B(n,"class","header svelte-1w8fx9g"),B(l,"class","row modal-buttons"),B(e,"class","column wrapper svelte-1w8fx9g")},m(s,v){_(s,e,v),S(e,n),n.innerHTML=t[0],S(e,i),f&&f.m(e,null),S(e,o),m.m(e,null),S(e,a),S(e,l),S(l,c),S(l,u),S(l,h),d||(p=[V(c,"click",t[8]),V(h,"click",(function(){r(t[2])&&t[2].apply(this,arguments)}))],d=!0)},p(i,s){t=i,1&s&&(n.innerHTML=t[0]),t[4]?f?f.p(t,s):(f=Du(t),f.c(),f.m(e,o)):f&&(f.d(1),f=null),g===(g=v(t))&&m?m.p(t,s):(m.d(1),m=g(t),m&&(m.c(),m.m(e,a)))},d(t){t&&$(e),f&&f.d(),m.d(),d=!1,s(p)}}}function Bu(t){let e,n;return e=new Ka({props:{$$slots:{default:[Tu]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};575&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Lu(t,e,n){let{header:i}=e,{onSubmit:s}=e,{onClose:r}=e,{isPassword:o=!1}=e,{errorMessage:a=""}=e,l="";return t.$$set=t=>{"header"in t&&n(0,i=t.header),"onSubmit"in t&&n(1,s=t.onSubmit),"onClose"in t&&n(2,r=t.onClose),"isPassword"in t&&n(3,o=t.isPassword),"errorMessage"in t&&n(4,a=t.errorMessage)},[i,s,r,o,a,l,function(){l=this.value,n(5,l)},function(){l=this.value,n(5,l)},()=>s(l)]}class Pu extends Mt{constructor(t){super(),$t(this,t,Lu,Bu,o,{header:0,onSubmit:1,onClose:2,isPassword:3,errorMessage:4})}}function Eu(t,e){let n;async function i(){n?.(),n=await t()}if(e){let t=[];H((()=>{const n=e();n.some(((e,n)=>e!==t[n]))&&(i(),t=n)}))}else H(i);G((()=>{n&&n()}))}function Iu(t,e,n){const i=t.slice();return i[27]=e[n],i}function Ru(t,e,n){const i=t.slice();return i[30]=e[n],i}function zu(t){let e,n;return e=new al({props:{header:Tt.error,body:t[4],onDismiss:t[12]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.body=t[4]),16&n[0]&&(i.onDismiss=t[12]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Uu(t){let e,n;return e=new Pu({props:{onClose:t[13],onSubmit:t[11],isPassword:!0,header:Tt.calibration_writeAPasswordModalHeader,errorMessage:t[6]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};32&n[0]&&(i.onClose=t[13]),64&n[0]&&(i.errorMessage=t[6]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Nu(t){let e,n,i,s;e=new ve({props:{title:t[0].name,ico:t[0].ico,subtitle:Tt.sensorSettings,$$slots:{default:[Yu]},$$scope:{ctx:t}}});let r=null!==t[1]&&Xu(t);return{c(){wt(e.$$.fragment),n=k(),r&&r.c(),i=D()},m(t,o){St(e,t,o),_(t,n,o),r&&r.m(t,o),_(t,i,o),s=!0},p(t,n){const s={};1&n[0]&&(s.title=t[0].name),1&n[0]&&(s.ico=t[0].ico),425&n[0]|4&n[1]&&(s.$$scope={dirty:n,ctx:t}),e.$set(s),null!==t[1]?r?(r.p(t,n),2&n[0]&&pt(r,1)):(r=Xu(t),r.c(),pt(r,1),r.m(i.parentNode,i)):r&&(ht(),ft(r,1,1,(()=>{r=null})),dt())},i(t){s||(pt(e.$$.fragment,t),pt(r),s=!0)},o(t){ft(e.$$.fragment,t),ft(r),s=!1},d(t){_t(e,t),t&&$(n),r&&r.d(t),t&&$(i)}}}function Ou(t){let e,n;return e=new ku({props:{sensors:[],selectedSensor:t[0],onBack:t[14]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n[0]&&(i.selectedSensor=t[0]),4&n[0]&&(i.onBack=t[14]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Fu(t){let e,n,i,s=t[30].toString()+"";return{c(){e=x("option"),n=C(s),e.__value=i=t[30],e.value=e.__value},m(t,i){_(t,e,i),S(e,n)},p(t,r){1&r[0]&&s!==(s=t[30].toString()+"")&&P(n,s),1&r[0]&&i!==(i=t[30])&&(e.__value=i,e.value=e.__value)},d(t){t&&$(e)}}}function Wu(e){let n,i,s,r=e[27].stringRepresentation+"";return{c(){n=x("option"),i=C(r),n.__value=s=e[27],n.value=n.__value},m(t,e){_(t,n,e),S(n,i)},p:t,d(t){t&&$(n)}}}function Hu(t){let e,n,i,r,o,a,l,c;return{c(){e=x("div"),n=x("label"),n.textContent=`${Tt.calibrationCoefficient}`,i=k(),r=x("input"),o=k(),a=x("button"),a.textContent=`${Tt.apply}`,B(r,"type","number"),B(r,"step","0.001"),B(e,"class","setting-row"),B(a,"class","blue-button ml-auto"),I(a,"margin-bottom","1rem")},m(s,u){_(s,e,u),S(e,n),S(e,i),S(e,r),E(r,t[7]),_(s,o,u),_(s,a,u),l||(c=[V(r,"input",t[22]),V(a,"click",t[23])],l=!0)},p(t,e){128&e[0]&&L(r.value)!==t[7]&&E(r,t[7])},d(t){t&&$(e),t&&$(o),t&&$(a),l=!1,s(c)}}}function Gu(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.calibrate}`,B(n,"class","blue-button ml-auto")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[25]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function ju(t){let e,n,i,s,r=Tt.calibrate+"";return{c(){e=x("button"),n=C(r),e.disabled=t[3],B(e,"class","blue-button ml-auto")},m(r,o){_(r,e,o),S(e,n),i||(s=V(e,"click",t[24]),i=!0)},p(t,n){8&n[0]&&(e.disabled=t[3])},d(t){t&&$(e),i=!1,s()}}}function Yu(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,C,D,A,T,L,P,I,z,U,N,O,F,W,H,G,j,Y,X,Z,q,J,K,Q,tt=t[0].modes,et=[];for(let e=0;e<tt.length;e+=1)et[e]=Fu(Ru(t,tt,e));let nt=Sl.Intervals,st=[];for(let e=0;e<nt.length;e+=1)st[e]=Wu(Iu(t,nt,e));let rt=t[0].sensorType===Bt.ConductivitySensor&&Hu(t);function ot(t,e){return t[0].calibrationSteps===Lt.Automated?ju:Gu}let at=ot(t),lt=at(t);return{c(){e=x("div"),n=x("div"),i=x("div"),r=x("label"),r.textContent=`${Tt.rangeAndUnit}`,o=k(),a=x("select");for(let t=0;t<et.length;t+=1)et[t].c();l=k(),c=x("div"),u=x("label"),u.textContent=`${Tt.chartLineColor}`,h=k(),d=x("input"),p=k(),f=x("div"),v=x("label"),v.textContent=`${Tt.chartLineWidth}`,g=k(),m=x("select"),y=x("option"),y.textContent="1",b=x("option"),b.textContent="2",w=x("option"),w.textContent="3",C=x("option"),C.textContent="4",D=k(),A=x("div"),T=x("label"),T.textContent=`${Tt.chartMarkerColor}`,L=k(),P=x("input"),I=k(),z=x("div"),U=x("label"),U.textContent=`${Tt.refreshInterval}`,N=k(),O=x("select");for(let t=0;t<st.length;t+=1)st[t].c();F=k(),W=x("div"),H=x("label"),H.textContent=`${Tt.chartMarkerWidth}`,G=k(),j=x("select"),Y=x("option"),Y.textContent="0.5",X=x("option"),X.textContent="1",Z=x("option"),Z.textContent="2",q=k(),rt&&rt.c(),J=k(),lt.c(),void 0===t[8]&&it((()=>t[15].call(a))),B(i,"class","setting-row"),B(d,"type","color"),B(c,"class","setting-row"),y.__value=1,y.value=y.__value,b.__value=2,b.value=b.__value,w.__value=3,w.value=w.__value,C.__value=4,C.value=C.__value,void 0===t[0].chartSettings.lineSize&&it((()=>t[18].call(m))),B(f,"class","setting-row"),B(P,"type","color"),B(A,"class","setting-row"),void 0===t[0].interval&&it((()=>t[20].call(O))),B(z,"class","setting-row"),Y.__value=.5,Y.value=Y.__value,X.__value=1,X.value=X.__value,Z.__value=2,Z.value=Z.__value,void 0===t[0].chartSettings.markerSize&&it((()=>t[21].call(j))),B(W,"class","setting-row"),B(n,"class","settings"),B(e,"class","w-full h-full")},m(s,$){_(s,e,$),S(e,n),S(n,i),S(i,r),S(i,o),S(i,a);for(let t=0;t<et.length;t+=1)et[t].m(a,null);R(a,t[8]),S(n,l),S(n,c),S(c,u),S(c,h),S(c,d),E(d,t[0].chartSettings.lineColor),S(n,p),S(n,f),S(f,v),S(f,g),S(f,m),S(m,y),S(m,b),S(m,w),S(m,C),R(m,t[0].chartSettings.lineSize),S(n,D),S(n,A),S(A,T),S(A,L),S(A,P),E(P,t[0].chartSettings.markerColor),S(n,I),S(n,z),S(z,U),S(z,N),S(z,O);for(let t=0;t<st.length;t+=1)st[t].m(O,null);R(O,t[0].interval),S(n,F),S(n,W),S(W,H),S(W,G),S(W,j),S(j,Y),S(j,X),S(j,Z),R(j,t[0].chartSettings.markerSize),S(n,q),rt&&rt.m(n,null),S(n,J),lt.m(n,null),K||(Q=[V(a,"change",t[15]),V(a,"change",t[16]),V(d,"input",t[17]),V(m,"change",t[18]),V(P,"input",t[19]),V(O,"change",t[20]),V(j,"change",t[21])],K=!0)},p(t,e){if(1&e[0]){let n;for(tt=t[0].modes,n=0;n<tt.length;n+=1){const i=Ru(t,tt,n);et[n]?et[n].p(i,e):(et[n]=Fu(i),et[n].c(),et[n].m(a,null))}for(;n<et.length;n+=1)et[n].d(1);et.length=tt.length}if(257&e[0]&&R(a,t[8]),1&e[0]&&E(d,t[0].chartSettings.lineColor),1&e[0]&&R(m,t[0].chartSettings.lineSize),1&e[0]&&E(P,t[0].chartSettings.markerColor),0&e){let n;for(nt=Sl.Intervals,n=0;n<nt.length;n+=1){const i=Iu(t,nt,n);st[n]?st[n].p(i,e):(st[n]=Wu(i),st[n].c(),st[n].m(O,null))}for(;n<st.length;n+=1)st[n].d(1);st.length=nt.length}1&e[0]&&R(O,t[0].interval),1&e[0]&&R(j,t[0].chartSettings.markerSize),t[0].sensorType===Bt.ConductivitySensor?rt?rt.p(t,e):(rt=Hu(t),rt.c(),rt.m(n,J)):rt&&(rt.d(1),rt=null),at===(at=ot(t))&&lt?lt.p(t,e):(lt.d(1),lt=at(t),lt&&(lt.c(),lt.m(n,null)))},d(t){t&&$(e),M(et,t),M(st,t),rt&&rt.d(),lt.d(),K=!1,s(Q)}}}function Xu(t){let e,n;return e=new al({props:{onDismiss:t[26],header:Tt.calibrationTitle,body:!0===t[1]?Tt.calibrationSuccess:Tt.calibrationNotSuccess}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};2&n[0]&&(i.onDismiss=t[26]),2&n[0]&&(i.body=!0===t[1]?Tt.calibrationSuccess:Tt.calibrationNotSuccess),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Zu(t){let e,n,i,s,r,o,a=t[4]&&zu(t),l=t[5]&&Uu(t);const c=[Ou,Nu],u=[];function h(t,e){return t[2]?0:1}return i=h(t),s=u[i]=c[i](t),{c(){a&&a.c(),e=k(),l&&l.c(),n=k(),s.c(),r=D()},m(t,s){a&&a.m(t,s),_(t,e,s),l&&l.m(t,s),_(t,n,s),u[i].m(t,s),_(t,r,s),o=!0},p(t,o){t[4]?a?(a.p(t,o),16&o[0]&&pt(a,1)):(a=zu(t),a.c(),pt(a,1),a.m(e.parentNode,e)):a&&(ht(),ft(a,1,1,(()=>{a=null})),dt()),t[5]?l?(l.p(t,o),32&o[0]&&pt(l,1)):(l=Uu(t),l.c(),pt(l,1),l.m(n.parentNode,n)):l&&(ht(),ft(l,1,1,(()=>{l=null})),dt());let d=i;i=h(t),i===d?u[i].p(t,o):(ht(),ft(u[d],1,1,(()=>{u[d]=null})),dt(),s=u[i],s?s.p(t,o):(s=u[i]=c[i](t),s.c()),pt(s,1),s.m(r.parentNode,r))},i(t){o||(pt(a),pt(l),pt(s),o=!0)},o(t){ft(a),ft(l),ft(s),o=!1},d(t){a&&a.d(t),t&&$(e),l&&l.d(t),t&&$(n),u[i].d(t),t&&$(r)}}}function qu(t,e,n){let i,{sensor:s}=e,r=null,o=!1,a=!1,l="",c=!1,u="",h=1;async function d(){try{await s.setMode(i)}catch(t){n(4,l=Tt.setModeError)}finally{n(8,i=s.mode)}}async function p(){s.calibrationSteps===new Lt(-1,-1)&&(n(3,a=!0),n(1,r=await s.calibrate({})),n(3,a=!1))}Eu((()=>{s.sensorType===Bt.ConductivitySensor&&n(7,h=s.userSettings[s.modeIndex]?.k2??1)}),(()=>[i]));return t.$$set=t=>{"sensor"in t&&n(0,s=t.sensor)},t.$$.update=()=>{1&t.$$.dirty[0]&&n(8,i=s?.mode)},[s,r,o,a,l,c,u,h,i,d,p,function(t){"12345"===t?(n(2,o=!0),n(5,c=!1),n(6,u="")):n(6,u=Tt.calibration_passwordError)},()=>n(4,l=""),()=>n(5,c=!1),()=>n(2,o=!1),function(){i=z(this),n(8,i),n(0,s),n(0,s)},()=>d(),function(){s.chartSettings.lineColor=this.value,n(0,s)},function(){s.chartSettings.lineSize=z(this),n(0,s)},function(){s.chartSettings.markerColor=this.value,n(0,s)},function(){s.interval=z(this),n(0,s)},function(){s.chartSettings.markerSize=z(this),n(0,s)},function(){h=L(this.value),n(7,h)},()=>{Number.isNaN(h)||s.calibrate({k2:h})},()=>p(),()=>n(5,c=!0),()=>n(1,r=null)]}window.DEVELOPED_BY="hheimerd";class Ju extends Mt{constructor(t){super(),$t(this,t,qu,Zu,o,{sensor:0},null,[-1,-1])}}function Ku(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.darkTheme}`,B(n,"class","blue-button")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[9]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function Qu(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.lightTheme}`,B(n,"class","blue-button")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[8]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function th(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,M,D,A,T,P,I,z,U,N,O,F=Tt.timeSecond+"",W=Tt.timeMinute+"",H=Tt.modeStopwatch+"",G=Tt.modeMinutesSecondsMs+"",j=Tt.modeHoursMinutesSeconds+"";function Y(t,e){return t[3]==ou.Dark?Qu:Ku}let X=Y(t),Z=X(t);return{c(){e=x("div"),n=x("div"),i=x("label"),i.textContent=`${Tt.experimentTimeLabel}`,r=k(),o=x("div"),a=x("input"),l=k(),c=x("select"),u=x("option"),h=C(F),d=x("option"),p=C(W),f=k(),v=x("div"),g=x("label"),g.textContent=`${Tt.timeFormatLabel}`,m=k(),y=x("select"),b=x("option"),w=C(H),M=x("option"),D=C(G),A=x("option"),T=C(j),P=k(),I=x("div"),z=x("label"),z.textContent=`${Tt.theme}`,U=k(),Z.c(),B(a,"type","number"),B(a,"min","0"),B(a,"max",ih),u.__value=ru.Second,u.value=u.__value,d.__value=ru.Minute,d.value=d.__value,void 0===t[0]&&it((()=>t[6].call(c))),B(o,"class","setting-value"),B(n,"class","setting-row"),b.__value=It.Stopwatch,b.value=b.__value,M.__value=It.MinutesSecondsMs,M.value=M.__value,A.__value=It.HoursMinutesSeconds,A.value=A.__value,B(y,"class","setting-value"),void 0===t[2].timeFormat&&it((()=>t[7].call(y))),B(v,"class","setting-row"),B(I,"class","setting-row"),B(e,"class","settings")},m(s,$){_(s,e,$),S(e,n),S(n,i),S(n,r),S(n,o),S(o,a),E(a,t[1]),S(o,l),S(o,c),S(c,u),S(u,h),S(c,d),S(d,p),R(c,t[0]),S(e,f),S(e,v),S(v,g),S(v,m),S(v,y),S(y,b),S(b,w),S(y,M),S(M,D),S(y,A),S(A,T),R(y,t[2].timeFormat),S(e,P),S(e,I),S(I,z),S(I,U),Z.m(I,null),N||(O=[V(a,"input",t[5]),V(c,"change",t[6]),V(y,"change",t[7])],N=!0)},p(t,e){2&e&&L(a.value)!==t[1]&&E(a,t[1]),1&e&&R(c,t[0]),4&e&&R(y,t[2].timeFormat),X===(X=Y(t))&&Z?Z.p(t,e):(Z.d(1),Z=X(t),Z&&(Z.c(),Z.m(I,null)))},d(t){t&&$(e),Z.d(),N=!1,s(O)}}}function eh(t){let e,n;return e=new ve({props:{title:Tt.settings,ico:"Gear.png",subtitle:Tt.experimentSettings,$$slots:{default:[th]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};1039&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}!function(t){t[t.Second=1]="Second",t[t.Minute=60]="Minute"}(ru||(ru={})),function(t){t[t.Light=0]="Light",t[t.Dark=1]="Dark"}(ou||(ou={}));let nh=ru.Second;const ih=60;function sh(t,e,n){let i,s=nh,r=te.experimentTime/s;const o=X(iu.Theme);d(t,o,(t=>n(3,i=t)));return t.$$.update=()=>{3&t.$$.dirty&&(r>ih&&n(1,r=ih),n(2,te.experimentTime=r*s,te),nh=s)},[s,r,te,i,o,function(){r=L(this.value),n(1,r),n(0,s)},function(){s=z(this),n(0,s)},function(){te.timeFormat=z(this),n(2,te),n(1,r),n(0,s)},()=>w(o,i=ou.Light,i),()=>w(o,i=ou.Dark,i)]}class rh extends Mt{constructor(t){super(),$t(this,t,sh,eh,o,{})}}function oh(t){let e,n,i,s,r,o,a,l,c,u,h,d,p,f,v,g;return{c(){e=x("div"),n=x("label"),n.textContent=`${Tt.ipAddress} (${Tt.optional})`,i=k(),s=x("input"),r=k(),o=x("div"),a=x("label"),a.textContent=`${Tt.serverAddress} (${Tt.optional})`,l=k(),c=x("input"),u=k(),h=x("div"),d=x("label"),d.textContent=`${Tt.gateway} (${Tt.optional})`,p=k(),f=x("input"),B(n,"for","ip"),B(s,"type","text"),B(s,"id","ip"),B(s,"name","ip"),s.value="",B(e,"class","setting-row"),B(a,"for","server"),B(c,"type","text"),B(c,"id","server"),B(c,"name","server"),B(o,"class","setting-row"),B(d,"for","gateway"),B(f,"type","text"),B(f,"id","gateway"),B(f,"name","gateway"),f.value="",B(h,"class","setting-row")},m(m,y){_(m,e,y),S(e,n),S(e,i),S(e,s),_(m,r,y),_(m,o,y),S(o,a),S(o,l),S(o,c),E(c,t[1]),_(m,u,y),_(m,h,y),S(h,d),S(h,p),S(h,f),v||(g=V(c,"input",t[4]),v=!0)},p(t,e){2&e&&c.value!==t[1]&&E(c,t[1])},d(t){t&&$(e),t&&$(r),t&&$(o),t&&$(u),t&&$(h),v=!1,g()}}}function ah(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,M,C=t[0]&&oh(t);return{c(){e=x("form"),n=x("div"),i=x("label"),i.textContent=`${Tt.networkName}`,r=k(),o=x("input"),a=k(),l=x("div"),c=x("label"),c.textContent=`${Tt.password}`,u=k(),h=x("input"),d=k(),C&&C.c(),p=k(),f=x("div"),v=x("input"),g=k(),m=x("label"),m.textContent=`${Tt.showAdditionalSettings}`,y=k(),b=x("input"),B(i,"for","ssid"),B(o,"type","text"),B(o,"id","ssid"),o.required=!0,B(o,"name","ssid"),B(n,"class","setting-row"),B(c,"for","pass"),B(h,"type","password"),B(h,"id","pass"),h.required=!0,B(h,"name","pass"),B(l,"class","setting-row"),B(v,"type","checkbox"),B(v,"id","addOtp"),B(v,"class","svelte-bfgvym"),B(m,"for","addOtp"),B(f,"class","row align-center checkbox-wrapper svelte-bfgvym"),B(b,"type","submit"),B(b,"class","blue-button ml-auto"),b.value=Tt.connect,B(e,"action","/public"),B(e,"method","POST"),B(e,"class","settings")},m(s,$){_(s,e,$),S(e,n),S(n,i),S(n,r),S(n,o),S(e,a),S(e,l),S(l,c),S(l,u),S(l,h),S(e,d),C&&C.m(e,null),S(e,p),S(e,f),S(f,v),v.checked=t[0],S(f,g),S(f,m),S(e,y),S(e,b),w||(M=[V(v,"change",t[5]),V(e,"submit",t[3])],w=!0)},p(t,n){t[0]?C?C.p(t,n):(C=oh(t),C.c(),C.m(e,p)):C&&(C.d(1),C=null),1&n&&(v.checked=t[0])},d(t){t&&$(e),C&&C.d(),w=!1,s(M)}}}function lh(t){let e,n;return e=new ve({props:{title:Tt.wifiSettings,subtitle:Tt.wifiSettings,ico:"wifi.svg",$$slots:{default:[ah]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};131&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function ch(t,e,n){let i,s;d(t,_o,(t=>n(1,s=t)));let r=!1;const o=X(iu.SerialNumber);return d(t,o,(t=>n(6,i=t))),[r,s,o,function(t){t.preventDefault();const e=new URL(go);e.searchParams.append(fo,i),window.open(e,"_blank")},function(){s=this.value,_o.set(s)},function(){r=this.checked,n(0,r)}]}class uh extends Mt{constructor(t){super(),$t(this,t,ch,lh,o,{})}}function hh(e){let n,i,s;return{c(){n=x("div"),n.innerHTML='<div class="hamburger-lines svelte-1xf4wnj"><span class="line line1 svelte-1xf4wnj"></span> \n        <span class="line line2 svelte-1xf4wnj"></span> \n        <span class="line line3 svelte-1xf4wnj"></span></div>',B(n,"class","wrapper svelte-1xf4wnj"),U(n,"checked",e[0])},m(t,r){_(t,n,r),i||(s=V(n,"click",e[1]),i=!0)},p(t,[e]){1&e&&U(n,"checked",t[0])},i:t,o:t,d(t){t&&$(n),i=!1,s()}}}function dh(t,e,n){let{value:i}=e;return t.$$set=t=>{"value"in t&&n(0,i=t.value)},[i,()=>n(0,i=!i)]}class ph extends Mt{constructor(t){super(),$t(this,t,dh,hh,o,{value:0})}}const fh=t=>new Promise((e=>setTimeout(e,t)));class vh{async sendCommandOrThrow(t){const e=await this.sendCommand(t);if(!e)throw new kl;return e}}class gh extends Error{innerError;constructor(t=null,e=Tt.deviceSelectionError){super(e),this.innerError=t}}class mh extends Error{innerError;constructor(t=null,e){super(e),this.innerError=t}}class yh extends vh{static serviceUUID="0000ffe0-0000-1000-8000-00805f9b34fb";static characteristicUUID="0000ffe1-0000-1000-8000-00805f9b34fb";_characteristic;_onDisconnect=new jr;_device;get isConnected(){return!!this._characteristic}get onDisconnect(){return this._onDisconnect}constructor(t){super(),this._device=t}static async selectDevice(){try{return await navigator.bluetooth.requestDevice({filters:[{services:["0000ffe0-0000-1000-8000-00805f9b34fb"]}]})}catch(t){throw new gh(t)}}onDisconnectCallback(t){this._onDisconnect.emit(t)}async sendCommand(t){let e=new Uint8Array(0);const n=new Promise((async(n,i)=>{this._characteristic.oncharacteristicvaluechanged=async i=>{const s=i.target.value;0===e.length&&(s.byteLength<3||170!=s.getUint8(0)||s.getUint8(3)!=ll.toByte(t,3))||(e=new Uint8Array([...e,...new Uint8Array(s.buffer)]),ml.checkAnswer(e.buffer)&&n(e.buffer))}}));try{await this._characteristic.writeValue(t)}catch(t){console.debug(t)}return await Promise.race([n,fh(500)]),0==e.length?null:e.buffer}async dispose(){try{this._characteristic.oncharacteristicvaluechanged=null,this._device.removeEventListener("gattserverdisconnected",this.onDisconnectCallback),await this._characteristic.stopNotifications()}catch{}}async connect(){try{const t=this._device.gatt;await t.connect();const e=await t.getPrimaryService(yh.serviceUUID);this._characteristic=await e.getCharacteristic(yh.characteristicUUID),await this._characteristic.startNotifications(),this._device.ongattserverdisconnected=this.onDisconnectCallback.bind(this)}catch(t){throw new mh(t)}}async disconnect(){this._characteristic=null,this._device.ongattserverdisconnected=null}}class bh extends vh{}class wh extends bh{_reader;_writer;_onDisconnect=new jr;_device;isConnected;get onDisconnect(){return this._onDisconnect}get deviceVid(){return this._device.getInfo().usbVendorId}get devicePid(){return this._device.getInfo().usbProductId}constructor(t){super(),this._device=t}static async selectDevice(t){try{return await navigator.serial.requestPort({filters:t.map((t=>({usbVendorId:t.vendorId,usbProductId:t.productId})))})}catch(t){throw new gh(t)}}async sendCommand(t){let e=new Uint8Array;const n=new Promise((async(n,i)=>{try{let i=!1;const s=self.setTimeout((()=>{i=!0,n(null)}),800);for(await this._writer.write(new Uint8Array(t));;){const{value:t}=await this._reader.read();e=new Uint8Array([...e,...t]);if(ml.checkAnswer(e)||i)break}self.clearTimeout(s),n(e.buffer)}catch(t){n(null)}}));return await Promise.race([n,fh(300)]),0==e.length?null:e.buffer}read(){return this._reader.read()}write(t){return this._writer.write(new Uint8Array(t))}async dispose(){try{await this.disconnect()}catch{}}async connect(){if(!this.isConnected)try{await this._device.open({baudRate:9600,bufferSize:4408}),this._writer=this._device.writable.getWriter(),this._reader=this._device.readable.getReader(),this._device.ondisconnect=t=>{this._onDisconnect.emit(t)},this.isConnected=!0}catch(t){throw new mh(t,Tt.usbPortAlreadyOpenedError)}}async disconnect(){this.isConnected=!1,await this._writer.close(),await this._reader.cancel(),await this._device.close()}}class Sh extends bh{_hidDevice;_onDisconnect=new jr;isDisposed=!1;_queue=new Vl;isConnected=!1;get onDisconnect(){return this._onDisconnect}get devicePid(){return this._hidDevice.productId}get deviceVid(){return this._hidDevice.vendorId}constructor(t){super(),this._hidDevice=t,this.startProcessor()}async disconnect(){await this._hidDevice.close(),this.isConnected=!1}async connect(){if(!this.isConnected){try{await this._hidDevice.open()}catch(t){throw new mh(t,Tt.usbPortAlreadyOpenedError)}navigator.hid.addEventListener("disconnect",(t=>{this._hidDevice==t.device&&this._onDisconnect.emit(t)})),this.isConnected=!0}}getSource(){return this._hidDevice}static async selectDevice(t){try{const e=(await navigator.hid.requestDevice({filters:t.map((t=>({vendorId:t.vendorId,productId:t.productId})))}))[0];if(!e)throw new DOMException("User cancelled the requestDevice() chooser");return e}catch(t){throw new gh(t)}}async sendCommand(t){const e=new Al(t);return this._queue.push(e),e.awaiter}async process(t){let e=new Uint8Array(0);const n=new Promise((async(t,n)=>{this._hidDevice.oninputreport=async n=>{const i=n.data;e=new Uint8Array([...e,...new Uint8Array(i.buffer)]),ml.checkAnswer(e.buffer)&&t(e.buffer)}}));try{await this._hidDevice.sendReport(3,t)}catch{}return await Promise.race([n,fh(300)]),this._hidDevice.oninputreport=null,0==e.length?null:e.buffer}startProcessor(){(async()=>{for(;!this.isDisposed;){const t=await this._queue.asyncPop();try{const e=await this.process(t.data);t.resolve(e)}catch(e){t.reject(new kl(e))}}})()}async dispose(){try{this.isDisposed=!0,this._hidDevice.oninputreport=null,await this._hidDevice.close()}catch{}}}const _h=new Map([[Bt.OscilloscopeSensor,{name:"Осциллограф",defaultCalibrationSteps:new Lt(0,0),modes:[new Pt({minValue:-2e3,maxValue:2e3,unit:"В",accuracy:2})],vendorId:1155,productId:22336,ico:"Oscill.png"}],[Bt.ColorimeterSensor,{name:"Датчик оптической плотности",vendorId:49374,productId:56164,defaultCalibrationSteps:Lt.Automated,modes:[new Pt({minValue:0,maxValue:2,unit:"D",accuracy:2})],ico:"Colorimeter.png"}],[Bt.OpticalDensitySensor,{name:"Датчик оптической плотности и мутности",defaultCalibrationSteps:new Lt(-1,-1),modes:[new Pt({minValue:0,maxValue:2,unit:"D",accuracy:2,customStringRepresentation:"датчик оптической плотности 470 нм"}),new Pt({minValue:0,maxValue:2,unit:"D",accuracy:2,customStringRepresentation:"датчик оптической плотности 525 нм"}),new Pt({minValue:0,maxValue:2,unit:"D",accuracy:2,customStringRepresentation:"датчик оптической плотности 630 нм"}),new Pt({minValue:0,maxValue:200,unit:"NTU",accuracy:0,customStringRepresentation:"датчик мутности",calibrationSteps:new Lt(2,2)})],vendorId:49374,productId:56165,ico:"OpticalDensitySensor.png"}],[Bt.SoilMoistureSensor,{name:"Датчик влажности почвы",defaultCalibrationSteps:new Lt(2,2),modes:[new Pt({minValue:0,maxValue:50,unit:"%",accuracy:1})],vendorId:49374,productId:56166,ico:"SoilMoistureSensor.png"}],[Bt.SoundSensor,{name:"Датчик звука",defaultCalibrationSteps:new Lt(0,0),modes:[new Pt({minValue:-2e3,maxValue:2e3,accuracy:0,unit:"мПа"})],vendorId:49374,productId:56167,ico:"SoundSensor.png"}],[Bt.CoSensor,{name:"Датчик CO",defaultCalibrationSteps:new Lt(2,2),modes:[new Pt({minValue:0,maxValue:1e3,unit:"ppm",accuracy:0})],vendorId:49374,productId:56168,ico:"CoSensor.png"}],[Bt.UsbLightSensor,{name:"Датчик освещенности",defaultCalibrationSteps:new Lt(1,1),vendorId:49374,modes:[new Pt({minValue:0,maxValue:19e4,unit:"лк",accuracy:0})],productId:56169,ico:"Illumination.png"}],[Bt.CardioSensor,{name:"Электрокардиограф",defaultCalibrationSteps:new Lt(0,0),modes:[new Pt({minValue:-300,maxValue:300,accuracy:0,unit:"мВ"})],vendorId:49374,productId:56170,ico:"Cardio.png"}],[Bt.WristSensor,{name:"Датчик кистевой силы",defaultCalibrationSteps:new Lt(2,2),modes:[new Pt({minValue:0,maxValue:50,unit:"H",accuracy:2})],vendorId:49374,productId:56171,ico:"WristSensor.png"}]]);var $h,Mh;!function(t){t[t.USB=0]="USB",t[t.Bluetooth=1]="Bluetooth"}($h||($h={})),function(t){t.NewHidDeviceFound="NewHidDeviceFound",t.NewComDeviceFound="NewComDeviceFound",t.NewBleDeviceFound="NewBleDeviceFound",t.ConnectDevice="ConnectDevice",t.DisconnectDevice="DisconnectDevice"}(Mh||(Mh={}));const xh=t=>({type:Mh.NewHidDeviceFound,payload:{device:t}}),Ch=t=>({type:Mh.NewComDeviceFound,payload:{device:t}}),kh=t=>({type:Mh.NewBleDeviceFound,payload:{device:t}}),Dh=t=>({type:Mh.ConnectDevice,payload:{device:t}});class Vh{requestAdapter;USE_LEGACY_FORMAT;_diodeColor=dl.None;_onError=new jr;_isConnected=!0;get onError(){return this._onError}get onDisconnect(){return this.requestAdapter.onDisconnect}constructor(t){this.requestAdapter=t,this.USE_LEGACY_FORMAT=t instanceof wh}async getRawSensorValueAsync(){try{const t=this.USE_LEGACY_FORMAT?ml.getValuesComSensors(this._diodeColor):ml.getValuesHidSensors(),e=await this.requestAdapter.sendCommand(t),n=new Uint8Array(e);return 170!=n[0]||170===n[2]||187===n[2]?null:this.USE_LEGACY_FORMAT?$l.parseRawValuesLegacy(e):$l.parseRawValues(e.slice(4))}catch(t){return null}}async setLightColor(t){for(let e=0;e<4;e++)try{const e=this.USE_LEGACY_FORMAT?ml.getValuesComSensors(t):ml.getValuesHidSensors(t);return await this.requestAdapter.sendCommand(e),this._diodeColor=t,!0}catch(t){console.debug(t)}return!1}async getFactorySettings(t){try{const e=await this.requestAdapter.sendCommandOrThrow(ml.getFactorySettingsPartial(32,20));return $l.parseFactorySettingsUsb(e.slice(8))[t]}catch(t){throw new Cl(t)}}async getUserSettings(t){try{const e=await this.requestAdapter.sendCommandOrThrow(ml.getUserSettings(0,24));return $l.parseUserSettingsUsb(e.slice(6))[t]}catch(t){throw new Cl(t)}}async getSensorType(){if(this.requestAdapter instanceof wh){return null!=await this.getRawSensorValueAsync()?At.ColorimeterSensor:At.OscilloscopeSensor}const t=this.requestAdapter.deviceVid,e=this.requestAdapter.devicePid;for(let[n,i]of _h.entries())if(i.productId==e&&i.vendorId==t)return n}async setUserSettings(t,e,n){await this.requestAdapter.sendCommandOrThrow(ml.setUserSettingsUsb(await this.getSensorType(),t||1,e||0,n))}get isConnected(){return this._isConnected}async connect(){await this.requestAdapter.connect(),this._isConnected=!0}async disconnect(){await this.requestAdapter.disconnect(),this._isConnected=!1}}class Ah extends Ll{sensorService;sensorType;get userSettings(){return this._userSettings}get isStarted(){return!!this._updateIntervalId}get accuracy(){return this.mode.accuracy}get calibrationSteps(){return this.mode.calibrationSteps??this._defaultCalibrationSteps}modes;ico;name;_userSettings;factorySettings;latestValue;latestRawValue;_updateIntervalId;_defaultCalibrationSteps;_wasStarted=!1;constructor(t,e){super(),this.sensorService=t,this.sensorType=e;const n=_h.get(e);this.ico=n.ico,this.name=n.name,this.modes=n.modes,this._defaultCalibrationSteps=n.defaultCalibrationSteps,this.reconnect(t)}reconnect(t){this.sensorService=t,this.sensorService.onDisconnect.addEventListener((()=>{const t=this.isStarted||this._wasStarted;this.stop(),this._wasStarted=t})),this._wasStarted&&this.start(),this.sensorService.onError.addEventListener(stop.bind(this))}get service(){return this.sensorService}async init(){return this._userSettings=await this.sensorService.getUserSettings(this.sensorType),this.factorySettings=await this.sensorService.getFactorySettings(this.sensorType),this}getLatestValue(){return this.isConnected?this.latestValue:null}async getValueAsync(){const t=await this.sensorService.getRawSensorValueAsync();return t?(this.latestRawValue=t[this.sensorType],this.convertValue(this.getLatestRawValue())):null}static getSingleValue(t){let e;return e=t instanceof Array?t[0]:t,e}convertValue(t){const e=this.modeIndex;return Rl(t,this.factorySettings?.[e],this._userSettings?.[e])}async update(){const t=await this.getValueAsync();this.latestValue=xl(t,this.accuracy)}async start(){this.isStarted||(this._updateIntervalId=self.setInterval(this.update.bind(this),this.interval.intervalMs))}async stop(){self.clearInterval(this._updateIntervalId),this._updateIntervalId=null,this._wasStarted=!1}async calibrate(t){if(!this._userSettings)return;const e=this._userSettings[this.modeIndex];this._userSettings[this.modeIndex]={...e,...t};try{return await this.sensorService.setUserSettings(t.k,t.delta,this.modeIndex),!0}catch(t){return this._userSettings[this.modeIndex]=e,!1}}getLatestRawValue(){return Ah.getSingleValue(this.latestRawValue)}async dispose(){await this.stop(),await this.sensorService.disconnect()}get isConnected(){return this.sensorService.isConnected}async connect(){await this.sensorService.connect()}async disconnect(){await this.sensorService.disconnect()}get onDisconnect(){return this.sensorService.onDisconnect}}class Th extends Ah{constructor(t){super(t,At.ColorimeterSensor)}async getValueAsync(){if(null==await this.sensorService.getRawSensorValueAsync())return null}convertValue(t){const e=Math.log10((this.factorySettings[0].delta-this.userSettings[0].delta)/t);return Math.max(0,e)}async start(){await this.sensorService.setLightColor(dl.Green),await super.start()}async stop(){await super.stop(),await this.sensorService.setLightColor(dl.None)}async calibrate(){try{const t=await this.getAverageValue();return this.userSettings[0].delta=this.factorySettings[0].delta-t,!0}catch(t){return console.debug(t),!1}}async getAverageValue(){await this.sensorService.setLightColor(dl.Green);const t=[];let e=!1;for(setTimeout((()=>e=!0),3e3);!e;){const e=await this.sensorService.getRawSensorValueAsync();null!==e&&(t.push(e[this.sensorType]),await fh(250))}return this.isStarted||await this.sensorService.setLightColor(dl.None),0==t.length?Promise.reject():t.reduce(((t,e)=>t+e))/t.length}}class Bh extends Error{innerError;constructor(t=null,e=Tt.unknownDevice){super(e),this.innerError=t}}class Lh extends Ah{constructor(t){super(t,At.WristSensor)}convertValue(t){return 9.80000019073486*(t*this.factorySettings[0].k+this.factorySettings[0].delta)/1e3*this.userSettings[0].k+this.userSettings[0].delta}}class Ph extends Bl{requestAdapter;sensorType;settings;device;get onDisconnect(){return this.requestAdapter.onDisconnect}get displayType(){return vl.MainScreen}get onRelease(){return this._onRelease}get isStarted(){return!!this._isStarted}get isConnected(){return this.requestAdapter.isConnected}name;ico;unit;minValue;maxValue;_isStarted=!1;_onRelease=new jr;_intervalTimerId=0;_buffer;_receivedLengthUint=0;_wasStarted=!1;constructor(t,e,n){super(),this.requestAdapter=t,this.sensorType=e,this.settings=n;const i=_h.get(e);this.ico=i.ico,this.name=i.name,this.unit=i.modes[0].unit,this.minValue=i.modes[0].minValue,this.maxValue=i.modes[0].maxValue,this._buffer=new Uint16Array(n.bufferSizeUint),this.onDisconnect.addEventListener((async()=>await this.dispose())),this.reconnect(t)}reconnect(t){this.requestAdapter=t,this.device=t.getSource(),this.device.oninputreport=t=>{this.processResponse(t.data.buffer)}}start(){if(this._isStarted)return;this._isStarted=!0;const t=ml.getBuffer();new Promise((async()=>{for(;this._isStarted;)await this.device.sendReport(3,t),await fh(this.settings.updateTime)}))}stop(){this._isStarted=!1,this._wasStarted=!1}processResponse(t){const e=Ml(0,2*Math.min(new Uint8Array(t,4)[0],this.settings.bufferSizeUint-this._receivedLengthUint),t.byteLength-8),n=new Uint16Array(t.slice(5,5+e));this._buffer.set(n,this._receivedLengthUint),this._receivedLengthUint+=e/2,this._receivedLengthUint==this.settings.bufferSizeUint&&(this.sendBuffer(),this._receivedLengthUint=0)}sendBuffer(){const t=Array(this.settings.bufferSizeUint),e=Array(this.settings.bufferSizeUint);for(let n=0;n<e.length;n++)e[n]=n*this.settings.recordIntervalUsec,t[n]=this.settings.modifier?.(this._buffer[n])??this._buffer[n];this._onRelease.emit([e,t])}async dispose(){await this.requestAdapter.dispose()}async connect(){await this.requestAdapter.connect()}async disconnect(){await this.requestAdapter.disconnect()}}class Eh extends Ah{constructor(t){super(t,At.OpticalDensitySensor)}convertValue(t){let e;switch(this.getColorByMode()){case dl.Blue:e=Math.log10((this.factorySettings[0].delta-this.userSettings[0].delta)/t);break;case dl.Green:e=Math.log10((this.factorySettings[1].delta-this.userSettings[1].delta)/t);break;case dl.Red:e=Math.log10((this.factorySettings[2].delta-this.userSettings[2].delta)/t);break;case dl.IR:e=(t*this.factorySettings[3].k+this.factorySettings[3].delta)*this.userSettings[3].k+this.userSettings[3].delta}return Math.max(0,e)}async start(){await this.sensorService.setLightColor(this.getColorByMode()),await super.start()}getColorByMode(){switch(this.modes.indexOf(this.mode)){case 0:return dl.Blue;case 1:return dl.Green;case 2:return dl.Red;case 3:return dl.IR}}async stop(){await super.stop(),await this.sensorService.setLightColor(dl.None)}async calibrate(t){try{if(t)await this.sensorService.setUserSettings(t.k,t.delta,this.modeIndex),this.userSettings[3]=t;else{const t=await this.getAverageValue(dl.Red),e=await this.getAverageValue(dl.Green),n=await this.getAverageValue(dl.Blue),i=this.factorySettings[0].delta-n,s=this.factorySettings[1].delta-e,r=this.factorySettings[2].delta-t;await this.sensorService.setUserSettings(1,r,2),await this.sensorService.setUserSettings(1,s,1),await this.sensorService.setUserSettings(1,i,0),this.userSettings[0].delta=i,this.userSettings[1].delta=s,this.userSettings[2].delta=r}return!0}catch(t){return console.debug(t),!1}}async getAverageValue(t){await this.sensorService.setLightColor(t);const e=[];let n=!1;for(setTimeout((()=>n=!0),3e3);!n;){const t=await this.sensorService.getRawSensorValueAsync();null!==t&&(e.push(t[this.sensorType][0]),await fh(250))}return this.isStarted||await this.sensorService.setLightColor(dl.None),0==e.length?Promise.reject(new kl):e.reduce(((t,e)=>t+e))/e.length}getLatestRawValue(){const t=this.latestRawValue;return this.modeIndex<3?t[0]:t[1]}}class Ih extends Ah{_calibrationZeroValue;constructor(t){super(t,At.ColorimeterSensor)}async getValueAsync(){const t=await this.sensorService.getRawSensorValueAsync();if(null==t)return null;const e=Math.pow(10,.001*t[Bt.ColorimeterSensor]/.56);return Math.log10(Math.abs(this._calibrationZeroValue/e))}async start(){await this.sensorService.setLightColor(dl.Green),await super.start()}async stop(){await super.stop(),await this.sensorService.setLightColor(dl.None)}async calibrate(){try{return this._calibrationZeroValue=await this.getCalibrationValue(),!0}catch(t){return console.debug(t),!1}}async getCalibrationValue(){await this.sensorService.setLightColor(dl.Green);const t=[];let e=!1;for(setTimeout((()=>e=!0),3e3);!e;){const e=await this.sensorService.getRawSensorValueAsync();null!==e&&(t.push(e[Bt.ColorimeterSensor]),await fh(250))}if(this.isStarted||await this.sensorService.setLightColor(dl.None),0==t.length)return Promise.reject();const n=t.reduce(((t,e)=>t+e))/t.length;return Math.pow(10,.001*n/.56)}}var Rh,zh;!function(t){t[t.Auto=0]="Auto",t[t.Waiting=1]="Waiting",t[t.Single=2]="Single"}(Rh||(Rh={})),function(t){t[t.Up=0]="Up",t[t.Down=1]="Down"}(zh||(zh={}));class Uh extends Bl{requestAdapter;PACKAGE_SIZE=4408;get displayType(){return vl.MainScreen}get onDataUpdated(){return this._onDataUpdated}ico;name;unit;get isConnected(){return this.requestAdapter.isConnected}get buttonTriggerState(){return this._buttonTriggerState}get triggerLevel(){return this._triggerLevel}get triggerChannel(){return this._triggerChannel}get rangeValue(){return this._rangeValue}get rangeOffset(){return this._rangeOffset}get activeChannelNumber(){return this._activeChannelNumber}get channelSettings(){return this._channelSettings}setTriggerLevel(t){this._triggerLevel.next(t)}setTriggerType(t){this._triggerType.next(t)}setTriggerMode(t){this._triggerMode.next(t)}setTriggerChannel(t){this._triggerChannel.next(t)}setRangeValue(t){this._rangeValue.next(t)}setRangeTNumber(t){this._rangeTNumber.next(t)}setRangeOffset(t){this._rangeOffset.next(t)}setActiveChannelNumber(t){this._activeChannelNumber.next(t)}setChannelSettings(t){this._channelSettings.next(t)}_buttonTriggerState=new wc(!0);_triggerLevel=new wc(te.defaultTriggerLevel);_triggerMode=new wc(Rh.Auto);_triggerType=new wc(zh.Up);_triggerChannel=new wc(1);_onDataUpdated=new jr;_dataReceived=0;_dataBuffer=new Uint8Array(this.PACKAGE_SIZE);_updateIsRunning=!1;_rangeValue=new wc(te.defaultRangeValue);_rangeTNumber=new wc(te.defaultRangeTNumber);_rangeOffset=new wc(te.defaultRangeOffset);_activeChannelNumber=new wc(1);_channelSettings=new wc([{range:te.defaultChannelRange,offset:te.defaultChannelOffset,color:te.defaultChannelColor1,visible:!0},{range:te.defaultChannelRange,offset:te.defaultChannelOffset,color:te.defaultChannelColor2,visible:!0}]);get sensorType(){return At.OscilloscopeSensor}constructor(t){super(),this.requestAdapter=t;const e=_h.get(this.sensorType);this.ico=e.ico,this.name=e.name,this.unit=e.modes[0].unit,this._rangeTNumber.subscribe((async t=>{await this.sendSetRangeCommand(this._rangeTNumber.value)})),this._channelSettings.subscribe((async t=>{await this.sendSetAttenuatorCommand(this._activeChannelNumber.value,this.channelSettings.value[0].range/5==200?4:2)})),this._triggerMode.subscribe((t=>{t!==Rh.Auto&&t!==Rh.Waiting||this._buttonTriggerState.next(!0)}))}async startLoop(){for(;this._updateIsRunning;){const t=await this.requestAdapter.read();if(!this._updateIsRunning)break;const e=170==t.value[0]&&170==t.value[1]&&170==t.value[2]&&170==t.value[3];if(0===this._dataReceived&&!e)continue;e&&this._dataReceived&&(this.parseData(this._dataBuffer),this._dataReceived=0);let n=t.value;this.PACKAGE_SIZE<this._dataReceived+t.value.length&&(n=n.slice(0,this.PACKAGE_SIZE-this._dataReceived)),this._dataBuffer.set(n,this._dataReceived),this._dataReceived+=n.length,this._dataReceived>=this.PACKAGE_SIZE&&(this.parseData(this._dataBuffer),this._dataReceived=0)}}async start(){for(let t=0;t<10;t++)await this.requestAdapter.write(ml.oscilloscopeStart());this._updateIsRunning=!0,this.startLoop()}async stop(){this._updateIsRunning=!1,await this.requestAdapter.write(ml.oscilloscopeStop())}async sendSetRangeCommand(t){await this.requestAdapter.write(ml.oscilloscopeRange(t))}async sendSetAttenuatorCommand(t,e){await this.requestAdapter.write(ml.oscilloscopeAttenuator(t,e))}parseData(t){const e=t.slice(8),n=t.slice(4,8),i={channel1:[],channel2:[],time:[]};let s,r=!1,o=0;for(let t=0;t<1100;t++)i.channel1[t]=e[4*t+1]<<8|e[4*t],i.channel2[t]=e[4*t+3]<<8|e[4*t+2],i.time[t]=(n[3]<<24|n[2]<<16|n[1]<<8|n[0])*t,t>=549&&0==r&&(1==this._triggerChannel.value&&(0==this._triggerType.value?(i.channel1[t-1]<<16>>16)/1e3<this._triggerLevel.value&&(i.channel1[t]<<16>>16)/1e3>=this._triggerLevel.value&&(o=t,r=!0):1==this._triggerType.value&&(i.channel1[t-1]<<16>>16)/1e3>this._triggerLevel.value&&(i.channel1[t]<<16>>16)/1e3<=this._triggerLevel.value&&(o=t,r=!0)),2==this._triggerChannel.value&&(0==this._triggerType.value?(i.channel2[t-1]<<16>>16)/1e3<this._triggerLevel.value&&(i.channel2[t]<<16>>16)/1e3>=this._triggerLevel.value&&(o=t,r=!0):1==this._triggerType.value&&(i.channel2[t-1]<<16>>16)/1e3>this._triggerLevel.value&&(i.channel2[t]<<16>>16)/1e3<=this._triggerLevel.value&&(o=t,r=!0)));if(s=n[3]<<24|n[2]<<16|n[1]<<8|n[0],this._buttonTriggerState.value){switch(this._triggerMode.value){case 0:if(r)for(let t=0;t<1100;t++)i.time[t]=i.time[t]-s*o;else for(let t=0;t<1100;t++)i.time[t]=i.time[t]-550*s;break;case 1:if(r)for(let t=0;t<1100;t++)i.time[t]=i.time[t]-s*o;break;case 2:if(r){for(let t=0;t<1100;t++)i.time[t]=i.time[t]-s*o;this._buttonTriggerState.next(!1)}}this._onDataUpdated.emit(i)}}async dispose(){this.stop(),await this.requestAdapter.dispose()}async disconnect(){await this.requestAdapter.disconnect()}async connect(){await this.requestAdapter.connect()}get onDisconnect(){return this.requestAdapter.onDisconnect}}class Nh{static async create(t){const e=new Vh(t),n=await e.getSensorType();switch(n){case At.OscilloscopeSensor:return new Uh(t);case At.UsbLightSensor:return await new Ah(e,At.UsbLightSensor).init();case At.WristSensor:return await new Lh(e).init();case At.SoilMoistureSensor:return await new Ah(e,At.SoilMoistureSensor).init();case At.CoSensor:return await new Ah(e,At.CoSensor).init();case At.OpticalDensitySensor:return await new Eh(e).init();case At.SoundSensor:const i=await e.getFactorySettings(n);return new Ph(t,At.SoundSensor,{updateTime:8,bufferSizeUint:300,recordIntervalUsec:90,modifier:t=>t*i[0].k-1650});case At.CardioSensor:const s=await e.getFactorySettings(n);return new Ph(t,At.CardioSensor,{updateTime:8,bufferSizeUint:2400,recordIntervalUsec:90,modifier:t=>t*s[0].k-1650});case At.ColorimeterSensor:return t instanceof wh?new Ih(e):await new Th(e).init();default:throw new Bh}}}class Oh extends Lc{constructor(t,e){super(t,e)}get labType(){return hl.Bio}availableSensors=[Bt.TempSensor,Bt.PhSensor,Bt.HumiditySensor,Bt.LightSensor,Bt.TempOutsideSensor]}class Fh extends Lc{constructor(t,e){super(t,e)}get labType(){return hl.Eco}availableSensors=[Bt.ConductivitySensor,Bt.TempSensor,Bt.IonomerSensor,Bt.HumiditySensor,Bt.LightSensor,Bt.TempOutsideSensor]}class Wh extends Lc{constructor(t,e){super(t,e)}get labType(){return hl.Chem}availableSensors=[Bt.TempSensor,Bt.PhSensor,Bt.ConductivitySensor]}class Hh extends Lc{availableSensors=[Bt.TempSensor,Bt.AbsolutePressureSensor,Bt.TeslameterSensor,Bt.VoltmeterSensor,Bt.AmmeterSensor,Bt.AccelerometerXSensor,Bt.AccelerometerYSensor,Bt.AccelerometerZSensor];get labType(){return hl.Phys}constructor(t,e){super(t,e)}async setMode(t,e){this.getSensors().filter((t=>t.sensorType===Bt.AccelerometerXSensor||t.sensorType===Bt.AccelerometerYSensor||t.sensorType===Bt.AccelerometerZSensor)).forEach((t=>t._setModeIndex(e))),this.selectedModes[Bt.AccelerometerXSensor]=e,this.selectedModes[Bt.AccelerometerYSensor]=e,this.selectedModes[Bt.AccelerometerZSensor]=e,await super.setMode(t,e)}}class Gh extends Error{innerError;constructor(t=null,e=Tt.unknownLabTypeError){super(e),this.innerError=t}}class jh extends Lc{availableSensors=[Bt.BodyTempSensor,Bt.PulseSensor,Bt.RespirationRateSensor,Bt.AccelerometerXSensor,Bt.AccelerometerYSensor,Bt.AccelerometerZSensor,Bt.ArterialPressureSensor];get labType(){return hl.Phsl}constructor(t,e){super(t,e)}async setMode(t,e){this.getSensors().filter((t=>t.sensorType===Bt.AccelerometerXSensor||t.sensorType===Bt.AccelerometerYSensor||t.sensorType===Bt.AccelerometerZSensor)).forEach((t=>t._setModeIndex(e))),this.selectedModes[Bt.AccelerometerXSensor]=e,this.selectedModes[Bt.AccelerometerYSensor]=e,this.selectedModes[Bt.AccelerometerZSensor]=e,await super.setMode(t,e)}}class Yh{static async create(t,e){const n=new Tl(t);return await Yh.createWithProvider(t,n,e)}static async createWithProvider(t,e,n){switch(await e.getLabType()){case hl.Phys:return await new Hh(t,n).init();case hl.Chem:return await new Wh(t,n).init();case hl.Eco:return await new Fh(t,n).init();case hl.Bio:return await new Oh(t,n).init();case hl.Phsl:return await new jh(t,n).init();case null:throw new kl;default:throw new Gh}}}class Xh extends vh{serialNumber;onDisconnect=new jr;constructor(t){super(),this.serialNumber=t}async sendCommand(t){try{let e,n,i=6;do{console.debug("send command request: ",t);let i=vo+"/send-command";this.serialNumber&&(i+="/"+this.serialNumber),n=await fetch(i,{body:t,method:"POST"}),e=await n.arrayBuffer()}while((0==e.byteLength||0==n.ok)&&i-- >0);return 0==n.ok?Promise.reject(n.status):e}catch(t){return Promise.reject(t)}}get isConnected(){return!0}async connect(){}async disconnect(){}async dispose(){}}class Zh extends vh{labType;constructor(t){super(),this.labType=t}isConnected=!0;dispose(){return Promise.resolve(void 0)}onDisconnect=new jr;async connect(){this.isConnected=!0}async disconnect(){this.isConnected=!1,this.onDisconnect.emit(new Dl)}async sendCommand(t){const e=ll.toByte(t,3);let n;switch(e){case pl.proto_msgType_getInfo:n=new Uint8Array(38),n[0]=170,n[1]=38,n[10]=this.labType;break;case pl.data_exchange:return this.getMockValuesResponse();case pl.get_HW_Config:return this.getMockFactorySettingsResponse();case pl.get_UserData:return this.getMockUserSettingsResponse(this.labType);case pl.proto_msgType_bootloader_get_FW_Cfg:n=new Uint8Array(10),n[0]=170,n[3]=pl.proto_msgType_bootloader_get_FW_Cfg;const t=ll.getStringBytes("123");n.set(t,4);break;default:return console.debug("Incorrect command: "+e),null}return ml.addCrc(n),n.buffer}getMockUserSettingsResponse(t){const e=yl();switch(t){case hl.Phys:e[Bt.TempSensor][0]={k:1,delta:0},e[Bt.TeslameterSensor][0]={k:1,delta:0},e[Bt.VoltmeterSensor][0]={k:1,delta:0},e[Bt.AmmeterSensor][0]={k:1,delta:0},e[Bt.AbsolutePressureSensor][0]={k:1,delta:0};break;case hl.Chem:e[Bt.PhSensor][0]={k:1,delta:0},e[Bt.TempSensor][0]={k:1,delta:0},e[Bt.ConductivitySensor][0]={k:1,delta:0},e[Bt.ConductivitySensor][1]={k:1,delta:0},e[Bt.ConductivitySensor][2]={k:1,delta:0},e[Bt.ConductivitySensor][3]={k:1,delta:0};break;case hl.Eco:e[Bt.TempSensor][0]={k:1,delta:0},e[Bt.ConductivitySensor][0]={k:1,delta:0},e[Bt.ConductivitySensor][1]={k:1,delta:0},e[Bt.ConductivitySensor][2]={k:1,delta:0},e[Bt.ConductivitySensor][3]={k:1,delta:0},e[Bt.TempOutsideSensor][0]={k:1,delta:0},e[Bt.HumiditySensor][0]={k:1,delta:0},e[Bt.LightSensor][0]={k:1,delta:0},e[Bt.PhSensor][0]={k:1,delta:0},e[Bt.IonomerSensor][0]={k:1,delta:0},e[Bt.IonomerSensor][1]={calibrationValues:[{delta:0,value:0},{delta:0,value:0},{delta:0,value:0},{delta:0,value:0},{delta:0,value:0}]},e[Bt.IonomerSensor][2]={calibrationValues:[{delta:0,value:0},{delta:0,value:0},{delta:0,value:0},{delta:0,value:0},{delta:0,value:0}]};break;case hl.Bio:e[Bt.PhSensor][0]={k:1,delta:0},e[Bt.TempSensor][0]={k:1,delta:0},e[Bt.TempOutsideSensor][0]={k:1,delta:0},e[Bt.HumiditySensor][0]={k:1,delta:0},e[Bt.LightSensor][0]={k:1,delta:0};break;case hl.Phsl:e[Bt.BodyTempSensor][0]={k:1,delta:0}}const n=ml.setUserSettings(e,t).map((t=>t.slice(7,-2))),i=n.map((t=>t.length)).reduce(((t,e)=>t+e)),s=new Uint8Array(i);for(let t=0;t<n.length;t++)s.set(n[t],n[t-1]?.length??0);const r=ml.createBaseMessage(6+s.length+2,pl.get_UserData);return r.set(s,6),ml.addCrc(r),r.buffer}getMockValuesResponse(t,e){const n=new Uint8Array(80);e||(n.set(ll.getBytes(1),28),n.set(ll.getBytes(1),30),n.set(ll.getBytes(1),32),n.set(ll.getFloatBytes(1),36),n.set(ll.getBytes(1),40),n.set(ll.getBytes(1),42),n.set(ll.getFloatBytes(1),44),n[51]=0,n[52]=0,n[53]=0,n[54]=1,n.set(ll.getBytes(1),8),n.set(ll.getFloatBytes(1),12),n.set(ll.getFloatBytes(1),16),n.set(ll.getFloatBytes(1),20),n.set(ll.getFloatBytes(self.ConductSensor??=.4),24),t===hl.Eco&&(n.set(ll.getFloatBytes(1),12),n.set(ll.getFloatBytes(1),16)),t===hl.Phsl&&(n.set(ll.getFloatBytes(1),16),n.set(ll.getFloatBytes(1),24))),e==Bt.CoSensor&&n.set(ll.getFloatBytes(1),12),e==Bt.ColorimeterSensor&&n.set(ll.getFloatBytes(1),12),e==Bt.SoilMoistureSensor&&n.set(ll.getFloatBytes(1),12),e==Bt.UsbLightSensor&&n.set(ll.getFloatBytes(1),12),e==Bt.OpticalDensitySensor&&(n.set(ll.getFloatBytes(1),12),n.set(ll.getFloatBytes(1),16));const i=ml.createBaseMessage(4+n.length+2,pl.data_exchange);return i.set(n,4),ml.addCrc(i),i.buffer}getMockFactorySettingsResponse(){const t=[[0,1],[4,0],[8,1],[12,0],[16,1],[20,0],[24,1],[28,0],[32,1],[36,1],[40,0],[44,0],[48,0],[52,0],[56,0],[60,1],[64,0],[68,1],[72,0]],e=ml.createBaseMessage(114,pl.get_HW_Config);e[4]=hl.Bio,e[5]=1;for(const[n,i]of t)e.set(ll.getFloatBytes(i),n+36);return ml.addCrc(e),e.buffer}}class qh{_connectedDevices=new wc([]);_availableUSBDevices=new wc([]);_availableBluetoothDevices=new wc([]);_availableHardwareDevices=new wc([]);_labSensors=new wc([]);_errorMessage=new yc;get availableUSBDevices(){return this._availableUSBDevices}get availableBluetoothDevices(){return this._availableBluetoothDevices}get connectedDevices(){return this._connectedDevices}get labSensors(){return this._labSensors}async reduceAction(t){switch(t.type){case Mh.NewHidDeviceFound:const e=new Sh(t.payload.device);await e.connect();const n=this.getHardwareDeviceByVendorProduct(e.deviceVid,e.devicePid);if(n?.connectionEstablished){const t=n.device;return t instanceof Ah&&t.reconnect(new Vh(e)),t instanceof Ph&&t.reconnect(e),void await this.reduceAction(Dh(t))}const i=await Nh.create(e);if(await i.disconnect(),this.deviceIsAlreadyAvailable(i))return;await this.addAvailableUSBDevice(i,t.payload.device),i.onDisconnect.addEventListener((async()=>{await this.disconnectDevice(i),await this.removeAvailableUSBDevice(i),this.switchHardwareDeviceConnectedPhysically(t.payload.device.vendorId,t.payload.device.productId,!1)}));break;case Mh.NewComDeviceFound:const s=new wh(t.payload.device);await s.connect();const r=this.getHardwareDeviceByVendorProduct(s.deviceVid,s.devicePid);if(r?.connectionEstablished&&r.device instanceof Lc){const t=r.device;return t.reconnect(s),void await this.reduceAction(Dh(t))}let o=null;try{o=await Yh.create(s,$h.USB)}catch(t){o=await Nh.create(s)}if(await o.disconnect(),this.deviceIsAlreadyAvailable(o,$h.USB))return;await this.addAvailableUSBDevice(o,t.payload.device),o.onDisconnect.addEventListener((async()=>{await this.disconnectDevice(o),o instanceof Lc&&await this.disconnectLab(),await this.removeAvailableUSBDevice(o),this.switchHardwareDeviceConnectedPhysically(t.payload.device.getInfo().usbVendorId,t.payload.device.getInfo().usbProductId,!1)}));break;case Mh.NewBleDeviceFound:if(this.bluetoothDeviceIsConnected(t.payload.device))return;const a=new yh(t.payload.device);await a.connect();const l=this.getHardwareDeviceByVendorProduct(null,t.payload.device.id),c=async e=>{await this.disconnectDevice(e),await this.disconnectLab(),await this.removeAvailableBluetoothDevice(e),this.switchHardwareDeviceConnectedPhysically(null,t.payload.device.id,!1)};if(l?.connectionEstablished&&!l.connectedPhysically&&l.device instanceof Lc){const e=l.device;return e.reconnect(a),this.switchHardwareDeviceConnectedPhysically(null,t.payload.device.id,!0),await this.reduceAction(Dh(e)),void e.onDisconnect.addEventListener((async()=>await c(e)))}const u=await Yh.create(a,$h.Bluetooth);if(await u.disconnect(),this.deviceIsAlreadyAvailable(u,$h.Bluetooth))return;await this.addAvailableBluetoothDevice(u,t.payload.device),u.onDisconnect.addEventListener((async()=>await c(u)));break;case Mh.ConnectDevice:if(t.payload.device instanceof Lc&&this.labIsConnected()){const t=this.getLab();await this.disconnectDevice(t),await this.disconnectLab()}await this.connectDevice(t.payload.device),this.switchHardwareDeviceConnectionEstablished(t.payload.device,!0),t.payload.device instanceof Lc&&await this.connectLab(t.payload.device);break;case Mh.DisconnectDevice:await this.disconnectDevice(t.payload.device),this.switchHardwareDeviceConnectionEstablished(t.payload.device,!1),t.payload.device instanceof Lc&&await this.disconnectLab()}}async tryConnectWebLab(t){const e=new Xh(t),n=await Yh.create(e);if(this.labIsConnected()){const t=this.getLab();await this.disconnectDevice(t),await this.disconnectLab()}await this.connectLab(n)}async connectTestLab(t){const e=new Zh(t),n=await Yh.create(e);await this.connectLab(n),this._connectedDevices.next([...this._connectedDevices.value,n])}async addAvailableUSBDevice(t,e){this._availableUSBDevices.next([...this._availableUSBDevices.value,t]);let n=e instanceof SerialPort?e.getInfo().usbVendorId:e.vendorId,i=e instanceof SerialPort?e.getInfo().usbProductId:e.productId;this.getHardwareDeviceByVendorProduct(n,i)?(await this.updateDeviceForHardwareDevices(n,i,t),this.switchHardwareDeviceConnectedPhysically(n,i,!0)):this._availableHardwareDevices.next([...this._availableHardwareDevices.value,{vendorId:n,productId:i,connectedPhysically:!0,connectionEstablished:!1,device:t}])}async addAvailableBluetoothDevice(t,e){this._availableBluetoothDevices.next([...this._availableBluetoothDevices.value,t]);let n=null,i=e.id;this.getHardwareDeviceByVendorProduct(n,i)?(await this.updateDeviceForHardwareDevices(n,i,t),this.switchHardwareDeviceConnectedPhysically(n,i,!0)):this._availableHardwareDevices.next([...this._availableHardwareDevices.value,{vendorId:n,productId:i,connectedPhysically:!0,connectionEstablished:!1,device:t}])}async removeAvailableUSBDevice(t){this._availableUSBDevices.next(this._availableUSBDevices.value.filter((e=>e!==t)))}async removeAvailableBluetoothDevice(t){this._availableBluetoothDevices.next(this._availableBluetoothDevices.value.filter((e=>e!==t)))}async connectDevice(t){try{t instanceof Bl||t instanceof Lc&&t.connectionType===$h.USB?this._availableUSBDevices.next(this._availableUSBDevices.value.filter((e=>e!=t))):this._availableBluetoothDevices.next(this._availableBluetoothDevices.value.filter((e=>e!=t))),this._connectedDevices.next([...this._connectedDevices.value,t]),await t.connect()}catch(t){this._errorMessage.next(t.message||t)}}async disconnectDevice(t){try{await t.disconnect()}catch(t){this._errorMessage.next(t.message||t)}this._connectedDevices.next(this._connectedDevices.value.filter((e=>e!==t))),t instanceof Bl||t instanceof Lc&&t.connectionType===$h.USB?this._availableUSBDevices.next([...this._availableUSBDevices.value,t]):this._availableBluetoothDevices.next([...this._availableBluetoothDevices.value,t])}labIsConnected(){return this._connectedDevices.value.filter((t=>t instanceof Lc)).length>0}getLab(){const t=this._connectedDevices.value.filter((t=>t instanceof Lc));return 0===t.length?null:t[0]}disconnectLab(){this._connectedDevices.next(this._connectedDevices.value.filter((t=>t instanceof Bl))),this._labSensors.next([])}async connectLab(t){this._labSensors.next(t.getSensors())}deviceIsAlreadyAvailable(t,e){return e===$h.Bluetooth?!!this._availableBluetoothDevices.value.find((e=>this.compareDevices(e,t))):!!this._availableUSBDevices.value.find((e=>this.compareDevices(e,t)))}bluetoothDeviceIsConnected(t){const e=this._availableHardwareDevices.value.find((e=>e.productId===t.id));return!!e&&e.connectedPhysically}compareDevices(t,e){return t.name===e.name}labContainsSensor(t){return this._labSensors.value.includes(t)}getHardwareDeviceByVendorProduct(t,e){const n=this._availableHardwareDevices.value.find((n=>n.vendorId===t&&n.productId===e));return n||null}getHardwareDeviceByAvailableDevice(t){const e=this._availableHardwareDevices.value.find((e=>e.device.name===t.name));return e||null}switchHardwareDeviceConnectedPhysically(t,e,n){const i=this._availableHardwareDevices.value,s=this.getHardwareDeviceByVendorProduct(t,e);s&&(i[i.indexOf(s)].connectedPhysically=n,this._availableHardwareDevices.next(i))}switchHardwareDeviceConnectionEstablished(t,e){const n=this._availableHardwareDevices.value,i=this.getHardwareDeviceByAvailableDevice(t);i&&(n[n.indexOf(i)].connectionEstablished=e,this._availableHardwareDevices.next(n))}async updateDeviceForHardwareDevices(t,e,n){const i=this._availableHardwareDevices.value,s=this.getHardwareDeviceByVendorProduct(t,e);s&&s.connectionEstablished&&(s.device instanceof Bl&&(s.device=n,await this.reduceAction(Dh(n))),this._availableHardwareDevices.next(i))}}function Jh(t,e,n){const i=t.slice();return i[28]=e[n],i}function Kh(t,e,n){const i=t.slice();return i[28]=e[n],i}function Qh(t){let e,n;return e=new al({props:{header:Tt.alert,body:t[4],onDismiss:t[17]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.body=t[4]),16&n[0]&&(i.onDismiss=t[17]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function td(t){let e,n,i,s,r,o,a,l,u,h,d,p,f=t[28].name+"";function v(){return t[18](t[28])}return{c(){e=x("div"),n=x("img"),r=k(),o=x("span"),a=C(f),l=k(),u=x("button"),u.textContent=`${Tt.disconnect}`,h=k(),c(n.src,i=t[28].ico)||B(n,"src",i),B(n,"alt",s=t[28].name),B(n,"class","svelte-1docdaa"),B(o,"class","svelte-1docdaa"),B(u,"class","blue-button svelte-1docdaa"),B(e,"class","row sensors align-center svelte-1docdaa")},m(t,i){_(t,e,i),S(e,n),S(e,r),S(e,o),S(o,a),S(e,l),S(e,u),S(e,h),d||(p=V(u,"click",v),d=!0)},p(e,r){t=e,8&r[0]&&!c(n.src,i=t[28].ico)&&B(n,"src",i),8&r[0]&&s!==(s=t[28].name)&&B(n,"alt",s),8&r[0]&&f!==(f=t[28].name+"")&&P(a,f)},d(t){t&&$(e),d=!1,p()}}}function ed(t){let e,n,i,s,r,o,a,l,u,h,d,p,f=t[28].name+"";function v(){return t[22](t[28])}return{c(){e=x("div"),n=x("img"),r=k(),o=x("span"),a=C(f),l=k(),u=x("button"),u.textContent=`${Tt.connect}`,h=k(),c(n.src,i=t[28].ico)||B(n,"src",i),B(n,"alt",s=t[28].name),B(n,"class","svelte-1docdaa"),B(o,"class","svelte-1docdaa"),B(u,"class","blue-button svelte-1docdaa"),B(e,"class","row sensors align-center svelte-1docdaa")},m(t,i){_(t,e,i),S(e,n),S(e,r),S(e,o),S(o,a),S(e,l),S(e,u),S(e,h),d||(p=V(u,"click",v),d=!0)},p(e,r){t=e,262&r[0]&&!c(n.src,i=t[28].ico)&&B(n,"src",i),262&r[0]&&s!==(s=t[28].name)&&B(n,"alt",s),262&r[0]&&f!==(f=t[28].name+"")&&P(a,f)},d(t){t&&$(e),d=!1,p()}}}function nd(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v=Tt.connectToServer+"",g=t[6]&&id(t);return{c(){e=x("div"),n=x("input"),r=k(),o=x("button"),o.textContent=`${Tt.resetServerUrl}`,a=k(),l=x("button"),c=C(v),h=k(),g&&g.c(),d=D(),B(n,"id","server-address"),B(n,"placeholder",i=Tt.serverAddress),B(n,"type","text"),B(o,"class","blue-button connect-button"),B(e,"class","setting-row"),l.disabled=u=!t[0]||!t[9],B(l,"class","blue-button connect-button")},m(i,s){_(i,e,s),S(e,n),E(n,t[9]),S(e,r),S(e,o),_(i,a,s),_(i,l,s),S(l,c),_(i,h,s),g&&g.m(i,s),_(i,d,s),p||(f=[V(n,"input",t[24]),V(o,"click",t[16]),V(l,"click",t[11])],p=!0)},p(t,e){512&e[0]&&n.value!==t[9]&&E(n,t[9]),513&e[0]&&u!==(u=!t[0]||!t[9])&&(l.disabled=u),t[6]?g?g.p(t,e):(g=id(t),g.c(),g.m(d.parentNode,d)):g&&(g.d(1),g=null)},d(t){t&&$(e),t&&$(a),t&&$(l),t&&$(h),g&&g.d(t),t&&$(d),p=!1,s(f)}}}function id(t){let e,n,i=Tt.openRemoteApp+"";return{c(){e=x("a"),n=C(i),B(e,"href",t[6]),B(e,"target","_blank")},m(t,i){_(t,e,i),S(e,n)},p(t,n){64&n[0]&&B(e,"href",t[6])},d(t){t&&$(e)}}}function sd(e){let n,i,s,r,o,a,l,c=e[7]&&rd(e),u=navigator.serial&&function(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.connectLab} USB`,B(n,"class","connect-button blue-button svelte-1docdaa")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[14]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}(e),h=navigator.serial&&function(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.connect} \n                            ${Tt.sensors} COM USB`,B(n,"class","connect-button blue-button svelte-1docdaa")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[13]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}(e);return{c(){n=x("div"),c&&c.c(),i=k(),u&&u.c(),s=k(),h&&h.c(),r=k(),o=x("button"),o.textContent=`${Tt.connect} \n                        ${Tt.sensors.toString().toLowerCase()} USB`,B(o,"class","connect-button blue-button svelte-1docdaa"),B(n,"class","column connection-buttons svelte-1docdaa")},m(t,d){_(t,n,d),c&&c.m(n,null),S(n,i),u&&u.m(n,null),S(n,s),h&&h.m(n,null),S(n,r),S(n,o),a||(l=V(o,"click",e[25]),a=!0)},p(t,e){t[7]?c?c.p(t,e):(c=rd(t),c.c(),c.m(n,i)):c&&(c.d(1),c=null),navigator.serial&&u.p(t,e),navigator.serial&&h.p(t,e)},d(t){t&&$(n),c&&c.d(),u&&u.d(),h&&h.d(),a=!1,l()}}}function rd(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.connectLab} Bluetooth`,B(n,"class","connect-button blue-button svelte-1docdaa")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[15]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function od(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,C,D,A,T,L,P,E,I,R,z,U,N,O,F,W=t[3],H=[];for(let e=0;e<W.length;e+=1)H[e]=td(Kh(t,W,e));let G="USB"===t[8]?t[1]:t[2],j=[];for(let e=0;e<G.length;e+=1)j[e]=ed(Jh(t,G,e));let Y=t[5]&&nd(t),X=!window.ElectronAPI&&sd(t);return{c(){e=x("div"),n=x("div"),i=x("div"),r=x("div"),r.innerHTML="<span>Подключенные</span>",o=k();for(let t=0;t<H.length;t+=1)H[t].c();a=k(),l=x("div"),c=k(),u=x("div"),h=x("div"),d=x("span"),d.textContent="Доступные",p=k(),f=x("div"),v=x("input"),g=k(),m=x("label"),m.textContent="USB",y=k(),b=x("input"),w=k(),C=x("label"),C.textContent="Bluetooth",D=k(),A=x("div");for(let t=0;t<j.length;t+=1)j[t].c();T=k(),L=x("div"),P=x("div"),E=x("div"),I=x("input"),R=k(),z=x("label"),z.textContent=`${Tt.showAdditionalSettings}`,U=k(),Y&&Y.c(),N=k(),X&&X.c(),B(r,"class","row align-center svelte-1docdaa"),B(i,"class","column svelte-1docdaa"),B(l,"class","line svelte-1docdaa"),B(v,"type","radio"),B(v,"id","connect-usb"),B(v,"name","connection-type"),v.__value="USB",v.value=v.__value,B(v,"class","svelte-1docdaa"),t[20][0].push(v),B(m,"for","connect-usb"),B(m,"class","svelte-1docdaa"),B(b,"type","radio"),B(b,"id","connect-bluetooth"),B(b,"name","connection-type"),b.__value="Bluetooth",b.value=b.__value,B(b,"class","svelte-1docdaa"),t[20][0].push(b),B(C,"for","connect-bluetooth"),B(C,"class","channel__channel-label2 svelte-1docdaa"),B(f,"class","row select__connection-type svelte-1docdaa"),B(h,"class","row align-center svelte-1docdaa"),B(A,"class","column sensors align-center svelte-1docdaa"),B(u,"class","column svelte-1docdaa"),B(n,"class","row sensors-connection-menu svelte-1docdaa"),B(I,"id","advanced-checkbox"),B(I,"type","checkbox"),B(I,"class","svelte-1docdaa"),B(z,"for","advanced-checkbox"),B(E,"class","row align-center checkbox-wrapper svelte-1docdaa"),B(P,"class","settings mt-auto svelte-1docdaa"),B(L,"class","row"),B(e,"class","column full")},m(s,$){_(s,e,$),S(e,n),S(n,i),S(i,r),S(i,o);for(let t=0;t<H.length;t+=1)H[t].m(i,null);S(n,a),S(n,l),S(n,c),S(n,u),S(u,h),S(h,d),S(h,p),S(h,f),S(f,v),v.checked=v.__value===t[8],S(f,g),S(f,m),S(f,y),S(f,b),b.checked=b.__value===t[8],S(f,w),S(f,C),S(u,D),S(u,A);for(let t=0;t<j.length;t+=1)j[t].m(A,null);S(e,T),S(e,L),S(L,P),S(P,E),S(E,I),I.checked=t[5],S(E,R),S(E,z),S(P,U),Y&&Y.m(P,null),S(L,N),X&&X.m(L,null),O||(F=[V(v,"change",t[19]),V(b,"change",t[21]),V(I,"change",t[23])],O=!0)},p(t,e){if(1032&e[0]){let n;for(W=t[3],n=0;n<W.length;n+=1){const s=Kh(t,W,n);H[n]?H[n].p(s,e):(H[n]=td(s),H[n].c(),H[n].m(i,null))}for(;n<H.length;n+=1)H[n].d(1);H.length=W.length}if(256&e[0]&&(v.checked=v.__value===t[8]),256&e[0]&&(b.checked=b.__value===t[8]),1286&e[0]){let n;for(G="USB"===t[8]?t[1]:t[2],n=0;n<G.length;n+=1){const i=Jh(t,G,n);j[n]?j[n].p(i,e):(j[n]=ed(i),j[n].c(),j[n].m(A,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=G.length}32&e[0]&&(I.checked=t[5]),t[5]?Y?Y.p(t,e):(Y=nd(t),Y.c(),Y.m(P,null)):Y&&(Y.d(1),Y=null),window.ElectronAPI||X.p(t,e)},d(n){n&&$(e),M(H,n),t[20][0].splice(t[20][0].indexOf(v),1),t[20][0].splice(t[20][0].indexOf(b),1),M(j,n),Y&&Y.d(),X&&X.d(),O=!1,s(F)}}}function ad(t){let e,n,i,s=t[4]&&Qh(t);return n=new ve({props:{ico:"Compass.png",title:Tt.sensors,subtitle:Tt.connectSensors,$$slots:{default:[od]},$$scope:{ctx:t}}}),{c(){s&&s.c(),e=k(),wt(n.$$.fragment)},m(t,r){s&&s.m(t,r),_(t,e,r),St(n,t,r),i=!0},p(t,i){t[4]?s?(s.p(t,i),16&i[0]&&pt(s,1)):(s=Qh(t),s.c(),pt(s,1),s.m(e.parentNode,e)):s&&(ht(),ft(s,1,1,(()=>{s=null})),dt());const r={};1007&i[0]|4&i[1]&&(r.$$scope={dirty:i,ctx:t}),n.$set(r)},i(t){i||(pt(s),pt(n.$$.fragment,t),i=!0)},o(t){ft(s),ft(n.$$.fragment,t),i=!1},d(t){s&&s.d(t),t&&$(e),_t(n,t)}}}function ld(t,e,n){let i;d(t,_o,(t=>n(9,i=t)));let{lab:s}=e,{availableUSBDevices:r}=e,{availableBluetoothDevices:o}=e,{connectedDevices:a}=e,l="",c=!1,u="",h=!1,p="USB";const f=X("connectionVM");navigator.bluetooth?.getAvailability().then((t=>n(7,h=t)));const v=[];for(const[t,e]of _h.entries())v.push({vendorId:e.vendorId,productId:e.productId});function g(t){n(4,l=t.message),t.innerError&&console.debug(t.innerError)}async function m(){try{const t=await Sh.selectDevice(v);await f.reduceAction(xh(t)),n(8,p="USB")}catch(t){g(t)}}return t.$$set=t=>{"lab"in t&&n(0,s=t.lab),"availableUSBDevices"in t&&n(1,r=t.availableUSBDevices),"availableBluetoothDevices"in t&&n(2,o=t.availableBluetoothDevices),"connectedDevices"in t&&n(3,a=t.connectedDevices)},[s,r,o,a,l,c,u,h,p,i,f,async function(){try{const t=await s.getSerialNumber(),e=new URL("/api/lab/connect-lab/"+t,i);e.protocol="wss:",await s.connectToServer(e),n(4,l=Tt.successConnectToServer);const r=new URL("",i);r.searchParams.set(fo,t.toString()),n(6,u=r.toString())}catch(t){console.debug(t),n(4,l=Tt.couldNotConnectToServer)}},m,async function(){try{const t=await wh.selectDevice([{vendorId:1155}]);await f.reduceAction(Ch(t)),n(8,p="USB")}catch(t){g(t)}},async function(){try{const t=await wh.selectDevice([{vendorId:1155}]);await f.reduceAction(Ch(t)),n(8,p="USB")}catch(t){g(t)}},async function(){try{const t=await yh.selectDevice();await f.reduceAction(kh(t)),n(8,p="Bluetooth")}catch(t){g(t)}},function(){w(_o,i=go.toString(),i)},()=>n(4,l=""),t=>f.reduceAction((t=>({type:Mh.DisconnectDevice,payload:{device:t}}))(t)),function(){p=this.__value,n(8,p)},[[]],function(){p=this.__value,n(8,p)},t=>f.reduceAction(Dh(t)),function(){c=this.checked,n(5,c)},function(){i=this.value,_o.set(i)},()=>m()]}class cd extends Mt{constructor(t){super(),$t(this,t,ld,ad,o,{lab:0,availableUSBDevices:1,availableBluetoothDevices:2,connectedDevices:3},null,[-1,-1])}}function ud(t,e,n){const i=t.slice();return i[4]=e[n],i[14]=n,i}function hd(t){let e,n;return e=new ve({props:{title:Tt.offlineLogging_title,subtitle:Tt.offlineLogging_subtitle,ico:"Logging.png",$$slots:{default:[bd]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};32787&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function dd(t){let e,n;return e=new po({props:{archiveValues:t[3],onBack:t[8]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8&n&&(i.archiveValues=t[3]),4&n&&(i.onBack=t[8]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function pd(e){let n,i=Tt.offlineLogging_unknown+"";return{c(){n=C(i)},m(t,e){_(t,n,e)},p:t,d(t){t&&$(n)}}}function fd(e){let n,i=Tt.offlineLogging_processing+"";return{c(){n=C(i)},m(t,e){_(t,n,e)},p:t,d(t){t&&$(n)}}}function vd(e){let n,i=Tt.offlineLogging_loading+"";return{c(){n=C(i)},m(t,e){_(t,n,e)},p:t,d(t){t&&$(n)}}}function gd(e){let n,i=Tt.offlineLogging_empty+"";return{c(){n=C(i)},m(t,e){_(t,n,e)},p:t,d(t){t&&$(n)}}}function md(e){let n,i=Tt.offlineLogging_done+"";return{c(){n=C(i)},m(t,e){_(t,n,e)},p:t,d(t){t&&$(n)}}}function yd(t,e){let n,i,s,r=e[4].stringRepresentation+"";return{key:t,first:null,c(){n=x("option"),i=C(r),n.__value=s=e[4].intervalMs,n.value=n.__value,this.first=n},m(t,e){_(t,n,e),S(n,i)},p(t,n){e=t},d(t){t&&$(n)}}}function bd(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,M,D,A,T,P,I,z,N=[],O=new Map,F=Tt.offlineLogging_button_view+"";function W(t,e){return t[1]===fl.Done?md:t[1]===fl.Empty?gd:t[1]===fl.Loading?vd:t[1]===fl.Processing?fd:pd}let H=W(t),G=H(t),j=wl.Intervals;const Y=t=>t[14];for(let e=0;e<j.length;e+=1){let n=ud(t,j,e),i=Y(n);O.set(i,N[e]=yd(i,n))}return{c(){e=x("div"),n=x("div"),i=x("div"),r=x("label"),r.textContent=`${Tt.status}:`,o=k(),a=x("span"),G.c(),l=k(),c=x("div"),u=x("label"),u.textContent=`${Tt.recording_interval}, ${Tt.milliseconds_short}:`,h=k(),d=x("select");for(let t=0;t<N.length;t+=1)N[t].c();p=k(),f=x("div"),v=x("label"),v.textContent=`${Tt.offlineLogging_recordCount}:`,g=k(),m=x("input"),y=k(),b=x("div"),w=x("button"),w.textContent=`${Tt.offlineLogging_button_start}`,M=k(),D=x("button"),A=C("⚒️ "),T=C(F),B(r,"for","logging-status"),B(a,"id","logging-status"),B(a,"class","setting-value svelte-5g62jb"),B(i,"class","setting-row"),B(u,"for","recording_interval"),B(d,"id","recording_interval"),void 0===t[4]&&it((()=>t[9].call(d))),B(c,"class","setting-row"),B(v,"for","records_count"),B(m,"id","records_count"),B(m,"type","number"),B(m,"min","1"),B(m,"max","100"),B(m,"step","1"),B(f,"class","setting-row"),B(n,"class","settings"),B(w,"class","blue-button"),D.disabled=P=t[1]!==fl.Done,U(D,"blue-button",t[1]===fl.Done),U(D,"red-button",t[1]!==fl.Done),B(b,"class","column buttons svelte-5g62jb"),B(e,"class","full column justify-between")},m(s,$){_(s,e,$),S(e,n),S(n,i),S(i,r),S(i,o),S(i,a),G.m(a,null),S(n,l),S(n,c),S(c,u),S(c,h),S(c,d);for(let t=0;t<N.length;t+=1)N[t].m(d,null);R(d,t[4]),S(n,p),S(n,f),S(f,v),S(f,g),S(f,m),E(m,t[0]),S(e,y),S(e,b),S(b,w),S(b,M),S(b,D),S(D,A),S(D,T),I||(z=[V(d,"change",t[9]),V(m,"input",t[10]),V(w,"click",t[11]),V(D,"click",t[12])],I=!0)},p(t,e){H===(H=W(t))&&G?G.p(t,e):(G.d(1),G=H(t),G&&(G.c(),G.m(a,null))),0&e&&(j=wl.Intervals,N=mt(N,e,Y,1,t,j,O,d,vt,yd,null,ud)),16&e&&R(d,t[4]),1&e&&L(m.value)!==t[0]&&E(m,t[0]),2&e&&P!==(P=t[1]!==fl.Done)&&(D.disabled=P),2&e&&U(D,"blue-button",t[1]===fl.Done),2&e&&U(D,"red-button",t[1]!==fl.Done)},d(t){t&&$(e),G.d();for(let t=0;t<N.length;t+=1)N[t].d();I=!1,s(z)}}}function wd(t){let e,n,i,s;const r=[dd,hd],o=[];function a(t,e){return t[2]?0:1}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,[s]){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function Sd(t,e,n){let{lab:i}=e,s=10,r=10,o=fl.Empty,a=!1,l=null;function c(){i.startOfflineLogging(s,r)}async function u(){n(3,l=await i.getArchiveValues()),l&&n(2,a=!0)}W((async()=>{const t=setInterval((async()=>{const t=await i.getArchiveInfo();n(1,o=t.archiveStatus)}),1e3),e=await i.getArchiveInfo();return n(1,o=e.archiveStatus),n(4,r=e.loggingInterval.intervalMs),n(0,s=e.recordsCount),()=>{clearInterval(t)}}));return t.$$set=t=>{"lab"in t&&n(7,i=t.lab)},[s,o,a,l,r,c,u,i,()=>n(2,a=!1),function(){r=z(this),n(4,r)},function(){s=L(this.value),n(0,s)},()=>c(),()=>u()]}class _d extends Mt{constructor(t){super(),$t(this,t,Sd,wd,o,{lab:7})}}function $d(t){let e,n,i,s;return{c(){e=x("img"),c(e.src,n="arrow.svg")||B(e,"src","arrow.svg"),B(e,"alt","Свернуть"),B(e,"class","arrow svelte-1pq1d0o"),U(e,"nestedAreHidden",t[9])},m(n,r){_(n,e,r),i||(s=V(e,"click",t[14]),i=!0)},p(t,n){512&n&&U(e,"nestedAreHidden",t[9])},d(t){t&&$(e),i=!1,s()}}}function Md(e){let n,i,s,r,o,a,l,u,h,d=e[7]&&!e[10]&&$d(e);return{c(){n=x("div"),i=x("img"),r=k(),o=x("span"),a=C(e[3]),l=k(),d&&d.c(),c(i.src,s=e[1])||B(i,"src",s),B(i,"alt",e[2]),B(i,"class","icon svelte-1pq1d0o"),B(o,"class","svelte-1pq1d0o"),B(n,"class","menu-item svelte-1pq1d0o"),U(n,"selected",e[0]),U(n,"large",e[4]),U(n,"collapsed",e[6]),U(n,"noPadding",e[5]),U(n,"isHidden",e[8])},m(t,s){_(t,n,s),S(n,i),S(n,r),S(n,o),S(o,a),S(n,l),d&&d.m(n,null),u||(h=V(n,"click",e[13]),u=!0)},p(t,[e]){2&e&&!c(i.src,s=t[1])&&B(i,"src",s),4&e&&B(i,"alt",t[2]),8&e&&P(a,t[3]),t[7]&&!t[10]?d?d.p(t,e):(d=$d(t),d.c(),d.m(n,null)):d&&(d.d(1),d=null),1&e&&U(n,"selected",t[0]),16&e&&U(n,"large",t[4]),64&e&&U(n,"collapsed",t[6]),32&e&&U(n,"noPadding",t[5]),256&e&&U(n,"isHidden",t[8])},i:t,o:t,d(t){t&&$(n),d&&d.d(),u=!1,h()}}}function xd(t,e,n){let i,{selected:s=!1}=e,{imageSrc:r}=e,{imageAlt:o=r??""}=e,{label:a}=e,{large:l=!1}=e,{noPadding:c=!1}=e,{collapsed:u=!1}=e,{containsNestedElements:h=!1}=e,{isHidden:p=!1}=e,f=!1;const v=j();let g=X(iu.IsPhoneSize);d(t,g,(t=>n(10,i=t)));return t.$$set=t=>{"selected"in t&&n(0,s=t.selected),"imageSrc"in t&&n(1,r=t.imageSrc),"imageAlt"in t&&n(2,o=t.imageAlt),"label"in t&&n(3,a=t.label),"large"in t&&n(4,l=t.large),"noPadding"in t&&n(5,c=t.noPadding),"collapsed"in t&&n(6,u=t.collapsed),"containsNestedElements"in t&&n(7,h=t.containsNestedElements),"isHidden"in t&&n(8,p=t.isHidden)},[s,r,o,a,l,c,u,h,p,f,i,v,g,function(e){Z.call(this,t,e)},t=>{t.stopPropagation(),n(9,f=!f),v("nestedHide")}]}class Cd extends Mt{constructor(t){super(),$t(this,t,xd,Md,o,{selected:0,imageSrc:1,imageAlt:2,label:3,large:4,noPadding:5,collapsed:6,containsNestedElements:7,isHidden:8})}}function kd(t,e,n){const i=t.slice();return i[16]=e[n],i}function Dd(t){let e,n,i,s=t[16].label+"";return{c(){e=x("option"),n=C(s),e.__value=i=t[16],e.value=e.__value},m(t,i){_(t,e,i),S(e,n)},p(t,r){2&r&&s!==(s=t[16].label+"")&&P(n,s),2&r&&i!==(i=t[16])&&(e.__value=i,e.value=e.__value)},d(t){t&&$(e)}}}function Vd(t){let e,n,i,s,r,o=Tt.startRecording+"";return{c(){e=x("button"),n=C(o),B(e,"class","blue-button control-buttons svelte-19ipbnk"),e.disabled=i=!t[0]},m(i,o){_(i,e,o),S(e,n),s||(r=V(e,"click",t[5]),s=!0)},p(t,n){1&n&&i!==(i=!t[0])&&(e.disabled=i)},d(t){t&&$(e),s=!1,r()}}}function Ad(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.stopRecording}`,B(n,"class","red-button control-buttons svelte-19ipbnk")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[6]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function Td(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.start}`,B(n,"class","blue-button control-buttons svelte-19ipbnk")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[7]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function Bd(e){let n,i,s;return{c(){n=x("button"),n.textContent=`${Tt.stop}`,B(n,"class","red-button control-buttons svelte-19ipbnk")},m(t,r){_(t,n,r),i||(s=V(n,"click",e[8]),i=!0)},p:t,d(t){t&&$(n),i=!1,s()}}}function Ld(t){let e,n,i,r,o,a,l,c,u,h,d,p,f,v,g,m,y,b,w,D,A,T,L,P,E,I,z,U=Tt.takeAPicture+"",N=Tt.video_startStreamMessage+"",O=t[1],F=[];for(let e=0;e<O.length;e+=1)F[e]=Dd(kd(t,O,e));function W(t,e){return t[4]?Ad:Vd}let H=W(t),G=H(t);function j(t,e){return null!=t[0]?Bd:Td}let Y=j(t),X=Y(t);return{c(){e=x("div"),n=x("div"),i=x("div"),r=x("label"),r.textContent=`${Tt.devices}:`,o=k(),a=x("select");for(let t=0;t<F.length;t+=1)F[t].c();l=k(),c=x("div"),u=x("label"),u.textContent=`${Tt.recording}:`,h=k(),G.c(),d=k(),p=x("div"),f=x("label"),f.textContent=`${Tt.takeAPicture}:`,v=k(),g=x("button"),m=C(U),b=k(),X.c(),w=k(),D=x("div"),A=x("video"),L=k(),P=x("div"),E=C(N),B(r,"class","settings-label svelte-19ipbnk"),B(a,"class","camera-selector svelte-19ipbnk"),a.disabled=t[0],void 0===t[2]&&it((()=>t[10].call(a))),B(i,"class","row align-center justify-between"),B(u,"class","settings-label svelte-19ipbnk"),B(c,"class","row align-center"),B(f,"class","settings-label svelte-19ipbnk"),B(g,"class","blue-button control-buttons svelte-19ipbnk"),g.disabled=y=!t[0],B(p,"class","row align-center"),B(n,"class","camera-settings svelte-19ipbnk"),B(A,"class","m-auto w-full"),A.hidden=T=!t[0],B(P,"class","connection-message svelte-19ipbnk"),P.hidden=t[0],B(D,"class","video-box full svelte-19ipbnk"),B(e,"class","wrapper gap-sm full svelte-19ipbnk")},m(s,y){_(s,e,y),S(e,n),S(n,i),S(i,r),S(i,o),S(i,a);for(let t=0;t<F.length;t+=1)F[t].m(a,null);R(a,t[2]),S(n,l),S(n,c),S(c,u),S(c,h),G.m(c,null),S(n,d),S(n,p),S(p,f),S(p,v),S(p,g),S(g,m),S(n,b),X.m(n,null),S(e,w),S(e,D),S(D,A),t[11](A),S(D,L),S(D,P),S(P,E),I||(z=[V(a,"change",t[10]),V(a,"change",t[8]),V(g,"click",t[9])],I=!0)},p(t,e){if(2&e){let n;for(O=t[1],n=0;n<O.length;n+=1){const i=kd(t,O,n);F[n]?F[n].p(i,e):(F[n]=Dd(i),F[n].c(),F[n].m(a,null))}for(;n<F.length;n+=1)F[n].d(1);F.length=O.length}1&e&&(a.disabled=t[0]),6&e&&R(a,t[2]),H===(H=W(t))&&G?G.p(t,e):(G.d(1),G=H(t),G&&(G.c(),G.m(c,null))),1&e&&y!==(y=!t[0])&&(g.disabled=y),Y===(Y=j(t))&&X?X.p(t,e):(X.d(1),X=Y(t),X&&(X.c(),X.m(n,null))),1&e&&T!==(T=!t[0])&&(A.hidden=T),1&e&&(P.hidden=t[0])},d(n){n&&$(e),M(F,n),G.d(),X.d(),t[11](null),I=!1,s(z)}}}function Pd(t){let e,n;return e=new ve({props:{title:Tt.camera,ico:"CameraSensor.png",$$slots:{default:[Ld]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};524319&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}const Ed="video/webm";function Id(t,e,n){let i,s,r,o=null,a=[],l=null,c=window.videoRecorder??null;function u(t){s.push(t.data)}function h(){r=URL.createObjectURL(new Blob(s,{type:Ed})),Ut(r,`${Tt.exportCameraVideoFileName}.webm`),c.removeEventListener("dataavailable",u),c.removeEventListener("stop",h)}async function d(){c&&(c.stop(),n(4,c=null))}async function p(){o&&(await d(),n(3,i.srcObject=null,i),i.pause(),n(0,o=null))}return W((async()=>{await p();const t=await navigator.mediaDevices.enumerateDevices();return n(1,a=t.filter((t=>"videoinput"===t.kind))),l||n(2,l=a[0]),()=>{p()}})),[o,a,l,i,c,async function(){n(4,c=new MediaRecorder(o,{mimeType:Ed})),window.videoRecorder=c,s=[],c.addEventListener("dataavailable",u),c.addEventListener("stop",h),c.start()},d,async function(){n(0,o=await navigator.mediaDevices.getUserMedia({video:{deviceId:l.deviceId}})),n(3,i.srcObject=o,i),await i.play()},p,function(){const t=window.document.createElement("canvas");t.width=i.videoWidth,t.height=i.videoHeight,t.getContext("2d").drawImage(i,0,0,i.videoWidth,i.videoHeight),Ut(t.toDataURL("image/jpeg"),`${Tt.exportCameraImageFileName}.jpg`)},function(){l=z(this),n(2,l),n(1,a)},function(t){J[t?"unshift":"push"]((()=>{i=t,n(3,i)}))}]}class Rd extends Mt{constructor(t){super(),$t(this,t,Id,Pd,o,{})}}var zd;function Ud(t){let e,n,i,o,a,l,c,u,h,d,p,f,v,g,m={chartDataList:[t[2]],labelX:`${t[0].name} [${t[0].unit}]`,autoscale:!1,showLegend:!1,numberOfVisiblePoints:t[0].settings.bufferSizeUint,chartAlignment:Hr.MiddleCenter};return p=new ao({props:m}),t[5](p),{c(){e=x("div"),n=x("div"),i=x("button"),i.innerHTML='<img src="ico_download.png"/>',o=k(),a=x("button"),a.innerHTML='<img src="ico_zoom.png" alt="zoom"/>',l=k(),c=x("button"),c.innerHTML='<img src="ico_zoom_out.png" alt="zoom_out"/>',u=k(),h=x("button"),h.innerHTML='<img src="ico_zoom_in.png" alt="zoom_in"/>',d=k(),wt(p.$$.fragment),B(n,"class","control-buttons svelte-1vh7c8i"),B(e,"class","full chart-wrapper svelte-1vh7c8i")},m(s,m){_(s,e,m),S(e,n),S(n,i),S(n,o),S(n,a),S(n,l),S(n,c),S(n,u),S(n,h),S(e,d),St(p,e,null),f=!0,v||(g=[V(i,"click",t[3]),V(a,"click",(function(){r(t[1].resetZoom)&&t[1].resetZoom.apply(this,arguments)})),V(c,"click",(function(){r(t[1].zoomOut)&&t[1].zoomOut.apply(this,arguments)})),V(h,"click",(function(){r(t[1].zoomIn)&&t[1].zoomIn.apply(this,arguments)}))],v=!0)},p(e,n){t=e;const i={};1&n&&(i.labelX=`${t[0].name} [${t[0].unit}]`),1&n&&(i.numberOfVisiblePoints=t[0].settings.bufferSizeUint),p.$set(i)},i(t){f||(pt(p.$$.fragment,t),f=!0)},o(t){ft(p.$$.fragment,t),f=!1},d(n){n&&$(e),t[5](null),_t(p),v=!1,s(g)}}}function Nd(t){let e,n;return e=new ve({props:{title:t[0].name,ico:t[0].ico,$$slots:{default:[Ud]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};1&n&&(i.title=t[0].name),1&n&&(i.ico=t[0].ico),131&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Od(t,e,n){let i,{sensor:s}=e,{label:r}=e,o=new lo(s.name,s.unit,{minValue:s.minValue,maxValue:s.maxValue},{markerSize:0});W((()=>{const t=([t,e])=>{o.setRecords(t.map(((n,i)=>({time:t[i],value:e[i]}))))};return s.onRelease.addEventListener(t),s.start(),()=>{s.stop(),s.onRelease.removeEventListener(t)}}));return t.$$set=t=>{"sensor"in t&&n(0,s=t.sensor),"label"in t&&n(4,r=t.label)},[s,i,o,()=>{Ut(i.getImageUri(),Tt.exportExperimentImageFileName+".jpg")},r,function(t){J[t?"unshift":"push"]((()=>{i=t,n(1,i)}))}]}!function(t){t[t.SaveAsExcel=0]="SaveAsExcel",t[t.SaveImage=1]="SaveImage",t[t.SendToCloud=2]="SendToCloud",t[t.SetPause=3]="SetPause",t[t.SelectSensor=4]="SelectSensor",t[t.HideExperimentDoneMessage=5]="HideExperimentDoneMessage",t[t.HideLoadFailedMessage=6]="HideLoadFailedMessage"}(zd||(zd={}));class Fd extends Mt{constructor(t){super(),$t(this,t,Od,Nd,o,{sensor:0,label:4})}}function Wd(t,e,n){const i=t.slice();return i[6]=e[n],i[7]=e,i[8]=n,i}function Hd(t){let e,n=(t[6].inSensorPack?Tt.connected:Tt.disconnected)+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p(t,i){1&i&&n!==(n=(t[6].inSensorPack?Tt.connected:Tt.disconnected)+"")&&P(e,n)},d(t){t&&$(e)}}}function Gd(t){let e,n,i,s,r,o,a,l,u,h,d,p,f=t[6].name+"",v=!t[1]&&Hd(t);function g(){return t[4](t[6],t[7],t[8])}return{c(){e=x("div"),n=x("img"),r=k(),o=x("span"),a=C(f),l=k(),u=x("button"),v&&v.c(),h=k(),c(n.src,i=t[6].ico)||B(n,"src",i),B(n,"alt",s=t[6].name),B(u,"class","svelte-qmvneo"),U(u,"blue-button",t[6].inSensorPack),U(u,"red-button",!t[6].inSensorPack),I(u,"background",t[1]?`url(${t[6].inSensorPack?"Check.png":"Cross.png"}) 100%/100% no-repeat`:"",!1),B(e,"class","sensor-grid__item svelte-qmvneo")},m(t,i){_(t,e,i),S(e,n),S(e,r),S(e,o),S(o,a),S(e,l),S(e,u),v&&v.m(u,null),S(e,h),d||(p=V(u,"click",g),d=!0)},p(e,r){t=e,1&r&&!c(n.src,i=t[6].ico)&&B(n,"src",i),1&r&&s!==(s=t[6].name)&&B(n,"alt",s),1&r&&f!==(f=t[6].name+"")&&P(a,f),t[1]?v&&(v.d(1),v=null):v?v.p(t,r):(v=Hd(t),v.c(),v.m(u,null)),1&r&&U(u,"blue-button",t[6].inSensorPack),1&r&&U(u,"red-button",!t[6].inSensorPack),3&r&&I(u,"background",t[1]?`url(${t[6].inSensorPack?"Check.png":"Cross.png"}) 100%/100% no-repeat`:"",!1)},d(t){t&&$(e),v&&v.d(),d=!1,p()}}}function jd(t){let e,n=t[0],i=[];for(let e=0;e<n.length;e+=1)i[e]=Gd(Wd(t,n,e));return{c(){e=x("div");for(let t=0;t<i.length;t+=1)i[t].c();B(e,"class","sensor-grid")},m(t,n){_(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null)},p(t,s){if(3&s){let r;for(n=t[0],r=0;r<n.length;r+=1){const o=Wd(t,n,r);i[r]?i[r].p(o,s):(i[r]=Gd(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){t&&$(e),M(i,t)}}}function Yd(t){let e,n;return e=new ve({props:{title:Tt.sensorsPack,subtitle:Tt.sensorsPackSubtitle,ico:"Pack.png",$$slots:{default:[jd]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};515&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Xd(t,e,n){let i,{sensors:s=[]}=e,{sensorsPack:r=[]}=e;const o=X(iu.IsPhoneSize);d(t,o,(t=>n(1,i=t)));return t.$$set=t=>{"sensors"in t&&n(0,s=t.sensors),"sensorsPack"in t&&n(3,r=t.sensorsPack)},[s,i,o,r,(t,e,i)=>n(0,e[i].inSensorPack=!t.inSensorPack,s)]}class Zd extends Mt{constructor(t){super(),$t(this,t,Xd,Yd,o,{sensors:0,sensorsPack:3})}}function qd(t,e,n){const i=t.slice();return i[5]=e[n],i[6]=e,i[7]=n,i}function Jd(t){let e,n=(t[5].isVisibleInMenu?Tt.connected:Tt.disconnected)+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p(t,i){1&i&&n!==(n=(t[5].isVisibleInMenu?Tt.connected:Tt.disconnected)+"")&&P(e,n)},d(t){t&&$(e)}}}function Kd(t){let e,n,i,s,r,o,a,l,u,h,d,p,f=t[5].name+"",v=!t[1]&&Jd(t);function g(){return t[4](t[5],t[6],t[7])}return{c(){e=x("div"),n=x("img"),r=k(),o=x("span"),a=C(f),l=k(),u=x("button"),v&&v.c(),h=k(),c(n.src,i=t[5].ico)||B(n,"src",i),B(n,"alt",s=t[5].name),B(u,"class","svelte-qmvneo"),U(u,"blue-button",t[5].isVisibleInMenu),U(u,"red-button",!t[5].isVisibleInMenu),I(u,"background",t[1]?`url(${t[5].isVisibleInMenu?"Check.png":"Cross.png"}) 100%/100% no-repeat`:"",!1),B(e,"class","sensor-grid__item svelte-qmvneo")},m(t,i){_(t,e,i),S(e,n),S(e,r),S(e,o),S(o,a),S(e,l),S(e,u),v&&v.m(u,null),S(e,h),d||(p=V(u,"click",g),d=!0)},p(e,r){t=e,1&r&&!c(n.src,i=t[5].ico)&&B(n,"src",i),1&r&&s!==(s=t[5].name)&&B(n,"alt",s),1&r&&f!==(f=t[5].name+"")&&P(a,f),t[1]?v&&(v.d(1),v=null):v?v.p(t,r):(v=Jd(t),v.c(),v.m(u,null)),1&r&&U(u,"blue-button",t[5].isVisibleInMenu),1&r&&U(u,"red-button",!t[5].isVisibleInMenu),3&r&&I(u,"background",t[1]?`url(${t[5].isVisibleInMenu?"Check.png":"Cross.png"}) 100%/100% no-repeat`:"",!1)},d(t){t&&$(e),v&&v.d(),d=!1,p()}}}function Qd(t){let e,n=t[0],i=[];for(let e=0;e<n.length;e+=1)i[e]=Kd(qd(t,n,e));return{c(){e=x("div");for(let t=0;t<i.length;t+=1)i[t].c();B(e,"class","sensor-grid")},m(t,n){_(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null)},p(t,s){if(11&s){let r;for(n=t[0],r=0;r<n.length;r+=1){const o=qd(t,n,r);i[r]?i[r].p(o,s):(i[r]=Kd(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){t&&$(e),M(i,t)}}}function tp(t){let e,n;return e=new ve({props:{title:Tt.sensorsVisibilityTitle,ico:"Multisensor.png",$$slots:{default:[Qd]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};259&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function ep(t,e,n){let i,{sensors:s}=e;const r=X(iu.IsPhoneSize);d(t,r,(t=>n(1,i=t)));const o=j();console.debug(s);return t.$$set=t=>{"sensors"in t&&n(0,s=t.sensors)},[s,i,r,o,(t,e,i)=>{n(0,e[i].isVisibleInMenu=!t.isVisibleInMenu,s),o("sensorUpdate")}]}class np extends Mt{constructor(t){super(),$t(this,t,ep,tp,o,{sensors:0})}}function ip(t,e,n){const i=t.slice();return i[50]=e[n],i[52]=n,i}function sp(t){let e,n;return e=new Pu({props:{onClose:t[27],onSubmit:t[26],isPassword:!0,header:Tt.calibration_writeAPasswordModalHeader,errorMessage:t[6]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};32&n[0]&&(i.onClose=t[27]),64&n[0]&&(i.errorMessage=t[6]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function rp(t){let e,n;return e=new Za({}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function op(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:"Лаборатория",selected:t[8]===t[7].sensorsVisibility,imageSrc:"Multisensor.png",imageAlt:"Лаборатория",noPadding:!0,containsNestedElements:!0}}),e.$on("click",t[30]),e.$on("nestedHide",t[31]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.collapsed=!t[13]),384&n[0]&&(i.selected=t[8]===t[7].sensorsVisibility),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function ap(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:t[50].name,selected:t[8]===t[7].sensor&&t[9]===t[52],imageSrc:t[50].ico,imageAlt:t[50].name,isHidden:!!t[17].labContainsSensor(t[50])&&t[11],noPadding:!t[17].labContainsSensor(t[50])}}),e.$on("click",(function(){return t[32](t[52])})),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(n,i){t=n;const s={};8192&i[0]&&(s.collapsed=!t[13]),4096&i[0]&&(s.label=t[50].name),4992&i[0]&&(s.selected=t[8]===t[7].sensor&&t[9]===t[52]),4096&i[0]&&(s.imageSrc=t[50].ico),4096&i[0]&&(s.imageAlt=t[50].name),6144&i[0]&&(s.isHidden=!!t[17].labContainsSensor(t[50])&&t[11]),4096&i[0]&&(s.noPadding=!t[17].labContainsSensor(t[50])),e.$set(s)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function lp(t,e){let n,i,s,r=e[50].isVisibleInMenu&&ap(e);return{key:t,first:null,c(){n=D(),r&&r.c(),i=D(),this.first=n},m(t,e){_(t,n,e),r&&r.m(t,e),_(t,i,e),s=!0},p(t,n){(e=t)[50].isVisibleInMenu?r?(r.p(e,n),4096&n[0]&&pt(r,1)):(r=ap(e),r.c(),pt(r,1),r.m(i.parentNode,i)):r&&(ht(),ft(r,1,1,(()=>{r=null})),dt())},i(t){s||(pt(r),s=!0)},o(t){ft(r),s=!1},d(t){t&&$(n),r&&r.d(t),t&&$(i)}}}function cp(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:Tt.camera,selected:t[8]===t[7].camera,imageSrc:"CameraSensor.png"}}),e.$on("click",t[33]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.collapsed=!t[13]),384&n[0]&&(i.selected=t[8]===t[7].camera),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function up(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:Tt.sensorsPack,selected:t[8]===t[7].sensorsPack,imageSrc:"Pack.png"}}),e.$on("click",t[35]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.collapsed=!t[13]),384&n[0]&&(i.selected=t[8]===t[7].sensorsPack),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function hp(t){let e,n,i,s=t[22]&&function(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:Tt.wifiSettings,selected:t[8]===t[7].wifiSettings,imageSrc:"wifi.svg"}}),e.$on("click",t[36]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.collapsed=!t[13]),384&n[0]&&(i.selected=t[8]===t[7].wifiSettings),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}(t);return n=new Cd({props:{collapsed:!t[13],label:Tt.offlineLogging_title,selected:t[8]===t[7].offlineLogging,imageSrc:"Logging.png"}}),n.$on("click",t[37]),{c(){s&&s.c(),e=k(),wt(n.$$.fragment)},m(t,r){s&&s.m(t,r),_(t,e,r),St(n,t,r),i=!0},p(t,e){t[22]&&s.p(t,e);const i={};8192&e[0]&&(i.collapsed=!t[13]),384&e[0]&&(i.selected=t[8]===t[7].offlineLogging),n.$set(i)},i(t){i||(pt(s),pt(n.$$.fragment,t),i=!0)},o(t){ft(s),ft(n.$$.fragment,t),i=!1},d(t){s&&s.d(t),t&&$(e),_t(n,t)}}}function dp(t){let e,n;return e=new Cd({props:{collapsed:!t[13],label:Tt.calibrationTitle,selected:t[8]===t[7].calibration,imageSrc:"Calibr.png"}}),e.$on("click",t[38]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.collapsed=!t[13]),384&n[0]&&(i.selected=t[8]===t[7].calibration),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function pp(t){let e,n;return e=new np({props:{sensors:t[12].filter(t[45])}}),e.$on("sensorUpdate",t[46]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4100&n[0]&&(i.sensors=t[12].filter(t[45])),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function fp(t){let e,n;return e=new nu({props:{lab:t[2]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n[0]&&(i.lab=t[2]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function vp(e){let n,i;return n=new Rd({}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function gp(t){let e,n;return e=new ku({props:{sensors:t[0]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n[0]&&(i.sensors=t[0]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function mp(t){let e,n;return e=new Zd({props:{sensors:t[0].filter(t[43]),sensorsPack:t[3]}}),e.$on("sensor-pack-changed",t[44]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};1&n[0]&&(i.sensors=t[0].filter(t[43])),8&n[0]&&(i.sensorsPack=t[3]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function yp(e){let n,i;return n=new rh({}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function bp(t){let e,n,i,s;const r=[_p,Sp],o=[];function a(t,e){return t[12][t[9]]instanceof Ph?0:1}return e=a(t),n=o[e]=r[e](t),{c(){n.c(),i=D()},m(t,n){o[e].m(t,n),_(t,i,n),s=!0},p(t,s){let l=e;e=a(t),e===l?o[e].p(t,s):(ht(),ft(o[l],1,1,(()=>{o[l]=null})),dt(),n=o[e],n?n.p(t,s):(n=o[e]=r[e](t),n.c()),pt(n,1),n.m(i.parentNode,i))},i(t){s||(pt(n),s=!0)},o(t){ft(n),s=!1},d(t){o[e].d(t),t&&$(i)}}}function wp(t){let e,n;return e=new cd({props:{lab:t[2],availableUSBDevices:t[14],availableBluetoothDevices:t[15],connectedDevices:t[16]}}),e.$on("lab-connected",t[41]),e.$on("sensor-connected",t[42]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n[0]&&(i.lab=t[2]),16384&n[0]&&(i.availableUSBDevices=t[14]),32768&n[0]&&(i.availableBluetoothDevices=t[15]),65536&n[0]&&(i.connectedDevices=t[16]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Sp(t){let e,n;return e=new Ju({props:{sensor:t[12][t[9]]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4608&n[0]&&(i.sensor=t[12][t[9]]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function _p(t){let e,n;return e=new Fd({props:{sensor:t[12][t[9]],label:`${t[12][t[9]].name} [${t[12][t[9]].unit}]`}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4608&n[0]&&(i.sensor=t[12][t[9]]),4608&n[0]&&(i.label=`${t[12][t[9]].name} [${t[12][t[9]].unit}]`),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function $p(t){let e,n,i,s=t[8]===t[7].wifiSettings&&Mp(),r=t[8]===t[7].offlineLogging&&xp(t);return{c(){s&&s.c(),e=k(),r&&r.c(),n=D()},m(t,o){s&&s.m(t,o),_(t,e,o),r&&r.m(t,o),_(t,n,o),i=!0},p(t,i){t[8]===t[7].wifiSettings?s?384&i[0]&&pt(s,1):(s=Mp(),s.c(),pt(s,1),s.m(e.parentNode,e)):s&&(ht(),ft(s,1,1,(()=>{s=null})),dt()),t[8]===t[7].offlineLogging?r?(r.p(t,i),384&i[0]&&pt(r,1)):(r=xp(t),r.c(),pt(r,1),r.m(n.parentNode,n)):r&&(ht(),ft(r,1,1,(()=>{r=null})),dt())},i(t){i||(pt(s),pt(r),i=!0)},o(t){ft(s),ft(r),i=!1},d(t){s&&s.d(t),t&&$(e),r&&r.d(t),t&&$(n)}}}function Mp(t){let e,n;return e=new uh({}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function xp(t){let e,n;return e=new _d({props:{lab:t[2]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n[0]&&(i.lab=t[2]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Cp(t){let e,n,i,s,r,o,a,l,u,h,d,p,f,v,g,m,y,b,w,M,C,D,A,T,L,P,E,I,R,z,N,O,F,W,H,G,j,Y=[],X=new Map,Z=t[5]&&sp(t);function q(e){t[28](e)}let K={};void 0!==t[13]&&(K.value=t[13]),r=new ph({props:K}),J.push((()=>bt(r,"value",q)));let Q=t[13]&&rp();h=new Cd({props:{collapsed:!t[13],label:Tt.sensors,selected:t[8]===t[7].sensors,imageSrc:"Compass.png",large:!0}}),h.$on("click",t[29]);let tt=t[2]&&op(t),et=t[12];const nt=t=>t[52];for(let e=0;e<et.length;e+=1){let n=ip(t,et,e),i=nt(n);X.set(i,Y[e]=lp(i,n))}let it=t[10]&&cp(t);y=new Cd({props:{collapsed:!t[13],label:Tt.experimentSettings,selected:t[8]===t[7].settings,imageSrc:"Gear.png",large:!0}}),y.$on("click",t[34]);let rt=t[0].length&&up(t),ot=t[2]&&hp(t),at=t[0].length&&dp(t);D=new Cd({props:{collapsed:!t[13],label:Tt.about,selected:t[8]===t[7].about,imageSrc:"Info.png"}}),D.$on("click",t[39]);const lt=[wp,bp,yp,mp,gp,vp,fp,pp],ct=[];function ut(t,e){return t[8]===t[7].sensors?0:t[8]===t[7].sensor&&null!==t[9]&&t[12][t[9]]?1:t[8]===t[7].settings?2:t[8]===t[7].sensorsPack&&t[0].length>0?3:t[8]===t[7].calibration&&t[0].length?4:t[8]===t[7].camera?5:t[8]===t[7].about?6:t[8]===t[7].sensorsVisibility?7:-1}~(O=ut(t))&&(F=ct[O]=lt[O](t));let vt=t[2]&&$p(t);return{c(){Z&&Z.c(),e=k(),n=x("div"),i=x("nav"),s=x("div"),wt(r.$$.fragment),l=k(),Q&&Q.c(),u=k(),wt(h.$$.fragment),d=k(),p=x("div"),tt&&tt.c(),f=k();for(let t=0;t<Y.length;t+=1)Y[t].c();v=k(),it&&it.c(),g=k(),m=x("div"),wt(y.$$.fragment),b=k(),rt&&rt.c(),w=k(),ot&&ot.c(),M=k(),at&&at.c(),C=k(),wt(D.$$.fragment),A=k(),T=x("button"),L=x("span"),L.textContent=`${Tt.start}`,P=k(),E=x("img"),z=k(),N=x("main"),F&&F.c(),W=k(),vt&&vt.c(),s.hidden=a=!t[4],B(s,"class","svelte-18us80l"),U(s,"burger",t[13]),B(p,"class","column sensors-list svelte-18us80l"),B(m,"class","settings-menu svelte-18us80l"),B(L,"class","svelte-18us80l"),c(E.src,I="ico_start.png")||B(E,"src","ico_start.png"),B(E,"alt","ico_start"),B(E,"class","svelte-18us80l"),B(T,"class","start-button svelte-18us80l"),T.disabled=R=!t[1],B(i,"class","column svelte-18us80l"),U(i,"hidden",!t[13]),B(N,"class","svelte-18us80l"),B(n,"class","row full overflow-x")},m(o,a){Z&&Z.m(o,a),_(o,e,a),_(o,n,a),S(n,i),S(i,s),St(r,s,null),S(i,l),Q&&Q.m(i,null),S(i,u),St(h,i,null),S(i,d),S(i,p),tt&&tt.m(p,null),S(p,f);for(let t=0;t<Y.length;t+=1)Y[t].m(p,null);S(p,v),it&&it.m(p,null),S(i,g),S(i,m),St(y,m,null),S(m,b),rt&&rt.m(m,null),S(m,w),ot&&ot.m(m,null),S(m,M),at&&at.m(m,null),S(m,C),St(D,m,null),S(i,A),S(i,T),S(T,L),S(T,P),S(T,E),S(n,z),S(n,N),~O&&ct[O].m(N,null),S(N,W),vt&&vt.m(N,null),H=!0,G||(j=V(T,"click",t[40]),G=!0)},p(t,n){t[5]?Z?(Z.p(t,n),32&n[0]&&pt(Z,1)):(Z=sp(t),Z.c(),pt(Z,1),Z.m(e.parentNode,e)):Z&&(ht(),ft(Z,1,1,(()=>{Z=null})),dt());const l={};!o&&8192&n[0]&&(o=!0,l.value=t[13],st((()=>o=!1))),r.$set(l),(!H||16&n[0]&&a!==(a=!t[4]))&&(s.hidden=a),8192&n[0]&&U(s,"burger",t[13]),t[13]?Q?8192&n[0]&&pt(Q,1):(Q=rp(),Q.c(),pt(Q,1),Q.m(i,u)):Q&&(ht(),ft(Q,1,1,(()=>{Q=null})),dt());const c={};8192&n[0]&&(c.collapsed=!t[13]),384&n[0]&&(c.selected=t[8]===t[7].sensors),h.$set(c),t[2]?tt?(tt.p(t,n),4&n[0]&&pt(tt,1)):(tt=op(t),tt.c(),pt(tt,1),tt.m(p,f)):tt&&(ht(),ft(tt,1,1,(()=>{tt=null})),dt()),50477952&n[0]&&(et=t[12],ht(),Y=mt(Y,n,nt,1,t,et,X,p,gt,lp,v,ip),dt()),t[10]?it?(it.p(t,n),1024&n[0]&&pt(it,1)):(it=cp(t),it.c(),pt(it,1),it.m(p,null)):it&&(ht(),ft(it,1,1,(()=>{it=null})),dt());const d={};8192&n[0]&&(d.collapsed=!t[13]),384&n[0]&&(d.selected=t[8]===t[7].settings),y.$set(d),t[0].length?rt?(rt.p(t,n),1&n[0]&&pt(rt,1)):(rt=up(t),rt.c(),pt(rt,1),rt.m(m,w)):rt&&(ht(),ft(rt,1,1,(()=>{rt=null})),dt()),t[2]?ot?(ot.p(t,n),4&n[0]&&pt(ot,1)):(ot=hp(t),ot.c(),pt(ot,1),ot.m(m,M)):ot&&(ht(),ft(ot,1,1,(()=>{ot=null})),dt()),t[0].length?at?(at.p(t,n),1&n[0]&&pt(at,1)):(at=dp(t),at.c(),pt(at,1),at.m(m,C)):at&&(ht(),ft(at,1,1,(()=>{at=null})),dt());const g={};8192&n[0]&&(g.collapsed=!t[13]),384&n[0]&&(g.selected=t[8]===t[7].about),D.$set(g),(!H||2&n[0]&&R!==(R=!t[1]))&&(T.disabled=R),8192&n[0]&&U(i,"hidden",!t[13]);let b=O;O=ut(t),O===b?~O&&ct[O].p(t,n):(F&&(ht(),ft(ct[b],1,1,(()=>{ct[b]=null})),dt()),~O?(F=ct[O],F?F.p(t,n):(F=ct[O]=lt[O](t),F.c()),pt(F,1),F.m(N,W)):F=null),t[2]?vt?(vt.p(t,n),4&n[0]&&pt(vt,1)):(vt=$p(t),vt.c(),pt(vt,1),vt.m(N,null)):vt&&(ht(),ft(vt,1,1,(()=>{vt=null})),dt())},i(t){if(!H){pt(Z),pt(r.$$.fragment,t),pt(Q),pt(h.$$.fragment,t),pt(tt);for(let t=0;t<et.length;t+=1)pt(Y[t]);pt(it),pt(y.$$.fragment,t),pt(rt),pt(ot),pt(at),pt(D.$$.fragment,t),pt(F),pt(vt),H=!0}},o(t){ft(Z),ft(r.$$.fragment,t),ft(Q),ft(h.$$.fragment,t),ft(tt);for(let t=0;t<Y.length;t+=1)ft(Y[t]);ft(it),ft(y.$$.fragment,t),ft(rt),ft(ot),ft(at),ft(D.$$.fragment,t),ft(F),ft(vt),H=!1},d(t){Z&&Z.d(t),t&&$(e),t&&$(n),_t(r),Q&&Q.d(),_t(h),tt&&tt.d();for(let t=0;t<Y.length;t+=1)Y[t].d();it&&it.d(),_t(y),rt&&rt.d(),ot&&ot.d(),at&&at.d(),_t(D),~O&&ct[O].d(),vt&&vt.d(),G=!1,j()}}}function kp(t,e,n){let i,s,r,o,a,l,{sensors:c=[]}=e,{canGoToDashboard:u=!1}=e,{lab:h}=e,{sensorsPack:p=[]}=e,f="";const v=X("connectionVM"),g=v.availableUSBDevices;d(t,g,(t=>n(14,r=t)));const m=v.availableBluetoothDevices;d(t,m,(t=>n(15,o=t)));const y=v.connectedDevices;var b;d(t,y,(t=>n(16,a=t))),function(t){t.sensorsPack="sensorsPack",t.none="",t.sensors="sensors",t.sensor="sensor",t.sensorsVisibility="sensorsVisibility",t.settings="settings",t.wifiSettings="wifiSettings",t.calibration="calibration",t.offlineLogging="offlineLogging",t.about="about",t.camera="camera"}(b||(b={}));const w=j();let S=V(),_=null,$=!1;const M=X(iu.IsLocal);let x=X(iu.IsPhoneSize);d(t,x,(t=>n(4,s=t)));let C,k=!1;async function D(){for(const t of await navigator.mediaDevices.enumerateDevices())"videoinput"===t.kind&&t.deviceId&&n(10,$=!0)}function V(){return location.hash.slice(1).split("&")[0]||b.none}function A(t){null==t?B(S):t>=C.length?A(null):(B(`${S}&${t}`),n(9,_=t))}function T(){const t=location.hash.split("&"),e=Number(t[1]);return Number.isNaN(e)||e>=C.length?null:e}function B(t,e=!1){S!=t&&t!=b.sensors&&(0!=e||t!==b.calibration?(location.hash="#"+t,t||(location.hash=""),n(8,S=V())):n(5,l=!0))}Eu((()=>{null!==_?A(_):n(9,_=T())}),(()=>[c,_])),W((()=>{navigator.mediaDevices.addEventListener("devicechange",(t=>{D()})),D()})),window.addEventListener("hashchange",(()=>{n(8,S=V()),n(9,_=T())}));return t.$$set=t=>{"sensors"in t&&n(0,c=t.sensors),"canGoToDashboard"in t&&n(1,u=t.canGoToDashboard),"lab"in t&&n(2,h=t.lab),"sensorsPack"in t&&n(3,p=t.sensorsPack)},t.$$.update=()=>{16&t.$$.dirty[0]&&n(13,i=!s),1&t.$$.dirty[0]&&n(12,C=c.filter((t=>t.displayType&vl.MainScreen)))},[c,u,h,p,s,l,f,b,S,_,$,k,C,i,r,o,a,v,g,m,y,w,M,x,A,B,function(t){"12345"===t?(B(b.calibration,!0),n(5,l=!1),n(6,f="")):n(6,f=Tt.calibration_passwordError)},()=>n(5,l=!1),function(t){i=t,n(13,i),n(4,s)},()=>{B(b.sensors)},()=>{B(b.sensorsVisibility)},()=>n(11,k=!k),t=>{B(b.sensor),A(t)},()=>B(b.camera),()=>{B(b.settings)},()=>{B(b.sensorsPack)},()=>{B(b.wifiSettings)},()=>{B(b.offlineLogging)},()=>{B(b.calibration)},()=>{B(b.about)},()=>w("start"),function(e){Z.call(this,t,e)},function(e){Z.call(this,t,e)},t=>t.displayType&vl.DashboardChart,function(e){Z.call(this,t,e)},t=>h.availableSensors.includes(t.sensorType),()=>{n(12,C=c.filter((t=>t.displayType&vl.MainScreen)))}]}class Dp extends Mt{constructor(t){super(),$t(this,t,kp,Cp,o,{sensors:0,canGoToDashboard:1,lab:2,sensorsPack:3},null,[-1,-1])}}function Vp(e){let n,i,r,o,a,l,u,h,d,p,f,v,g,m,y,b,w,M,D,I,R,z,N,O,F,W,H,G,j,Y,X,Z,q,J,K,Q,tt,et,nt,it=(e[5]??"")+"",st=(e[6]??"")+"";return{c(){n=k(),i=x("div"),r=x("img"),a=k(),l=x("label"),u=C(e[8]),h=k(),d=x("div"),p=x("div"),f=x("span"),v=C(it),g=k(),m=x("span"),y=C(st),b=k(),w=x("button"),M=k(),D=x("hr"),I=k(),R=x("form"),z=x("div"),N=x("label"),N.textContent=`${Tt.maxY}`,O=k(),F=x("input"),W=k(),H=x("div"),G=x("label"),G.textContent=`${Tt.maxX}`,j=k(),Y=x("input"),X=k(),Z=x("div"),q=x("label"),q.textContent=`${Tt.autoScaleIsOn}`,J=k(),K=x("input"),Q=k(),tt=x("button"),tt.textContent=`${Tt.apply}`,c(r.src,o=e[7])||B(r,"src",o),B(r,"class","icon svelte-1omod2m"),B(l,"class","sensor-label svelte-1omod2m"),B(f,"class","value svelte-1omod2m"),B(m,"class","unit"),B(w,"class","expander-button svelte-1omod2m"),B(p,"class","expander-header svelte-1omod2m"),B(D,"class","expander-hr svelte-1omod2m"),B(F,"type","number"),B(F,"min",e[1]),B(F,"max",e[12]),B(F,"class","svelte-1omod2m"),B(z,"class","row min-max svelte-1omod2m"),B(Y,"type","number"),B(Y,"min",e[11]),B(Y,"max",e[2]),B(Y,"class","svelte-1omod2m"),B(H,"class","row min-max svelte-1omod2m"),B(K,"type","checkbox"),B(Z,"class","row min-max svelte-1omod2m"),B(tt,"class","apply-button svelte-1omod2m"),B(R,"class","expander-body svelte-1omod2m"),B(d,"class","expander svelte-1omod2m"),U(d,"expander_open",e[0]),B(i,"class","content-wrapper svelte-1omod2m"),U(i,"selected",e[3]),U(i,"hidden",e[4])},m(t,s){_(t,n,s),_(t,i,s),S(i,r),S(i,a),S(i,l),S(l,u),S(i,h),S(i,d),S(d,p),S(p,f),S(f,v),S(p,g),S(p,m),S(m,y),S(p,b),S(p,w),S(d,M),S(d,D),S(d,I),S(d,R),S(R,z),S(z,N),S(z,O),S(z,F),E(F,e[2]),S(R,W),S(R,H),S(H,G),S(H,j),S(H,Y),E(Y,e[1]),S(R,X),S(R,Z),S(Z,q),S(Z,J),S(Z,K),K.checked=e[10],S(R,Q),S(R,tt),et||(nt=[V(w,"click",T(e[15])),V(F,"input",e[16]),V(Y,"input",e[17]),V(K,"change",e[18]),V(K,"change",e[19]),V(tt,"click",e[13]),V(R,"submit",A(e[13])),V(i,"click",e[14])],et=!0)},p(t,[e]){128&e&&!c(r.src,o=t[7])&&B(r,"src",o),256&e&&P(u,t[8]),32&e&&it!==(it=(t[5]??"")+"")&&P(v,it),64&e&&st!==(st=(t[6]??"")+"")&&P(y,st),2&e&&B(F,"min",t[1]),4&e&&L(F.value)!==t[2]&&E(F,t[2]),4&e&&B(Y,"max",t[2]),2&e&&L(Y.value)!==t[1]&&E(Y,t[1]),1024&e&&(K.checked=t[10]),1&e&&U(d,"expander_open",t[0]),8&e&&U(i,"selected",t[3]),16&e&&U(i,"hidden",t[4])},i:t,o:t,d(t){t&&$(n),t&&$(i),et=!1,s(nt)}}}function Ap(t,e,n){let{expanded:i=!1}=e,{selected:s=!1}=e,{hidden:r=!1}=e,{value:o}=e,{unit:a}=e,{minValue:l=0}=e,{maxValue:c=0}=e,{icon:u="Amper.png"}=e,{label:h="Датчик"}=e,{onAutoScaleChanged:d}=e,p=!0;const f=l,v=c,g=j();return t.$$set=t=>{"expanded"in t&&n(0,i=t.expanded),"selected"in t&&n(3,s=t.selected),"hidden"in t&&n(4,r=t.hidden),"value"in t&&n(5,o=t.value),"unit"in t&&n(6,a=t.unit),"minValue"in t&&n(1,l=t.minValue),"maxValue"in t&&n(2,c=t.maxValue),"icon"in t&&n(7,u=t.icon),"label"in t&&n(8,h=t.label),"onAutoScaleChanged"in t&&n(9,d=t.onAutoScaleChanged)},[i,l,c,s,r,o,a,u,h,d,p,f,v,function(){l<f&&n(1,l=f),c>v&&n(2,c=v),l>c&&n(1,l=c),g("applyMinMax",{min:l,max:c})},function(e){Z.call(this,t,e)},()=>{n(0,i=!i)},function(){c=L(this.value),n(2,c)},function(){l=L(this.value),n(1,l)},function(){p=this.checked,n(10,p)},()=>d(p)]}class Tp extends Mt{constructor(t){super(),$t(this,t,Ap,Vp,o,{expanded:0,selected:3,hidden:4,value:5,unit:6,minValue:1,maxValue:2,icon:7,label:8,onAutoScaleChanged:9})}}function Bp(e){let n,i;return n=new sl({props:{header:Tt.exitFromDashboardTitle,body:Tt.exitFromDashboardText,buttons:e[0]}}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function Lp(t,e,n){let{onClose:i=(t=>{})}=e;const s=[{text:Tt.yes,onClick:()=>i(!0)},{text:Tt.no,onClick:()=>i(!1)},{text:Tt.reject,onClick:()=>i(!1)}];return t.$$set=t=>{"onClose"in t&&n(1,i=t.onClose)},[s,i]}class Pp extends Mt{constructor(t){super(),$t(this,t,Lp,Bp,o,{onClose:1})}}function Ep(e){let n,i;return n=new sl({props:{header:Tt.archiveSavedTitle,body:Tt.archiveSavedDescription,buttons:e[0]}}),{c(){wt(n.$$.fragment)},m(t,e){St(n,t,e),i=!0},p:t,i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){_t(n,t)}}}function Ip(t,e,n){let{link:i}=e,{onClose:s=(()=>{})}=e;const r=[{text:Tt.copy,onClick:function(){self.navigator.clipboard.writeText(i)}},{text:Tt.open,onClick:function(){self.open(i,"_blank","noopener")}},{text:Tt.cancel,onClick:s}];return t.$$set=t=>{"link"in t&&n(1,i=t.link),"onClose"in t&&n(2,s=t.onClose)},[r,i,s]}class Rp extends Mt{constructor(t){super(),$t(this,t,Ip,Ep,o,{link:1,onClose:2})}}function zp(e){let n,i,s,r,o,a,l,u,h,d,p,f,v,g,m,y,b,w,M,D,V,A,T,L,E,I,R,z,U,N,O,F,W,H,G,j,Y,X,Z,q=e[0].absMmHg+"",J=(e[0].sys??"---")+"",K=(e[0].dia??"---")+"",Q=(e[0].pulse??"---")+"",tt=e[0].status+"",et=e[0].error+"";return{c(){n=x("div"),i=x("div"),s=x("img"),o=k(),a=x("label"),a.textContent=`${Et.get(Bt.ArterialPressureSensor).name}`,l=k(),u=x("div"),h=x("div"),d=x("span"),p=C(q),f=k(),v=x("span"),v.textContent=`${Tt.mmHg}`,g=k(),m=x("div"),y=x("span"),b=C(J),w=C(" (sys)"),M=k(),D=x("span"),D.textContent=`${Tt.mmHg}`,V=k(),A=x("div"),T=x("span"),L=C(K),E=C(" (dia)"),I=k(),R=x("span"),R.textContent=`${Tt.mmHg}`,z=k(),U=x("div"),N=x("span"),O=C(Q),F=k(),W=x("span"),W.textContent=`${Tt.bpm}`,H=k(),G=x("span"),j=C(tt),Y=k(),X=x("span"),Z=C(et),B(s,"class","icon svelte-5554jx"),c(s.src,r="/ArterialPressureSensor.png")||B(s,"src","/ArterialPressureSensor.png"),B(s,"alt",""),B(a,"for","arterial-pressure-sensor"),B(i,"class","row header align-center svelte-5554jx"),B(h,"class","row justify-between"),B(m,"class","row justify-between"),B(A,"class","row justify-between"),B(U,"class","row justify-between"),B(G,"class","status-message svelte-5554jx"),B(X,"class","status-message svelte-5554jx"),B(u,"class","values-wrapper column svelte-5554jx"),B(n,"class","content-wrapper svelte-5554jx"),B(n,"id","arterial-pressure-sensor")},m(t,e){_(t,n,e),S(n,i),S(i,s),S(i,o),S(i,a),S(n,l),S(n,u),S(u,h),S(h,d),S(d,p),S(h,f),S(h,v),S(u,g),S(u,m),S(m,y),S(y,b),S(y,w),S(m,M),S(m,D),S(u,V),S(u,A),S(A,T),S(T,L),S(T,E),S(A,I),S(A,R),S(u,z),S(u,U),S(U,N),S(N,O),S(U,F),S(U,W),S(u,H),S(u,G),S(G,j),S(u,Y),S(u,X),S(X,Z)},p(t,[e]){1&e&&q!==(q=t[0].absMmHg+"")&&P(p,q),1&e&&J!==(J=(t[0].sys??"---")+"")&&P(b,J),1&e&&K!==(K=(t[0].dia??"---")+"")&&P(L,K),1&e&&Q!==(Q=(t[0].pulse??"---")+"")&&P(O,Q),1&e&&tt!==(tt=t[0].status+"")&&P(j,tt),1&e&&et!==(et=t[0].error+"")&&P(Z,et)},i:t,o:t,d(t){t&&$(n)}}}function Up(t,e,n){let{apValue:i}=e;return t.$$set=t=>{"apValue"in t&&n(0,i=t.apValue)},[i]}class Np extends Mt{constructor(t){super(),$t(this,t,Up,zp,o,{apValue:0})}}function Op(t,e,n){const i=t.slice();return i[58]=e[n],i[59]=e,i[60]=n,i}function Fp(t,e,n){const i=t.slice();return i[61]=e[n],i[60]=n,i}function Wp(t){let e,n;return e=new Rp({props:{link:t[9],onClose:t[40]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};512&n[0]&&(i.link=t[9]),128&n[0]&&(i.onClose=t[40]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Hp(t){let e,n;return e=new al({props:{header:Tt.loadFailedHeader,body:Tt.loadFailedBody,onDismiss:t[41]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n[0]&&(i.onDismiss=t[41]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Gp(t){let e,n;return e=new Pp({props:{onClose:t[42]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.onClose=t[42]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function jp(t){let e,n;return e=new al({props:{body:Tt.experimentIsDone,onDismiss:t[43]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n[0]&&(i.onDismiss=t[43]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function Yp(t){let e,n,i,s,r=t[24]&&function(t){let e,n;return e=new Tp({props:{selected:0===t[8],maxValue:Math.max(...t[28].map(Jp)),minValue:Math.min(...t[28].map(Kp)),label:Tt.sensorsPack,icon:"Pack.png",onAutoScaleChanged:t[45]}}),e.$on("click",t[46]),e.$on("applyMinMax",t[47]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};256&n[0]&&(i.selected=0===t[8]),8&n[0]&&(i.onAutoScaleChanged=t[45]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}(t),o=t[28],a=[];for(let e=0;e<o.length;e+=1)a[e]=Xp(Fp(t,o,e));const l=t=>ft(a[t],1,1,(()=>{a[t]=null}));let c=t[29]&&function(t){let e,n;return e=new Np({props:{apValue:t[13]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.apValue=t[13]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}(t);return{c(){r&&r.c(),e=k();for(let t=0;t<a.length;t+=1)a[t].c();n=k(),c&&c.c(),i=D()},m(t,o){r&&r.m(t,o),_(t,e,o);for(let e=0;e<a.length;e+=1)a[e].m(t,o);_(t,n,o),c&&c.m(t,o),_(t,i,o),s=!0},p(t,e){if(t[24]&&r.p(t,e),268439818&e[0]|32&e[1]){let i;for(o=t[28],i=0;i<o.length;i+=1){const s=Fp(t,o,i);a[i]?(a[i].p(s,e),pt(a[i],1)):(a[i]=Xp(s),a[i].c(),pt(a[i],1),a[i].m(n.parentNode,n))}for(ht(),i=o.length;i<a.length;i+=1)l(i);dt()}t[29]&&c.p(t,e)},i(t){if(!s){pt(r);for(let t=0;t<o.length;t+=1)pt(a[t]);pt(c),s=!0}},o(t){ft(r),a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)ft(a[t]);ft(c),s=!1},d(t){r&&r.d(t),t&&$(e),M(a,t),t&&$(n),c&&c.d(t),t&&$(i)}}}function Xp(t){let e,n,i=t[61].isVisibleInMenu&&function(t){let e,n;function i(...e){return t[48](t[60],...e)}return e=new Tp({props:{value:t[1].tableValueConverter(t[12][t[60]],t[60]+1),selected:t[8]===t[60]+1,maxValue:t[61].mode.maxValue,minValue:t[61].mode.minValue,label:t[61].name,icon:t[61].ico,unit:t[61].mode.unit,onAutoScaleChanged:i}}),e.$on("click",(function(){return t[49](t[60])})),e.$on("applyMinMax",(function(...e){return t[50](t[60],...e)})),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(n,s){t=n;const r={};4098&s[0]&&(r.value=t[1].tableValueConverter(t[12][t[60]],t[60]+1)),256&s[0]&&(r.selected=t[8]===t[60]+1),8&s[0]&&(r.onAutoScaleChanged=i),e.$set(r)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}(t);return{c(){i&&i.c(),e=D()},m(t,s){i&&i.m(t,s),_(t,e,s),n=!0},p(t,e){t[61].isVisibleInMenu&&i.p(t,e)},i(t){n||(pt(i),n=!0)},o(t){ft(i),n=!1},d(t){i&&i.d(t),t&&$(e)}}}function Zp(t){let e,n,i,s=t[60];const r=()=>t[57](n,s),o=()=>t[57](null,s);let a={labelX:`${Tt.time} [${zt(te.timeFormat)}]`,numberOfVisiblePoints:1e3*te.experimentTime/t[28][t[60]].interval.intervalMs,labelY:`${t[28][t[60]].name} [${t[28][t[60]].mode.unit}]`,chartDataList:[t[58]],showLegend:!1};return n=new ao({props:a}),r(),{c(){e=x("div"),wt(n.$$.fragment),B(e,"class","chart-wrapper svelte-c2x0d6"),U(e,"hidden",t[60]+1!==t[8]||t[5]!==Dt.Graphics)},m(t,s){_(t,e,s),St(n,e,null),i=!0},p(t,i){s!==t[60]&&(o(),s=t[60],r());n.$set({}),288&i[0]&&U(e,"hidden",t[60]+1!==t[8]||t[5]!==Dt.Graphics)},i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){t&&$(e),o(),_t(n)}}}function qp(t){let e,n,i,o,a,l,u,h,d,p,f,v,g,m,y,b,w,D,A,T,L,E,I,R,z,N,O,F,W,H,G,j,Y,X,Z,q,K,Q,tt,et,nt,it,rt,ot,at,lt,ct,ut,vt,gt,mt,yt,$t,Mt,xt,Ct,kt,Vt,At,Bt,Lt,Pt,Et,It,Rt,Ut=(t[5]===Dt.Measures?Tt.measuresTitle:Tt.graphicsTitle)+"",Nt=t[7]&&Wp(t),Ot=t[10]&&Hp(t),Ft=t[4]&&Gp(t),Wt=t[11]&&jp(t);function Ht(e){t[44](e)}let Gt={};void 0!==t[6]&&(Gt.value=t[6]),h=new ph({props:Gt}),J.push((()=>bt(h,"value",Ht))),v=new Za({});let jt=t[3].length&&Yp(t);T=new le({}),T.$on("click",t[51]);let Yt=t[24]&&function(t){let e,n,i,s={labelX:`${Tt.time} [${zt(te.timeFormat)}]`,numberOfVisiblePoints:1e3*te.experimentTime/Math.min(...t[28].map(Qp)),chartDataList:t[26]};return n=new ao({props:s}),t[56](n),{c(){e=x("div"),wt(n.$$.fragment),B(e,"class","chart-wrapper svelte-c2x0d6"),U(e,"hidden",0!==t[8]||t[5]!==Dt.Graphics)},m(t,s){_(t,e,s),St(n,e,null),i=!0},p(t,i){n.$set({}),288&i[0]&&U(e,"hidden",0!==t[8]||t[5]!==Dt.Graphics)},i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(i){i&&$(e),t[56](null),_t(n)}}}(t),Xt=t[22],Zt=[];for(let e=0;e<Xt.length;e+=1)Zt[e]=Zp(Op(t,Xt,e));const Jt=t=>ft(Zt[t],1,1,(()=>{Zt[t]=null}));return Pt=new qt({props:{rows:t[17],reversed:!0,headers:t[25],valuesConverter:t[1].tableValueConverter}}),{c(){e=k(),n=x("main"),Nt&&Nt.c(),i=k(),Ot&&Ot.c(),o=k(),Ft&&Ft.c(),a=k(),Wt&&Wt.c(),l=k(),u=x("div"),wt(h.$$.fragment),p=k(),f=x("div"),wt(v.$$.fragment),g=k(),m=x("div"),jt&&jt.c(),y=k(),b=x("div"),w=x("div"),D=x("div"),A=x("div"),wt(T.$$.fragment),L=k(),E=x("span"),I=C(Ut),R=k(),z=x("div"),N=x("div"),O=x("button"),O.innerHTML='<img src="ico_download.png"/>',F=k(),W=x("button"),H=x("img"),Y=k(),X=x("button"),Z=x("img"),K=k(),Q=x("button"),tt=x("img"),nt=k(),it=x("div"),rt=x("button"),ot=x("img"),ct=k(),ut=x("button"),vt=x("img"),yt=k(),$t=x("button"),Mt=x("img"),kt=k(),Vt=x("div"),Yt&&Yt.c(),At=k();for(let t=0;t<Zt.length;t+=1)Zt[t].c();Bt=k(),Lt=x("div"),wt(Pt.$$.fragment),B(u,"class","expand-menu-button svelte-c2x0d6"),U(u,"hidden",!t[0]),B(m,"class","sidebar-sensor-list svelte-c2x0d6"),B(f,"class","column sidebar svelte-c2x0d6"),U(f,"sidebar__hidden",!t[6]),B(A,"class","header__back-button svelte-c2x0d6"),B(E,"class","header__title svelte-c2x0d6"),B(D,"class","row left-side"),c(H.src,G="Cloud.png")||B(H,"src","Cloud.png"),W.hidden=j=!t[14],c(Z.src,q=t[16]?"ico_start.png":"ico_pause.png")||B(Z,"src",q),B(X,"class","play-pause"),X.disabled=t[15],c(tt.src,et=t[5]===Dt.Measures?"ico_measure.png":"ico_graphics.png")||B(tt,"src",et),B(Q,"class","measure-graphics"),B(N,"class","buttons-group svelte-c2x0d6"),c(ot.src,at="ico_zoom.png")||B(ot,"src","ico_zoom.png"),B(ot,"alt","zoom"),rt.disabled=lt=t[5]===Dt.Measures,c(vt.src,gt="ico_zoom_out.png")||B(vt,"src","ico_zoom_out.png"),B(vt,"alt","zoom_out"),ut.disabled=mt=t[5]===Dt.Measures,c(Mt.src,xt="ico_zoom_in.png")||B(Mt,"src","ico_zoom_in.png"),B(Mt,"alt","zoom_in"),$t.disabled=Ct=t[5]===Dt.Measures,B(it,"class","buttons-group svelte-c2x0d6"),B(z,"class","row control-buttons svelte-c2x0d6"),B(w,"class","header svelte-c2x0d6"),U(w,"sidebar-collapsed",!t[6]),B(Lt,"class","table-wrapper h-full"),B(Vt,"class","charts-wrapper svelte-c2x0d6"),B(b,"class","column work-screen svelte-c2x0d6"),B(n,"class","full row")},m(s,c){_(s,e,c),_(s,n,c),Nt&&Nt.m(n,null),S(n,i),Ot&&Ot.m(n,null),S(n,o),Ft&&Ft.m(n,null),S(n,a),Wt&&Wt.m(n,null),S(n,l),S(n,u),St(h,u,null),S(n,p),S(n,f),St(v,f,null),S(f,g),S(f,m),jt&&jt.m(m,null),S(n,y),S(n,b),S(b,w),S(w,D),S(D,A),St(T,A,null),S(D,L),S(D,E),S(E,I),S(w,R),S(w,z),S(z,N),S(N,O),S(N,F),S(N,W),S(W,H),S(N,Y),S(N,X),S(X,Z),S(N,K),S(N,Q),S(Q,tt),S(z,nt),S(z,it),S(it,rt),S(rt,ot),S(it,ct),S(it,ut),S(ut,vt),S(it,yt),S(it,$t),S($t,Mt),S(b,kt),S(b,Vt),Yt&&Yt.m(Vt,null),S(Vt,At);for(let t=0;t<Zt.length;t+=1)Zt[t].m(Vt,null);S(Vt,Bt),S(Vt,Lt),St(Pt,Lt,null),Et=!0,It||(Rt=[V(O,"click",t[52]),V(W,"click",t[53]),V(X,"click",t[54]),V(Q,"click",t[55]),V(rt,"click",(function(){r(t[3][t[8]].resetZoom)&&t[3][t[8]].resetZoom.apply(this,arguments)})),V(ut,"click",(function(){r(t[3][t[8]].zoomOut)&&t[3][t[8]].zoomOut.apply(this,arguments)})),V($t,"click",(function(){r(t[3][t[8]].zoomIn)&&t[3][t[8]].zoomIn.apply(this,arguments)}))],It=!0)},p(e,s){(t=e)[7]?Nt?(Nt.p(t,s),128&s[0]&&pt(Nt,1)):(Nt=Wp(t),Nt.c(),pt(Nt,1),Nt.m(n,i)):Nt&&(ht(),ft(Nt,1,1,(()=>{Nt=null})),dt()),t[10]?Ot?(Ot.p(t,s),1024&s[0]&&pt(Ot,1)):(Ot=Hp(t),Ot.c(),pt(Ot,1),Ot.m(n,o)):Ot&&(ht(),ft(Ot,1,1,(()=>{Ot=null})),dt()),t[4]?Ft?(Ft.p(t,s),16&s[0]&&pt(Ft,1)):(Ft=Gp(t),Ft.c(),pt(Ft,1),Ft.m(n,a)):Ft&&(ht(),ft(Ft,1,1,(()=>{Ft=null})),dt()),t[11]?Wt?(Wt.p(t,s),2048&s[0]&&pt(Wt,1)):(Wt=jp(t),Wt.c(),pt(Wt,1),Wt.m(n,l)):Wt&&(ht(),ft(Wt,1,1,(()=>{Wt=null})),dt());const r={};if(!d&&64&s[0]&&(d=!0,r.value=t[6],st((()=>d=!1))),h.$set(r),1&s[0]&&U(u,"hidden",!t[0]),t[3].length?jt?(jt.p(t,s),8&s[0]&&pt(jt,1)):(jt=Yp(t),jt.c(),pt(jt,1),jt.m(m,null)):jt&&(ht(),ft(jt,1,1,(()=>{jt=null})),dt()),64&s[0]&&U(f,"sidebar__hidden",!t[6]),(!Et||32&s[0])&&Ut!==(Ut=(t[5]===Dt.Measures?Tt.measuresTitle:Tt.graphicsTitle)+"")&&P(I,Ut),(!Et||16384&s[0]&&j!==(j=!t[14]))&&(W.hidden=j),(!Et||65536&s[0]&&!c(Z.src,q=t[16]?"ico_start.png":"ico_pause.png"))&&B(Z,"src",q),(!Et||32768&s[0])&&(X.disabled=t[15]),(!Et||32&s[0]&&!c(tt.src,et=t[5]===Dt.Measures?"ico_measure.png":"ico_graphics.png"))&&B(tt,"src",et),(!Et||32&s[0]&&lt!==(lt=t[5]===Dt.Measures))&&(rt.disabled=lt),(!Et||32&s[0]&&mt!==(mt=t[5]===Dt.Measures))&&(ut.disabled=mt),(!Et||32&s[0]&&Ct!==(Ct=t[5]===Dt.Measures))&&($t.disabled=Ct),64&s[0]&&U(w,"sidebar-collapsed",!t[6]),t[24]&&Yt.p(t,s),272630056&s[0]){let e;for(Xt=t[22],e=0;e<Xt.length;e+=1){const n=Op(t,Xt,e);Zt[e]?(Zt[e].p(n,s),pt(Zt[e],1)):(Zt[e]=Zp(n),Zt[e].c(),pt(Zt[e],1),Zt[e].m(Vt,Bt))}for(ht(),e=Xt.length;e<Zt.length;e+=1)Jt(e);dt()}const p={};131072&s[0]&&(p.rows=t[17]),2&s[0]&&(p.valuesConverter=t[1].tableValueConverter),Pt.$set(p)},i(t){if(!Et){pt(Nt),pt(Ot),pt(Ft),pt(Wt),pt(h.$$.fragment,t),pt(v.$$.fragment,t),pt(jt),pt(T.$$.fragment,t),pt(Yt);for(let t=0;t<Xt.length;t+=1)pt(Zt[t]);pt(Pt.$$.fragment,t),Et=!0}},o(t){ft(Nt),ft(Ot),ft(Ft),ft(Wt),ft(h.$$.fragment,t),ft(v.$$.fragment,t),ft(jt),ft(T.$$.fragment,t),ft(Yt),Zt=Zt.filter(Boolean);for(let t=0;t<Zt.length;t+=1)ft(Zt[t]);ft(Pt.$$.fragment,t),Et=!1},d(t){t&&$(e),t&&$(n),Nt&&Nt.d(),Ot&&Ot.d(),Ft&&Ft.d(),Wt&&Wt.d(),_t(h),_t(v),jt&&jt.d(),_t(T),Yt&&Yt.d(),M(Zt,t),_t(Pt),It=!1,s(Rt)}}}const Jp=t=>t.mode.maxValue,Kp=t=>t.mode.minValue,Qp=t=>t.interval.intervalMs;function tf(t,e,n){let i,s,r,o,a,l,c,u,h,p,{isPhone:f}=e,{state:v}=e,{onEvent:g}=e;const m=v.currentValues;d(t,m,(t=>n(12,a=t)));const y=v.showUploadButton;d(t,y,(t=>n(14,c=t)));const b=v.stopped;d(t,b,(t=>n(15,u=t)));const w=v.paused;d(t,w,(t=>n(16,h=t)));const S=v.sensorChartDataList,_=v.tableRows;d(t,_,(t=>n(17,p=t)));const $=v.sensorPackChartDataList.length,M=v.tableHeader,x=v.sensorPackChartDataList,C=v.selectedChartIdx;d(t,C,(t=>n(8,i=t)));const k=v.chartSensors,D=v.apValue;d(t,D,(t=>n(13,l=t)));const V=v.showExperimentDoneMessage;d(t,V,(t=>n(11,o=t)));const A=v.showLoadFailedMessage;d(t,A,(t=>n(10,r=t)));const T=v.savedArchiveLink;d(t,T,(t=>n(9,s=t)));const B=()=>g(zd.SaveAsExcel),L=()=>g(zd.SendToCloud),P=t=>g(zd.SetPause,t),E=t=>{g(zd.SelectSensor,t),n(5,O=Dt.Graphics)},I=()=>{const t=N[i].getImageUri();g(zd.SaveImage,{imageBase64Uri:t})};W((()=>(self.onbeforeunload=()=>(n(4,z=!0),Tt.exitFromDashboardTitle),()=>{self.onbeforeunload=null})));const R=j();let z,U,N=[],O=Dt.Measures,F=!f;function H(){n(5,O=O===Dt.Measures?Dt.Graphics:Dt.Measures)}T.subscribe((t=>n(7,U=!!t)));return t.$$set=t=>{"isPhone"in t&&n(0,f=t.isPhone),"state"in t&&n(1,v=t.state),"onEvent"in t&&n(2,g=t.onEvent)},[f,v,g,N,z,O,F,U,i,s,r,o,a,l,c,u,h,p,m,y,b,w,S,_,$,M,x,C,k,D,V,A,T,B,L,P,E,I,R,H,()=>n(7,U=!1),()=>g(zd.HideLoadFailedMessage),t=>t&&R("back")||n(4,z=!1),()=>g(zd.HideExperimentDoneMessage),function(t){F=t,n(6,F)},t=>{N[0].setAutoScale(t)},()=>E(0),({detail:{min:t,max:e}})=>N[0].applyMinMax(t,e),(t,e)=>{N[t+1].setAutoScale(e)},t=>E(t+1),(t,{detail:{min:e,max:n}})=>N[t+1].applyMinMax(e,n),()=>n(4,z=!0),()=>O===Dt.Measures?B():I(),()=>L(),()=>P(!h),()=>H(),function(t){J[t?"unshift":"push"]((()=>{N[0]=t,n(3,N)}))},function(t,e){J[t?"unshift":"push"]((()=>{N[e+1]=t,n(3,N)}))}]}class ef extends Mt{constructor(t){super(),$t(this,t,tf,qp,o,{isPhone:0,state:1,onEvent:2},null,[-1,-1,-1])}}class nf{intervalMs;experimentTimeSeconds;numberOfVisiblePoints;_updateIntervalSub=[];_experimentTimerSub;_startTime;_tableRowsPausedBuffer=[];_selectedChartIdx=new wc(0);_paused=new wc(!1);_stopped=new wc(!1);_tableRows=new wc([]);_currentValues=new wc([]);_showUploadButton=new wc(!1);_showExperimentDoneMessage=new wc(!1);_showLoadFailedMessage=new wc(!1);_savedArchiveLink=new wc("");tableHeader;sensorRanges;sensorChartDataList;sensorPackChartDataList;tableValueConverter;chartSensors;get selectedChartIdx(){return this._selectedChartIdx}get paused(){return this._paused}get stopped(){return this._stopped}get tableRows(){return this._tableRows}get currentValues(){return this._currentValues}get showUploadButton(){return this._showUploadButton}get showLoadFailedMessage(){return this._showLoadFailedMessage}get showExperimentDoneMessage(){return this._showExperimentDoneMessage}get savedArchiveLink(){return this._savedArchiveLink}apValue;constructor(t,e,n){this.intervalMs=e,this.experimentTimeSeconds=n,this.chartSensors=t.filter((t=>t.displayType&vl.DashboardChart&&t.isVisibleInMenu)),this.numberOfVisiblePoints=1e3/e*n,$o.IsArchiveAvailable().then((t=>{this._showUploadButton.next(t)})),this.sensorChartDataList=this.chartSensors.map((t=>new lo(t.name,t.mode.unit,t.mode,t.chartSettings)));const i=t.find((t=>t instanceof Tc));this.apValue=i?.currentValue,this.sensorPackChartDataList=this.sensorChartDataList.filter(((e,n)=>t[n].inSensorPack)),0==this.sensorPackChartDataList.length&&this._selectedChartIdx.next(1),this.tableHeader=[`${Tt.time} [${zt(te.timeFormat)}]`,...this.chartSensors.map((t=>`${t.name} [${t.mode.unit}]`))],this.sensorRanges=[[Number.MIN_VALUE,Number.MAX_VALUE],...this.chartSensors.map((t=>[t.mode.minValue,t.mode.maxValue]))],this.tableValueConverter=ne(this.sensorRanges),this.startUpdateLoop()}onEvent=(t,e)=>{switch(t){case zd.SaveAsExcel:this.saveAsExcel();break;case zd.SaveImage:this.saveImage(e.imageBase64Uri);break;case zd.SendToCloud:this.sendToCloud();break;case zd.SetPause:this.setPause(e);break;case zd.SelectSensor:this.selectSensor(e);break;case zd.HideExperimentDoneMessage:this._showExperimentDoneMessage.next(!1);break;case zd.HideLoadFailedMessage:this._showLoadFailedMessage.next(!1)}};startUpdateLoop(){const t=this.chartSensors.map((t=>0));for(let e=0;e<this.chartSensors.length;e++){const n=this.chartSensors[e];this._updateIntervalSub.push(Ac(n.interval.intervalMs).subscribe((()=>{if(!this._startTime)return;const i=Date.now()-this._startTime,s=n.getLatestValue();t[e]=s,this.sensorChartDataList[e].addRecords({time:i,value:s})})))}this._updateIntervalSub.push(Ac(this.intervalMs).subscribe((e=>{if(null==this._startTime){const t=this.chartSensors.some((t=>null!==t.getLatestValue()));if(!t)return;return this._startTime=Date.now(),void this.startExperimentTimer()}this.updateTable(t),this._currentValues.next(t)})))}startExperimentTimer(){this._experimentTimerSub=Vc(1e3*this.experimentTimeSeconds).subscribe((t=>{this.setPause(!0),this._showExperimentDoneMessage.next(!0)}))}updateTable(t){if(t.every((t=>null==t)))return;const e=[Date.now()-this._startTime,...t];this._paused.value?this._tableRowsPausedBuffer.push(e):this._tableRows.next([...this._tableRows.value,e])}selectSensor(t){this._selectedChartIdx.next(t)}saveAsExcel(){const t=this._tableRows.value.map((t=>t.map(this.tableValueConverter)));return Nt([this.tableHeader,...t],Tt.worksheetName,Tt.exportExperimentTableFileName+".xls"),!0}saveImage(t,e="jpeg"){return Ut(t,`${Tt.exportExperimentImageFileName}.${e}`),!0}dispose(){this._updateIntervalSub.forEach((t=>t.unsubscribe())),this._experimentTimerSub?.unsubscribe()}setPause(t){!0===this._stopped.value&&0==t||(this._paused.next(t),this.sensorChartDataList.forEach((e=>{t?e.pause():e.start()})),!1===t&&(this._tableRows.next([...this._tableRows.value,...this._tableRowsPausedBuffer]),this._tableRowsPausedBuffer=[]))}saveData(t){$o.saveArchiveValues(t).then((({id:t,url:e})=>{t?this._savedArchiveLink.next(e):this._showLoadFailedMessage.next(!0)}))}sendToCloud(){const t=function(t){if(0==t.length)return[];const e=t[0].length,n=Array(e);for(let i=0;i<e;i++)n[i]=t.map((t=>t[i]));return n}(this._tableRows.value),e={time:t[0],sensorsArchiveValues:this.chartSensors.map(((e,n)=>({mode:e.mode,sensorType:e.sensorType,values:t[n+1]})))};this.saveData(e)}stop(){this.setPause(!0),this._stopped.next(!0),this.chartSensors.forEach((t=>t.stop()))}}function sf(t){let e,n;return e=new ef({props:{isPhone:t[1],onEvent:t[2].onEvent.bind(t[2]),state:t[4]}}),e.$on("back",t[6]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};2&n&&(i.isPhone=t[1]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function rf(t,e,n){let i,{initialSensors:s=[]}=e,{onBackClick:r}=e;const o=new nf(s,250,te.experimentTime),a=X(iu.IsPhoneSize);d(t,a,(t=>n(1,i=t)));const l=o;W((()=>()=>{o.stop(),o.dispose()}));return t.$$set=t=>{"initialSensors"in t&&n(5,s=t.initialSensors),"onBackClick"in t&&n(0,r=t.onBackClick)},[r,i,o,a,l,s,()=>r()]}class of extends Mt{constructor(t){super(),$t(this,t,rf,sf,o,{initialSensors:5,onBackClick:0})}}class af{get sensors(){return this._sensors}get errorMessage(){return this._errorMessage}get connectionVM(){return this._connectionVM}_sensors=new wc([]);_errorMessage=new wc("");_connectionVM=new qh;constructor(){this._connectionVM.connectedDevices.subscribe((t=>{this._sensors.next([...this._connectionVM.labSensors.value,...t])})),this._connectionVM.labSensors.subscribe((t=>{this._sensors.next([...t,...this._connectionVM.connectedDevices.value])}))}async tryConnectWebLab(t){try{await this._connectionVM.tryConnectWebLab(t)}catch(e){t&&this._errorMessage.next(e.message)}}async connectTestLab(t){await this.connectionVM.connectTestLab(t)}setErrorMessage(t){this._errorMessage.next(t)}}function lf(t){let e,n;return e=new al({props:{header:Tt.alert,body:t[2],onDismiss:t[12]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};4&n&&(i.body=t[2]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function cf(t){let e,n;return e=new Dp({props:{sensors:t[3],lab:t[4],canGoToDashboard:t[3].filter(t[14]).length>0}}),e.$on("start",t[10]),e.$on("lab-connected",t[15]),e.$on("sensor-connected",t[16]),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8&n&&(i.sensors=t[3]),16&n&&(i.lab=t[4]),8&n&&(i.canGoToDashboard=t[3].filter(t[14]).length>0),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function uf(t){let e,n;return e=new of({props:{onBackClick:t[13],initialSensors:t[1]}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.initialSensors=t[1]),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function hf(t){let e,n,i,s,r,o=t[2]&&lf(t);const a=[uf,cf],l=[];function c(t,e){return t[0]?0:1}return n=c(t),i=l[n]=a[n](t),{c(){o&&o.c(),e=k(),i.c(),s=D()},m(t,i){o&&o.m(t,i),_(t,e,i),l[n].m(t,i),_(t,s,i),r=!0},p(t,r){t[2]?o?(o.p(t,r),4&r&&pt(o,1)):(o=lf(t),o.c(),pt(o,1),o.m(e.parentNode,e)):o&&(ht(),ft(o,1,1,(()=>{o=null})),dt());let u=n;n=c(t),n===u?l[n].p(t,r):(ht(),ft(l[u],1,1,(()=>{l[u]=null})),dt(),i=l[n],i?i.p(t,r):(i=l[n]=a[n](t),i.c()),pt(i,1),i.m(s.parentNode,s))},i(t){r||(pt(o),pt(i),r=!0)},o(t){ft(o),ft(i),r=!1},d(t){o&&o.d(t),t&&$(e),l[n].d(t),t&&$(s)}}}function df(t){let e,n;return e=new La({props:{$$slots:{default:[hf]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,[n]){const i={};1048607&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function pf(t,e,n){let i,s,r,o;const a=new af,l=a.connectionVM,c=new URL(window.location.href).searchParams.get(fo);a.tryConnectWebLab(c);let u=!1,h=a.sensors.pipe(Dc((t=>t.filter((t=>t.displayType&vl.DashboardSidebar)))));d(t,h,(t=>n(1,i=t)));const p=a.errorMessage;d(t,p,(t=>n(2,s=t)));const f=a.sensors.pipe(Dc((t=>t.filter((t=>t instanceof Bl)))));d(t,f,(t=>n(3,r=t)));const v=a.sensors.pipe(Dc((t=>t.find((t=>t instanceof Lc)))));d(t,v,(t=>n(4,o=t)));const g=X(iu.SerialNumber);function m(){i.forEach((t=>t.stop?.())),n(0,u=!1)}a.sensors.subscribe((t=>{t instanceof Lc&&t?.getSerialNumber().then((t=>{g.set(t.toString())}))})),window.addEventListener("hidDeviceConnected",(async t=>{console.debug("hidDeviceConnected main view"),await l.reduceAction(xh(t.detail))})),window.addEventListener("COMDeviceConnected",(async t=>{console.debug("comDeviceConnected main view"),await l.reduceAction(Ch(t.detail))})),window.addEventListener("BleDeviceConnected",(async t=>{console.debug("bleDeviceConnected main view"),await l.reduceAction(kh(t.detail))})),Y("connectionVM",l);return[u,i,s,r,o,a,h,p,f,v,function(){setTimeout((()=>{i.forEach((t=>t.start?.()))}),100),n(0,u=!0)},m,()=>a.setErrorMessage(""),()=>m(),t=>t.displayType&vl.DashboardSidebar,t=>a.connectLab(t.detail.lab),t=>a.addUsbSensor(t.detail.sensor)]}class ff extends Mt{constructor(t){super(),$t(this,t,pf,df,o,{})}}const vf=wo(Number(localStorage.getItem("theme"))??ou.Light),gf=wo("");function mf(t){let e,n;return e=new ff({}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function yf(t){let e,n;return e=new Eo({props:{savedDataId:t[3].id}}),{c(){wt(e.$$.fragment)},m(t,i){St(e,t,i),n=!0},p(t,n){const i={};8&n&&(i.savedDataId=t[3].id),e.$set(i)},i(t){n||(pt(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){_t(e,t)}}}function bf(t){let e,n,i,s;return e=new Ya({props:{path:yo.Main+"/*",$$slots:{default:[mf]},$$scope:{ctx:t}}}),i=new Ya({props:{path:yo.SavedData+"/:id",$$slots:{default:[yf,({params:t})=>({3:t}),({params:t})=>t?8:0]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment),n=k(),wt(i.$$.fragment)},m(t,r){St(e,t,r),_(t,n,r),St(i,t,r),s=!0},p(t,n){const s={};16&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s);const r={};24&n&&(r.$$scope={dirty:n,ctx:t}),i.$set(r)},i(t){s||(pt(e.$$.fragment,t),pt(i.$$.fragment,t),s=!0)},o(t){ft(e.$$.fragment,t),ft(i.$$.fragment,t),s=!1},d(t){_t(e,t),t&&$(n),_t(i,t)}}}function wf(t){let e,n,i;return n=new La({props:{$$slots:{default:[bf]},$$scope:{ctx:t}}}),{c(){e=x("div"),wt(n.$$.fragment),B(e,"class","content-wrapper svelte-8pbea8")},m(t,s){_(t,e,s),St(n,e,null),i=!0},p(t,[e]){const i={};16&e&&(i.$$scope={dirty:e,ctx:t}),n.$set(i)},i(t){i||(pt(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){t&&$(e),_t(n)}}}function Sf(t){const e=new URL(location.href).searchParams.get(fo);gf.set(e);const n=wo(self.innerWidth<=768);return vf.subscribe((t=>{localStorage.setItem("theme",t.toString()),t==ou.Dark?window.document.body.classList.add("dark-mode"):window.document.body.classList.remove("dark-mode")})),Y(iu.IsPhoneSize,n),Y(iu.SerialNumber,gf),Y(iu.IsLocal,e),Y(iu.ServerUrl,_o),Y(iu.Theme,vf),W((()=>{self.addEventListener("resize",(()=>{n.set(self.innerWidth<=768)}))})),[]}return new class extends Mt{constructor(t){super(),$t(this,t,Sf,wf,o,{})}}({target:document.body})}();
